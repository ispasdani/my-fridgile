function dS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var no=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function LR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function BR(t){var e=t.default;if(typeof e=="function"){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var A={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ol=Symbol.for("react.element"),VR=Symbol.for("react.portal"),MR=Symbol.for("react.fragment"),zR=Symbol.for("react.strict_mode"),UR=Symbol.for("react.profiler"),WR=Symbol.for("react.provider"),GR=Symbol.for("react.context"),jR=Symbol.for("react.forward_ref"),HR=Symbol.for("react.suspense"),KR=Symbol.for("react.memo"),qR=Symbol.for("react.lazy"),D1=Symbol.iterator;function XR(t){return t===null||typeof t!="object"?null:(t=D1&&t[D1]||t["@@iterator"],typeof t=="function"?t:null)}var pS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fS=Object.assign,hS={};function va(t,e,n){this.props=t,this.context=e,this.refs=hS,this.updater=n||pS}va.prototype.isReactComponent={};va.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};va.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mS(){}mS.prototype=va.prototype;function Zh(t,e,n){this.props=t,this.context=e,this.refs=hS,this.updater=n||pS}var Jh=Zh.prototype=new mS;Jh.constructor=Zh;fS(Jh,va.prototype);Jh.isPureReactComponent=!0;var P1=Array.isArray,gS=Object.prototype.hasOwnProperty,em={current:null},yS={key:!0,ref:!0,__self:!0,__source:!0};function xS(t,e,n){var r,s={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)gS.call(e,r)&&!yS.hasOwnProperty(r)&&(s[r]=e[r]);var i=arguments.length-2;if(i===1)s.children=n;else if(1<i){for(var l=Array(i),u=0;u<i;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in i=t.defaultProps,i)s[r]===void 0&&(s[r]=i[r]);return{$$typeof:ol,type:t,key:o,ref:a,props:s,_owner:em.current}}function YR(t,e){return{$$typeof:ol,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tm(t){return typeof t=="object"&&t!==null&&t.$$typeof===ol}function QR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var F1=/\/+/g;function ep(t,e){return typeof t=="object"&&t!==null&&t.key!=null?QR(""+t.key):e.toString(36)}function wu(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ol:case VR:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+ep(a,0):r,P1(s)?(n="",t!=null&&(n=t.replace(F1,"$&/")+"/"),wu(s,e,n,"",function(u){return u})):s!=null&&(tm(s)&&(s=YR(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(F1,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",P1(t))for(var i=0;i<t.length;i++){o=t[i];var l=r+ep(o,i);a+=wu(o,e,n,l,s)}else if(l=XR(t),typeof l=="function")for(t=l.call(t),i=0;!(o=t.next()).done;)o=o.value,l=r+ep(o,i++),a+=wu(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ml(t,e,n){if(t==null)return t;var r=[],s=0;return wu(t,r,"","",function(o){return e.call(n,o,s++)}),r}function ZR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $t={current:null},bu={transition:null},JR={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:bu,ReactCurrentOwner:em};ae.Children={map:Ml,forEach:function(t,e,n){Ml(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ml(t,function(){e++}),e},toArray:function(t){return Ml(t,function(e){return e})||[]},only:function(t){if(!tm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ae.Component=va;ae.Fragment=MR;ae.Profiler=UR;ae.PureComponent=Zh;ae.StrictMode=zR;ae.Suspense=HR;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JR;ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fS({},t.props),s=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=em.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var i=t.type.defaultProps;for(l in e)gS.call(e,l)&&!yS.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&i!==void 0?i[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){i=Array(l);for(var u=0;u<l;u++)i[u]=arguments[u+2];r.children=i}return{$$typeof:ol,type:t.type,key:s,ref:o,props:r,_owner:a}};ae.createContext=function(t){return t={$$typeof:GR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:WR,_context:t},t.Consumer=t};ae.createElement=xS;ae.createFactory=function(t){var e=xS.bind(null,t);return e.type=t,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(t){return{$$typeof:jR,render:t}};ae.isValidElement=tm;ae.lazy=function(t){return{$$typeof:qR,_payload:{_status:-1,_result:t},_init:ZR}};ae.memo=function(t,e){return{$$typeof:KR,type:t,compare:e===void 0?null:e}};ae.startTransition=function(t){var e=bu.transition;bu.transition={};try{t()}finally{bu.transition=e}};ae.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ae.useCallback=function(t,e){return $t.current.useCallback(t,e)};ae.useContext=function(t){return $t.current.useContext(t)};ae.useDebugValue=function(){};ae.useDeferredValue=function(t){return $t.current.useDeferredValue(t)};ae.useEffect=function(t,e){return $t.current.useEffect(t,e)};ae.useId=function(){return $t.current.useId()};ae.useImperativeHandle=function(t,e,n){return $t.current.useImperativeHandle(t,e,n)};ae.useInsertionEffect=function(t,e){return $t.current.useInsertionEffect(t,e)};ae.useLayoutEffect=function(t,e){return $t.current.useLayoutEffect(t,e)};ae.useMemo=function(t,e){return $t.current.useMemo(t,e)};ae.useReducer=function(t,e,n){return $t.current.useReducer(t,e,n)};ae.useRef=function(t){return $t.current.useRef(t)};ae.useState=function(t){return $t.current.useState(t)};ae.useSyncExternalStore=function(t,e,n){return $t.current.useSyncExternalStore(t,e,n)};ae.useTransition=function(){return $t.current.useTransition()};ae.version="18.2.0";(function(t){t.exports=ae})(A);const al=LR(A.exports),Jp=dS({__proto__:null,default:al},[A.exports]);var ef={},vS={exports:{}},Ht={},wS={exports:{}},bS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,Y){var z=L.length;L.push(Y);e:for(;0<z;){var F=z-1>>>1,H=L[F];if(0<s(H,Y))L[F]=Y,L[z]=H,z=F;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var Y=L[0],z=L.pop();if(z!==Y){L[0]=z;e:for(var F=0,H=L.length,de=H>>>1;F<de;){var Ve=2*(F+1)-1,Me=L[Ve],Qt=Ve+1,ms=L[Qt];if(0>s(Me,z))Qt<H&&0>s(ms,Me)?(L[F]=ms,L[Qt]=z,F=Qt):(L[F]=Me,L[Ve]=z,F=Ve);else if(Qt<H&&0>s(ms,z))L[F]=ms,L[Qt]=z,F=Qt;else break e}}return Y}function s(L,Y){var z=L.sortIndex-Y.sortIndex;return z!==0?z:L.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,i=a.now();t.unstable_now=function(){return a.now()-i}}var l=[],u=[],c=1,d=null,p=3,f=!1,h=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(L){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=L)r(u),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=n(u)}}function b(L){if(g=!1,v(L),!h)if(n(l)!==null)h=!0,ne(C);else{var Y=n(u);Y!==null&&ce(b,Y.startTime-L)}}function C(L,Y){h=!1,g&&(g=!1,m(R),R=-1),f=!0;var z=p;try{for(v(Y),d=n(l);d!==null&&(!(d.expirationTime>Y)||L&&!V());){var F=d.callback;if(typeof F=="function"){d.callback=null,p=d.priorityLevel;var H=F(d.expirationTime<=Y);Y=t.unstable_now(),typeof H=="function"?d.callback=H:d===n(l)&&r(l),v(Y)}else r(l);d=n(l)}if(d!==null)var de=!0;else{var Ve=n(u);Ve!==null&&ce(b,Ve.startTime-Y),de=!1}return de}finally{d=null,p=z,f=!1}}var k=!1,I=null,R=-1,D=5,O=-1;function V(){return!(t.unstable_now()-O<D)}function j(){if(I!==null){var L=t.unstable_now();O=L;var Y=!0;try{Y=I(!0,L)}finally{Y?Z():(k=!1,I=null)}}else k=!1}var Z;if(typeof x=="function")Z=function(){x(j)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,re=J.port2;J.port1.onmessage=j,Z=function(){re.postMessage(null)}}else Z=function(){y(j,0)};function ne(L){I=L,k||(k=!0,Z())}function ce(L,Y){R=y(function(){L(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){h||f||(h=!0,ne(C))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(L){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var z=p;p=Y;try{return L()}finally{p=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,Y){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var z=p;p=L;try{return Y()}finally{p=z}},t.unstable_scheduleCallback=function(L,Y,z){var F=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?F+z:F):z=F,L){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=z+H,L={id:c++,callback:Y,priorityLevel:L,startTime:z,expirationTime:H,sortIndex:-1},z>F?(L.sortIndex=z,e(u,L),n(l)===null&&L===n(u)&&(g?(m(R),R=-1):g=!0,ce(b,z-F))):(L.sortIndex=H,e(l,L),h||f||(h=!0,ne(C))),L},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(L){var Y=p;return function(){var z=p;p=Y;try{return L.apply(this,arguments)}finally{p=z}}}})(bS);(function(t){t.exports=bS})(wS);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SS=A.exports,Gt=wS.exports;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CS=new Set,bi={};function ro(t,e){Jo(t,e),Jo(t+"Capture",e)}function Jo(t,e){for(bi[t]=e,t=0;t<e.length;t++)CS.add(e[t])}var fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tf=Object.prototype.hasOwnProperty,e_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,L1={},B1={};function t_(t){return tf.call(B1,t)?!0:tf.call(L1,t)?!1:e_.test(t)?B1[t]=!0:(L1[t]=!0,!1)}function n_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function r_(t,e,n,r){if(e===null||typeof e>"u"||n_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Tt(t,e,n,r,s,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ot[t]=new Tt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ot[e]=new Tt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ot[t]=new Tt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ot[t]=new Tt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ot[t]=new Tt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ot[t]=new Tt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ot[t]=new Tt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ot[t]=new Tt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ot[t]=new Tt(t,5,!1,t.toLowerCase(),null,!1,!1)});var nm=/[\-:]([a-z])/g;function rm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(nm,rm);ot[e]=new Tt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(nm,rm);ot[e]=new Tt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(nm,rm);ot[e]=new Tt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ot[t]=new Tt(t,1,!1,t.toLowerCase(),null,!1,!1)});ot.xlinkHref=new Tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ot[t]=new Tt(t,1,!1,t.toLowerCase(),null,!0,!0)});function sm(t,e,n,r){var s=ot.hasOwnProperty(e)?ot[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(r_(e,n,s,r)&&(n=null),r||s===null?t_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Sr=SS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zl=Symbol.for("react.element"),To=Symbol.for("react.portal"),ko=Symbol.for("react.fragment"),om=Symbol.for("react.strict_mode"),nf=Symbol.for("react.profiler"),$S=Symbol.for("react.provider"),TS=Symbol.for("react.context"),am=Symbol.for("react.forward_ref"),rf=Symbol.for("react.suspense"),sf=Symbol.for("react.suspense_list"),im=Symbol.for("react.memo"),Rr=Symbol.for("react.lazy"),kS=Symbol.for("react.offscreen"),V1=Symbol.iterator;function Fa(t){return t===null||typeof t!="object"?null:(t=V1&&t[V1]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,tp;function Xa(t){if(tp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);tp=e&&e[1]||""}return`
`+tp+t}var np=!1;function rp(t,e){if(!t||np)return"";np=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),a=s.length-1,i=o.length-1;1<=a&&0<=i&&s[a]!==o[i];)i--;for(;1<=a&&0<=i;a--,i--)if(s[a]!==o[i]){if(a!==1||i!==1)do if(a--,i--,0>i||s[a]!==o[i]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=i);break}}}finally{np=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xa(t):""}function s_(t){switch(t.tag){case 5:return Xa(t.type);case 16:return Xa("Lazy");case 13:return Xa("Suspense");case 19:return Xa("SuspenseList");case 0:case 2:case 15:return t=rp(t.type,!1),t;case 11:return t=rp(t.type.render,!1),t;case 1:return t=rp(t.type,!0),t;default:return""}}function of(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ko:return"Fragment";case To:return"Portal";case nf:return"Profiler";case om:return"StrictMode";case rf:return"Suspense";case sf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case TS:return(t.displayName||"Context")+".Consumer";case $S:return(t._context.displayName||"Context")+".Provider";case am:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case im:return e=t.displayName||null,e!==null?e:of(t.type)||"Memo";case Rr:e=t._payload,t=t._init;try{return of(t(e))}catch{}}return null}function o_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return of(e);case 8:return e===om?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function es(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function NS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function a_(t){var e=NS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ul(t){t._valueTracker||(t._valueTracker=a_(t))}function ES(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=NS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function af(t,e){var n=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:t._wrapperState.initialChecked})}function M1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=es(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function IS(t,e){e=e.checked,e!=null&&sm(t,"checked",e,!1)}function lf(t,e){IS(t,e);var n=es(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?uf(t,e.type,n):e.hasOwnProperty("defaultValue")&&uf(t,e.type,es(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function z1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function uf(t,e,n){(e!=="number"||Vu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ya=Array.isArray;function Mo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+es(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function cf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function U1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if(Ya(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:es(n)}}function RS(t,e){var n=es(e.value),r=es(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function W1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function _S(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function df(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?_S(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Wl,AS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Wl=Wl||document.createElement("div"),Wl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Wl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Si(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var si={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i_=["Webkit","ms","Moz","O"];Object.keys(si).forEach(function(t){i_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),si[e]=si[t]})});function OS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||si.hasOwnProperty(t)&&si[t]?(""+e).trim():e+"px"}function DS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=OS(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var l_=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pf(t,e){if(e){if(l_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function ff(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hf=null;function lm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mf=null,zo=null,Uo=null;function G1(t){if(t=ul(t)){if(typeof mf!="function")throw Error(B(280));var e=t.stateNode;e&&(e=Zc(e),mf(t.stateNode,t.type,e))}}function PS(t){zo?Uo?Uo.push(t):Uo=[t]:zo=t}function FS(){if(zo){var t=zo,e=Uo;if(Uo=zo=null,G1(t),e)for(t=0;t<e.length;t++)G1(e[t])}}function LS(t,e){return t(e)}function BS(){}var sp=!1;function VS(t,e,n){if(sp)return t(e,n);sp=!0;try{return LS(t,e,n)}finally{sp=!1,(zo!==null||Uo!==null)&&(BS(),FS())}}function Ci(t,e){var n=t.stateNode;if(n===null)return null;var r=Zc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var gf=!1;if(fr)try{var La={};Object.defineProperty(La,"passive",{get:function(){gf=!0}}),window.addEventListener("test",La,La),window.removeEventListener("test",La,La)}catch{gf=!1}function u_(t,e,n,r,s,o,a,i,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var oi=!1,Mu=null,zu=!1,yf=null,c_={onError:function(t){oi=!0,Mu=t}};function d_(t,e,n,r,s,o,a,i,l){oi=!1,Mu=null,u_.apply(c_,arguments)}function p_(t,e,n,r,s,o,a,i,l){if(d_.apply(this,arguments),oi){if(oi){var u=Mu;oi=!1,Mu=null}else throw Error(B(198));zu||(zu=!0,yf=u)}}function so(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function MS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function j1(t){if(so(t)!==t)throw Error(B(188))}function f_(t){var e=t.alternate;if(!e){if(e=so(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return j1(s),t;if(o===r)return j1(s),e;o=o.sibling}throw Error(B(188))}if(n.return!==r.return)n=s,r=o;else{for(var a=!1,i=s.child;i;){if(i===n){a=!0,n=s,r=o;break}if(i===r){a=!0,r=s,n=o;break}i=i.sibling}if(!a){for(i=o.child;i;){if(i===n){a=!0,n=o,r=s;break}if(i===r){a=!0,r=o,n=s;break}i=i.sibling}if(!a)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function zS(t){return t=f_(t),t!==null?US(t):null}function US(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=US(t);if(e!==null)return e;t=t.sibling}return null}var WS=Gt.unstable_scheduleCallback,H1=Gt.unstable_cancelCallback,h_=Gt.unstable_shouldYield,m_=Gt.unstable_requestPaint,Be=Gt.unstable_now,g_=Gt.unstable_getCurrentPriorityLevel,um=Gt.unstable_ImmediatePriority,GS=Gt.unstable_UserBlockingPriority,Uu=Gt.unstable_NormalPriority,y_=Gt.unstable_LowPriority,jS=Gt.unstable_IdlePriority,qc=null,Wn=null;function x_(t){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(qc,t,void 0,(t.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:b_,v_=Math.log,w_=Math.LN2;function b_(t){return t>>>=0,t===0?32:31-(v_(t)/w_|0)|0}var Gl=64,jl=4194304;function Qa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var i=a&~s;i!==0?r=Qa(i):(o&=a,o!==0&&(r=Qa(o)))}else a=n&~s,a!==0?r=Qa(a):o!==0&&(r=Qa(o));if(r===0)return 0;if(e!==0&&e!==r&&(e&s)===0&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if((r&4)!==0&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-En(e),s=1<<n,r|=t[n],e&=~s;return r}function S_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function C_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-En(o),i=1<<a,l=s[a];l===-1?((i&n)===0||(i&r)!==0)&&(s[a]=S_(i,e)):l<=e&&(t.expiredLanes|=i),o&=~i}}function xf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function HS(){var t=Gl;return Gl<<=1,(Gl&4194240)===0&&(Gl=64),t}function op(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function il(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-En(e),t[e]=n}function $_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-En(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function cm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-En(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var me=0;function KS(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var qS,dm,XS,YS,QS,vf=!1,Hl=[],Gr=null,jr=null,Hr=null,$i=new Map,Ti=new Map,Dr=[],T_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function K1(t,e){switch(t){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":Hr=null;break;case"pointerover":case"pointerout":$i.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ti.delete(e.pointerId)}}function Ba(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=ul(e),e!==null&&dm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function k_(t,e,n,r,s){switch(e){case"focusin":return Gr=Ba(Gr,t,e,n,r,s),!0;case"dragenter":return jr=Ba(jr,t,e,n,r,s),!0;case"mouseover":return Hr=Ba(Hr,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return $i.set(o,Ba($i.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ti.set(o,Ba(Ti.get(o)||null,t,e,n,r,s)),!0}return!1}function ZS(t){var e=Ns(t.target);if(e!==null){var n=so(e);if(n!==null){if(e=n.tag,e===13){if(e=MS(n),e!==null){t.blockedOn=e,QS(t.priority,function(){XS(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Su(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hf=r,n.target.dispatchEvent(r),hf=null}else return e=ul(n),e!==null&&dm(e),t.blockedOn=n,!1;e.shift()}return!0}function q1(t,e,n){Su(t)&&n.delete(e)}function N_(){vf=!1,Gr!==null&&Su(Gr)&&(Gr=null),jr!==null&&Su(jr)&&(jr=null),Hr!==null&&Su(Hr)&&(Hr=null),$i.forEach(q1),Ti.forEach(q1)}function Va(t,e){t.blockedOn===e&&(t.blockedOn=null,vf||(vf=!0,Gt.unstable_scheduleCallback(Gt.unstable_NormalPriority,N_)))}function ki(t){function e(s){return Va(s,t)}if(0<Hl.length){Va(Hl[0],t);for(var n=1;n<Hl.length;n++){var r=Hl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Gr!==null&&Va(Gr,t),jr!==null&&Va(jr,t),Hr!==null&&Va(Hr,t),$i.forEach(e),Ti.forEach(e),n=0;n<Dr.length;n++)r=Dr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Dr.length&&(n=Dr[0],n.blockedOn===null);)ZS(n),n.blockedOn===null&&Dr.shift()}var Wo=Sr.ReactCurrentBatchConfig,Gu=!0;function E_(t,e,n,r){var s=me,o=Wo.transition;Wo.transition=null;try{me=1,pm(t,e,n,r)}finally{me=s,Wo.transition=o}}function I_(t,e,n,r){var s=me,o=Wo.transition;Wo.transition=null;try{me=4,pm(t,e,n,r)}finally{me=s,Wo.transition=o}}function pm(t,e,n,r){if(Gu){var s=wf(t,e,n,r);if(s===null)mp(t,e,r,ju,n),K1(t,r);else if(k_(s,t,e,n,r))r.stopPropagation();else if(K1(t,r),e&4&&-1<T_.indexOf(t)){for(;s!==null;){var o=ul(s);if(o!==null&&qS(o),o=wf(t,e,n,r),o===null&&mp(t,e,r,ju,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else mp(t,e,r,null,n)}}var ju=null;function wf(t,e,n,r){if(ju=null,t=lm(r),t=Ns(t),t!==null)if(e=so(t),e===null)t=null;else if(n=e.tag,n===13){if(t=MS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ju=t,null}function JS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g_()){case um:return 1;case GS:return 4;case Uu:case y_:return 16;case jS:return 536870912;default:return 16}default:return 16}}var Lr=null,fm=null,Cu=null;function eC(){if(Cu)return Cu;var t,e=fm,n=e.length,r,s="value"in Lr?Lr.value:Lr.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[o-r];r++);return Cu=s.slice(t,1<r?1-r:void 0)}function $u(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kl(){return!0}function X1(){return!1}function Kt(t){function e(n,r,s,o,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var i in t)t.hasOwnProperty(i)&&(n=t[i],this[i]=n?n(o):o[i]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Kl:X1,this.isPropagationStopped=X1,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),e}var wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hm=Kt(wa),ll=Pe({},wa,{view:0,detail:0}),R_=Kt(ll),ap,ip,Ma,Xc=Pe({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ma&&(Ma&&t.type==="mousemove"?(ap=t.screenX-Ma.screenX,ip=t.screenY-Ma.screenY):ip=ap=0,Ma=t),ap)},movementY:function(t){return"movementY"in t?t.movementY:ip}}),Y1=Kt(Xc),__=Pe({},Xc,{dataTransfer:0}),A_=Kt(__),O_=Pe({},ll,{relatedTarget:0}),lp=Kt(O_),D_=Pe({},wa,{animationName:0,elapsedTime:0,pseudoElement:0}),P_=Kt(D_),F_=Pe({},wa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),L_=Kt(F_),B_=Pe({},wa,{data:0}),Q1=Kt(B_),V_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=z_[t])?!!e[t]:!1}function mm(){return U_}var W_=Pe({},ll,{key:function(t){if(t.key){var e=V_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$u(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?M_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mm,charCode:function(t){return t.type==="keypress"?$u(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$u(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),G_=Kt(W_),j_=Pe({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Z1=Kt(j_),H_=Pe({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mm}),K_=Kt(H_),q_=Pe({},wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),X_=Kt(q_),Y_=Pe({},Xc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Q_=Kt(Y_),Z_=[9,13,27,32],gm=fr&&"CompositionEvent"in window,ai=null;fr&&"documentMode"in document&&(ai=document.documentMode);var J_=fr&&"TextEvent"in window&&!ai,tC=fr&&(!gm||ai&&8<ai&&11>=ai),J1=String.fromCharCode(32),ev=!1;function nC(t,e){switch(t){case"keyup":return Z_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var No=!1;function eA(t,e){switch(t){case"compositionend":return rC(e);case"keypress":return e.which!==32?null:(ev=!0,J1);case"textInput":return t=e.data,t===J1&&ev?null:t;default:return null}}function tA(t,e){if(No)return t==="compositionend"||!gm&&nC(t,e)?(t=eC(),Cu=fm=Lr=null,No=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tC&&e.locale!=="ko"?null:e.data;default:return null}}var nA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nA[t.type]:e==="textarea"}function sC(t,e,n,r){PS(r),e=Hu(e,"onChange"),0<e.length&&(n=new hm("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ii=null,Ni=null;function rA(t){mC(t,0)}function Yc(t){var e=Ro(t);if(ES(e))return t}function sA(t,e){if(t==="change")return e}var oC=!1;if(fr){var up;if(fr){var cp="oninput"in document;if(!cp){var nv=document.createElement("div");nv.setAttribute("oninput","return;"),cp=typeof nv.oninput=="function"}up=cp}else up=!1;oC=up&&(!document.documentMode||9<document.documentMode)}function rv(){ii&&(ii.detachEvent("onpropertychange",aC),Ni=ii=null)}function aC(t){if(t.propertyName==="value"&&Yc(Ni)){var e=[];sC(e,Ni,t,lm(t)),VS(rA,e)}}function oA(t,e,n){t==="focusin"?(rv(),ii=e,Ni=n,ii.attachEvent("onpropertychange",aC)):t==="focusout"&&rv()}function aA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yc(Ni)}function iA(t,e){if(t==="click")return Yc(e)}function lA(t,e){if(t==="input"||t==="change")return Yc(e)}function uA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var An=typeof Object.is=="function"?Object.is:uA;function Ei(t,e){if(An(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!tf.call(e,s)||!An(t[s],e[s]))return!1}return!0}function sv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ov(t,e){var n=sv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sv(n)}}function iC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?iC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lC(){for(var t=window,e=Vu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vu(t.document)}return e}function ym(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function cA(t){var e=lC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&iC(n.ownerDocument.documentElement,n)){if(r!==null&&ym(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=ov(n,o);var a=ov(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var dA=fr&&"documentMode"in document&&11>=document.documentMode,Eo=null,bf=null,li=null,Sf=!1;function av(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Sf||Eo==null||Eo!==Vu(r)||(r=Eo,"selectionStart"in r&&ym(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),li&&Ei(li,r)||(li=r,r=Hu(bf,"onSelect"),0<r.length&&(e=new hm("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Eo)))}function ql(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Io={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionend:ql("Transition","TransitionEnd")},dp={},uC={};fr&&(uC=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function Qc(t){if(dp[t])return dp[t];if(!Io[t])return t;var e=Io[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in uC)return dp[t]=e[n];return t}var cC=Qc("animationend"),dC=Qc("animationiteration"),pC=Qc("animationstart"),fC=Qc("transitionend"),hC=new Map,iv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function as(t,e){hC.set(t,e),ro(e,[t])}for(var pp=0;pp<iv.length;pp++){var fp=iv[pp],pA=fp.toLowerCase(),fA=fp[0].toUpperCase()+fp.slice(1);as(pA,"on"+fA)}as(cC,"onAnimationEnd");as(dC,"onAnimationIteration");as(pC,"onAnimationStart");as("dblclick","onDoubleClick");as("focusin","onFocus");as("focusout","onBlur");as(fC,"onTransitionEnd");Jo("onMouseEnter",["mouseout","mouseover"]);Jo("onMouseLeave",["mouseout","mouseover"]);Jo("onPointerEnter",["pointerout","pointerover"]);Jo("onPointerLeave",["pointerout","pointerover"]);ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Za));function lv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,p_(r,e,void 0,t),t.currentTarget=null}function mC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var i=r[a],l=i.instance,u=i.currentTarget;if(i=i.listener,l!==o&&s.isPropagationStopped())break e;lv(s,i,u),o=l}else for(a=0;a<r.length;a++){if(i=r[a],l=i.instance,u=i.currentTarget,i=i.listener,l!==o&&s.isPropagationStopped())break e;lv(s,i,u),o=l}}}if(zu)throw t=yf,zu=!1,yf=null,t}function $e(t,e){var n=e[Nf];n===void 0&&(n=e[Nf]=new Set);var r=t+"__bubble";n.has(r)||(gC(e,t,2,!1),n.add(r))}function hp(t,e,n){var r=0;e&&(r|=4),gC(n,t,r,e)}var Xl="_reactListening"+Math.random().toString(36).slice(2);function Ii(t){if(!t[Xl]){t[Xl]=!0,CS.forEach(function(n){n!=="selectionchange"&&(hA.has(n)||hp(n,!1,t),hp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xl]||(e[Xl]=!0,hp("selectionchange",!1,e))}}function gC(t,e,n,r){switch(JS(e)){case 1:var s=E_;break;case 4:s=I_;break;default:s=pm}n=s.bind(null,e,n,t),s=void 0,!gf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function mp(t,e,n,r,s){var o=r;if((e&1)===0&&(e&2)===0&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var i=r.stateNode.containerInfo;if(i===s||i.nodeType===8&&i.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;i!==null;){if(a=Ns(i),a===null)return;if(l=a.tag,l===5||l===6){r=o=a;continue e}i=i.parentNode}}r=r.return}VS(function(){var u=o,c=lm(n),d=[];e:{var p=hC.get(t);if(p!==void 0){var f=hm,h=t;switch(t){case"keypress":if($u(n)===0)break e;case"keydown":case"keyup":f=G_;break;case"focusin":h="focus",f=lp;break;case"focusout":h="blur",f=lp;break;case"beforeblur":case"afterblur":f=lp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Y1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=A_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=K_;break;case cC:case dC:case pC:f=P_;break;case fC:f=X_;break;case"scroll":f=R_;break;case"wheel":f=Q_;break;case"copy":case"cut":case"paste":f=L_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Z1}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?p!==null?p+"Capture":null:p;g=[];for(var x=u,v;x!==null;){v=x;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,m!==null&&(b=Ci(x,m),b!=null&&g.push(Ri(x,b,v)))),y)break;x=x.return}0<g.length&&(p=new f(p,h,null,n,c),d.push({event:p,listeners:g}))}}if((e&7)===0){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&n!==hf&&(h=n.relatedTarget||n.fromElement)&&(Ns(h)||h[hr]))break e;if((f||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,f?(h=n.relatedTarget||n.toElement,f=u,h=h?Ns(h):null,h!==null&&(y=so(h),h!==y||h.tag!==5&&h.tag!==6)&&(h=null)):(f=null,h=u),f!==h)){if(g=Y1,b="onMouseLeave",m="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=Z1,b="onPointerLeave",m="onPointerEnter",x="pointer"),y=f==null?p:Ro(f),v=h==null?p:Ro(h),p=new g(b,x+"leave",f,n,c),p.target=y,p.relatedTarget=v,b=null,Ns(c)===u&&(g=new g(m,x+"enter",h,n,c),g.target=v,g.relatedTarget=y,b=g),y=b,f&&h)t:{for(g=f,m=h,x=0,v=g;v;v=yo(v))x++;for(v=0,b=m;b;b=yo(b))v++;for(;0<x-v;)g=yo(g),x--;for(;0<v-x;)m=yo(m),v--;for(;x--;){if(g===m||m!==null&&g===m.alternate)break t;g=yo(g),m=yo(m)}g=null}else g=null;f!==null&&uv(d,p,f,g,!1),h!==null&&y!==null&&uv(d,y,h,g,!0)}}e:{if(p=u?Ro(u):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var C=sA;else if(tv(p))if(oC)C=lA;else{C=aA;var k=oA}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=iA);if(C&&(C=C(t,u))){sC(d,C,n,c);break e}k&&k(t,p,u),t==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&uf(p,"number",p.value)}switch(k=u?Ro(u):window,t){case"focusin":(tv(k)||k.contentEditable==="true")&&(Eo=k,bf=u,li=null);break;case"focusout":li=bf=Eo=null;break;case"mousedown":Sf=!0;break;case"contextmenu":case"mouseup":case"dragend":Sf=!1,av(d,n,c);break;case"selectionchange":if(dA)break;case"keydown":case"keyup":av(d,n,c)}var I;if(gm)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else No?nC(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(tC&&n.locale!=="ko"&&(No||R!=="onCompositionStart"?R==="onCompositionEnd"&&No&&(I=eC()):(Lr=c,fm="value"in Lr?Lr.value:Lr.textContent,No=!0)),k=Hu(u,R),0<k.length&&(R=new Q1(R,t,null,n,c),d.push({event:R,listeners:k}),I?R.data=I:(I=rC(n),I!==null&&(R.data=I)))),(I=J_?eA(t,n):tA(t,n))&&(u=Hu(u,"onBeforeInput"),0<u.length&&(c=new Q1("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=I))}mC(d,e)})}function Ri(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Ci(t,n),o!=null&&r.unshift(Ri(t,o,s)),o=Ci(t,e),o!=null&&r.push(Ri(t,o,s))),t=t.return}return r}function yo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function uv(t,e,n,r,s){for(var o=e._reactName,a=[];n!==null&&n!==r;){var i=n,l=i.alternate,u=i.stateNode;if(l!==null&&l===r)break;i.tag===5&&u!==null&&(i=u,s?(l=Ci(n,o),l!=null&&a.unshift(Ri(n,l,i))):s||(l=Ci(n,o),l!=null&&a.push(Ri(n,l,i)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var mA=/\r\n?/g,gA=/\u0000|\uFFFD/g;function cv(t){return(typeof t=="string"?t:""+t).replace(mA,`
`).replace(gA,"")}function Yl(t,e,n){if(e=cv(e),cv(t)!==e&&n)throw Error(B(425))}function Ku(){}var Cf=null,$f=null;function Tf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var kf=typeof setTimeout=="function"?setTimeout:void 0,yA=typeof clearTimeout=="function"?clearTimeout:void 0,dv=typeof Promise=="function"?Promise:void 0,xA=typeof queueMicrotask=="function"?queueMicrotask:typeof dv<"u"?function(t){return dv.resolve(null).then(t).catch(vA)}:kf;function vA(t){setTimeout(function(){throw t})}function gp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ki(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ki(e)}function Kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function pv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ba=Math.random().toString(36).slice(2),zn="__reactFiber$"+ba,_i="__reactProps$"+ba,hr="__reactContainer$"+ba,Nf="__reactEvents$"+ba,wA="__reactListeners$"+ba,bA="__reactHandles$"+ba;function Ns(t){var e=t[zn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[hr]||n[zn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=pv(t);t!==null;){if(n=t[zn])return n;t=pv(t)}return e}t=n,n=t.parentNode}return null}function ul(t){return t=t[zn]||t[hr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ro(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function Zc(t){return t[_i]||null}var Ef=[],_o=-1;function is(t){return{current:t}}function Te(t){0>_o||(t.current=Ef[_o],Ef[_o]=null,_o--)}function be(t,e){_o++,Ef[_o]=t.current,t.current=e}var ts={},yt=is(ts),At=is(!1),zs=ts;function ea(t,e){var n=t.type.contextTypes;if(!n)return ts;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ot(t){return t=t.childContextTypes,t!=null}function qu(){Te(At),Te(yt)}function fv(t,e,n){if(yt.current!==ts)throw Error(B(168));be(yt,e),be(At,n)}function yC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(B(108,o_(t)||"Unknown",s));return Pe({},n,r)}function Xu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ts,zs=yt.current,be(yt,t),be(At,At.current),!0}function hv(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=yC(t,e,zs),r.__reactInternalMemoizedMergedChildContext=t,Te(At),Te(yt),be(yt,t)):Te(At),be(At,n)}var nr=null,Jc=!1,yp=!1;function xC(t){nr===null?nr=[t]:nr.push(t)}function SA(t){Jc=!0,xC(t)}function ls(){if(!yp&&nr!==null){yp=!0;var t=0,e=me;try{var n=nr;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}nr=null,Jc=!1}catch(s){throw nr!==null&&(nr=nr.slice(t+1)),WS(um,ls),s}finally{me=e,yp=!1}}return null}var Ao=[],Oo=0,Yu=null,Qu=0,nn=[],rn=0,Us=null,ar=1,ir="";function ws(t,e){Ao[Oo++]=Qu,Ao[Oo++]=Yu,Yu=t,Qu=e}function vC(t,e,n){nn[rn++]=ar,nn[rn++]=ir,nn[rn++]=Us,Us=t;var r=ar;t=ir;var s=32-En(r)-1;r&=~(1<<s),n+=1;var o=32-En(e)+s;if(30<o){var a=s-s%5;o=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ar=1<<32-En(e)+s|n<<s|r,ir=o+t}else ar=1<<o|n<<s|r,ir=t}function xm(t){t.return!==null&&(ws(t,1),vC(t,1,0))}function vm(t){for(;t===Yu;)Yu=Ao[--Oo],Ao[Oo]=null,Qu=Ao[--Oo],Ao[Oo]=null;for(;t===Us;)Us=nn[--rn],nn[rn]=null,ir=nn[--rn],nn[rn]=null,ar=nn[--rn],nn[rn]=null}var Wt=null,zt=null,Re=!1,Tn=null;function wC(t,e){var n=on(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function mv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wt=t,zt=Kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wt=t,zt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Us!==null?{id:ar,overflow:ir}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=on(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wt=t,zt=null,!0):!1;default:return!1}}function If(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rf(t){if(Re){var e=zt;if(e){var n=e;if(!mv(t,e)){if(If(t))throw Error(B(418));e=Kr(n.nextSibling);var r=Wt;e&&mv(t,e)?wC(r,n):(t.flags=t.flags&-4097|2,Re=!1,Wt=t)}}else{if(If(t))throw Error(B(418));t.flags=t.flags&-4097|2,Re=!1,Wt=t}}}function gv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wt=t}function Ql(t){if(t!==Wt)return!1;if(!Re)return gv(t),Re=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Tf(t.type,t.memoizedProps)),e&&(e=zt)){if(If(t))throw bC(),Error(B(418));for(;e;)wC(t,e),e=Kr(e.nextSibling)}if(gv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){zt=Kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}zt=null}}else zt=Wt?Kr(t.stateNode.nextSibling):null;return!0}function bC(){for(var t=zt;t;)t=Kr(t.nextSibling)}function ta(){zt=Wt=null,Re=!1}function wm(t){Tn===null?Tn=[t]:Tn.push(t)}var CA=Sr.ReactCurrentBatchConfig;function Cn(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Zu=is(null),Ju=null,Do=null,bm=null;function Sm(){bm=Do=Ju=null}function Cm(t){var e=Zu.current;Te(Zu),t._currentValue=e}function _f(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Go(t,e){Ju=t,bm=Do=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(Rt=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(bm!==t)if(t={context:t,memoizedValue:e,next:null},Do===null){if(Ju===null)throw Error(B(308));Do=t,Ju.dependencies={lanes:0,firstContext:t}}else Do=Do.next=t;return e}var Es=null;function $m(t){Es===null?Es=[t]:Es.push(t)}function SC(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,$m(e)):(n.next=s.next,s.next=n),e.interleaved=n,mr(t,r)}function mr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _r=!1;function Tm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,(pe&2)!==0){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,mr(t,n)}return s=r.interleaved,s===null?(e.next=e,$m(r)):(e.next=s.next,s.next=e),r.interleaved=e,mr(t,n)}function Tu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,cm(t,n)}}function yv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ec(t,e,n,r){var s=t.updateQueue;_r=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,i=s.shared.pending;if(i!==null){s.shared.pending=null;var l=i,u=l.next;l.next=null,a===null?o=u:a.next=u,a=l;var c=t.alternate;c!==null&&(c=c.updateQueue,i=c.lastBaseUpdate,i!==a&&(i===null?c.firstBaseUpdate=u:i.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=s.baseState;a=0,c=u=l=null,i=o;do{var p=i.lane,f=i.eventTime;if((r&p)===p){c!==null&&(c=c.next={eventTime:f,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var h=t,g=i;switch(p=e,f=n,g.tag){case 1:if(h=g.payload,typeof h=="function"){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=g.payload,p=typeof h=="function"?h.call(f,d,p):h,p==null)break e;d=Pe({},d,p);break e;case 2:_r=!0}}i.callback!==null&&i.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[i]:p.push(i))}else f={eventTime:f,lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,a|=p;if(i=i.next,i===null){if(i=s.shared.pending,i===null)break;p=i,i=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(c===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Gs|=a,t.lanes=a,t.memoizedState=d}}function xv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(B(191,s));s.call(r)}}}var $C=new SS.Component().refs;function Af(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ed={isMounted:function(t){return(t=t._reactInternals)?so(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ct(),s=Yr(t),o=cr(r,s);o.payload=e,n!=null&&(o.callback=n),e=qr(t,o,s),e!==null&&(In(e,t,s,r),Tu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ct(),s=Yr(t),o=cr(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=qr(t,o,s),e!==null&&(In(e,t,s,r),Tu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ct(),r=Yr(t),s=cr(n,r);s.tag=2,e!=null&&(s.callback=e),e=qr(t,s,r),e!==null&&(In(e,t,r,n),Tu(e,t,r))}};function vv(t,e,n,r,s,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!Ei(n,r)||!Ei(s,o):!0}function TC(t,e,n){var r=!1,s=ts,o=e.contextType;return typeof o=="object"&&o!==null?o=mn(o):(s=Ot(e)?zs:yt.current,r=e.contextTypes,o=(r=r!=null)?ea(t,s):ts),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ed,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function wv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ed.enqueueReplaceState(e,e.state,null)}function Of(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=$C,Tm(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=mn(o):(o=Ot(e)?zs:yt.current,s.context=ea(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Af(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ed.enqueueReplaceState(s,s.state,null),ec(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function za(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var i=s.refs;i===$C&&(i=s.refs={}),a===null?delete i[o]:i[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function Zl(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bv(t){var e=t._init;return e(t._payload)}function kC(t){function e(m,x){if(t){var v=m.deletions;v===null?(m.deletions=[x],m.flags|=16):v.push(x)}}function n(m,x){if(!t)return null;for(;x!==null;)e(m,x),x=x.sibling;return null}function r(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function s(m,x){return m=Qr(m,x),m.index=0,m.sibling=null,m}function o(m,x,v){return m.index=v,t?(v=m.alternate,v!==null?(v=v.index,v<x?(m.flags|=2,x):v):(m.flags|=2,x)):(m.flags|=1048576,x)}function a(m){return t&&m.alternate===null&&(m.flags|=2),m}function i(m,x,v,b){return x===null||x.tag!==6?(x=$p(v,m.mode,b),x.return=m,x):(x=s(x,v),x.return=m,x)}function l(m,x,v,b){var C=v.type;return C===ko?c(m,x,v.props.children,b,v.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Rr&&bv(C)===x.type)?(b=s(x,v.props),b.ref=za(m,x,v),b.return=m,b):(b=_u(v.type,v.key,v.props,null,m.mode,b),b.ref=za(m,x,v),b.return=m,b)}function u(m,x,v,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=Tp(v,m.mode,b),x.return=m,x):(x=s(x,v.children||[]),x.return=m,x)}function c(m,x,v,b,C){return x===null||x.tag!==7?(x=Ps(v,m.mode,b,C),x.return=m,x):(x=s(x,v),x.return=m,x)}function d(m,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=$p(""+x,m.mode,v),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case zl:return v=_u(x.type,x.key,x.props,null,m.mode,v),v.ref=za(m,null,x),v.return=m,v;case To:return x=Tp(x,m.mode,v),x.return=m,x;case Rr:var b=x._init;return d(m,b(x._payload),v)}if(Ya(x)||Fa(x))return x=Ps(x,m.mode,v,null),x.return=m,x;Zl(m,x)}return null}function p(m,x,v,b){var C=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return C!==null?null:i(m,x,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zl:return v.key===C?l(m,x,v,b):null;case To:return v.key===C?u(m,x,v,b):null;case Rr:return C=v._init,p(m,x,C(v._payload),b)}if(Ya(v)||Fa(v))return C!==null?null:c(m,x,v,b,null);Zl(m,v)}return null}function f(m,x,v,b,C){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(v)||null,i(x,m,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case zl:return m=m.get(b.key===null?v:b.key)||null,l(x,m,b,C);case To:return m=m.get(b.key===null?v:b.key)||null,u(x,m,b,C);case Rr:var k=b._init;return f(m,x,v,k(b._payload),C)}if(Ya(b)||Fa(b))return m=m.get(v)||null,c(x,m,b,C,null);Zl(x,b)}return null}function h(m,x,v,b){for(var C=null,k=null,I=x,R=x=0,D=null;I!==null&&R<v.length;R++){I.index>R?(D=I,I=null):D=I.sibling;var O=p(m,I,v[R],b);if(O===null){I===null&&(I=D);break}t&&I&&O.alternate===null&&e(m,I),x=o(O,x,R),k===null?C=O:k.sibling=O,k=O,I=D}if(R===v.length)return n(m,I),Re&&ws(m,R),C;if(I===null){for(;R<v.length;R++)I=d(m,v[R],b),I!==null&&(x=o(I,x,R),k===null?C=I:k.sibling=I,k=I);return Re&&ws(m,R),C}for(I=r(m,I);R<v.length;R++)D=f(I,m,R,v[R],b),D!==null&&(t&&D.alternate!==null&&I.delete(D.key===null?R:D.key),x=o(D,x,R),k===null?C=D:k.sibling=D,k=D);return t&&I.forEach(function(V){return e(m,V)}),Re&&ws(m,R),C}function g(m,x,v,b){var C=Fa(v);if(typeof C!="function")throw Error(B(150));if(v=C.call(v),v==null)throw Error(B(151));for(var k=C=null,I=x,R=x=0,D=null,O=v.next();I!==null&&!O.done;R++,O=v.next()){I.index>R?(D=I,I=null):D=I.sibling;var V=p(m,I,O.value,b);if(V===null){I===null&&(I=D);break}t&&I&&V.alternate===null&&e(m,I),x=o(V,x,R),k===null?C=V:k.sibling=V,k=V,I=D}if(O.done)return n(m,I),Re&&ws(m,R),C;if(I===null){for(;!O.done;R++,O=v.next())O=d(m,O.value,b),O!==null&&(x=o(O,x,R),k===null?C=O:k.sibling=O,k=O);return Re&&ws(m,R),C}for(I=r(m,I);!O.done;R++,O=v.next())O=f(I,m,R,O.value,b),O!==null&&(t&&O.alternate!==null&&I.delete(O.key===null?R:O.key),x=o(O,x,R),k===null?C=O:k.sibling=O,k=O);return t&&I.forEach(function(j){return e(m,j)}),Re&&ws(m,R),C}function y(m,x,v,b){if(typeof v=="object"&&v!==null&&v.type===ko&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case zl:e:{for(var C=v.key,k=x;k!==null;){if(k.key===C){if(C=v.type,C===ko){if(k.tag===7){n(m,k.sibling),x=s(k,v.props.children),x.return=m,m=x;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Rr&&bv(C)===k.type){n(m,k.sibling),x=s(k,v.props),x.ref=za(m,k,v),x.return=m,m=x;break e}n(m,k);break}else e(m,k);k=k.sibling}v.type===ko?(x=Ps(v.props.children,m.mode,b,v.key),x.return=m,m=x):(b=_u(v.type,v.key,v.props,null,m.mode,b),b.ref=za(m,x,v),b.return=m,m=b)}return a(m);case To:e:{for(k=v.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){n(m,x.sibling),x=s(x,v.children||[]),x.return=m,m=x;break e}else{n(m,x);break}else e(m,x);x=x.sibling}x=Tp(v,m.mode,b),x.return=m,m=x}return a(m);case Rr:return k=v._init,y(m,x,k(v._payload),b)}if(Ya(v))return h(m,x,v,b);if(Fa(v))return g(m,x,v,b);Zl(m,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(n(m,x.sibling),x=s(x,v),x.return=m,m=x):(n(m,x),x=$p(v,m.mode,b),x.return=m,m=x),a(m)):n(m,x)}return y}var na=kC(!0),NC=kC(!1),cl={},Gn=is(cl),Ai=is(cl),Oi=is(cl);function Is(t){if(t===cl)throw Error(B(174));return t}function km(t,e){switch(be(Oi,e),be(Ai,t),be(Gn,cl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:df(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=df(e,t)}Te(Gn),be(Gn,e)}function ra(){Te(Gn),Te(Ai),Te(Oi)}function EC(t){Is(Oi.current);var e=Is(Gn.current),n=df(e,t.type);e!==n&&(be(Ai,t),be(Gn,n))}function Nm(t){Ai.current===t&&(Te(Gn),Te(Ai))}var Oe=is(0);function tc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xp=[];function Em(){for(var t=0;t<xp.length;t++)xp[t]._workInProgressVersionPrimary=null;xp.length=0}var ku=Sr.ReactCurrentDispatcher,vp=Sr.ReactCurrentBatchConfig,Ws=0,De=null,We=null,Ke=null,nc=!1,ui=!1,Di=0,$A=0;function lt(){throw Error(B(321))}function Im(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!An(t[n],e[n]))return!1;return!0}function Rm(t,e,n,r,s,o){if(Ws=o,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ku.current=t===null||t.memoizedState===null?EA:IA,t=n(r,s),ui){o=0;do{if(ui=!1,Di=0,25<=o)throw Error(B(301));o+=1,Ke=We=null,e.updateQueue=null,ku.current=RA,t=n(r,s)}while(ui)}if(ku.current=rc,e=We!==null&&We.next!==null,Ws=0,Ke=We=De=null,nc=!1,e)throw Error(B(300));return t}function _m(){var t=Di!==0;return Di=0,t}function Bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ke===null?De.memoizedState=Ke=t:Ke=Ke.next=t,Ke}function gn(){if(We===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=We.next;var e=Ke===null?De.memoizedState:Ke.next;if(e!==null)Ke=e,We=t;else{if(t===null)throw Error(B(310));We=t,t={memoizedState:We.memoizedState,baseState:We.baseState,baseQueue:We.baseQueue,queue:We.queue,next:null},Ke===null?De.memoizedState=Ke=t:Ke=Ke.next=t}return Ke}function Pi(t,e){return typeof e=="function"?e(t):e}function wp(t){var e=gn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=We,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var i=a=null,l=null,u=o;do{var c=u.lane;if((Ws&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(i=l=d,a=r):l=l.next=d,De.lanes|=c,Gs|=c}u=u.next}while(u!==null&&u!==o);l===null?a=r:l.next=i,An(r,e.memoizedState)||(Rt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,De.lanes|=o,Gs|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function bp(t){var e=gn(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do o=t(o,a.action),a=a.next;while(a!==s);An(o,e.memoizedState)||(Rt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function IC(){}function RC(t,e){var n=De,r=gn(),s=e(),o=!An(r.memoizedState,s);if(o&&(r.memoizedState=s,Rt=!0),r=r.queue,Am(OC.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ke!==null&&Ke.memoizedState.tag&1){if(n.flags|=2048,Fi(9,AC.bind(null,n,r,s,e),void 0,null),Ye===null)throw Error(B(349));(Ws&30)!==0||_C(n,e,s)}return s}function _C(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function AC(t,e,n,r){e.value=n,e.getSnapshot=r,DC(e)&&PC(t)}function OC(t,e,n){return n(function(){DC(e)&&PC(t)})}function DC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!An(t,n)}catch{return!0}}function PC(t){var e=mr(t,1);e!==null&&In(e,t,1,-1)}function Sv(t){var e=Bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:t},e.queue=t,t=t.dispatch=NA.bind(null,De,t),[e.memoizedState,t]}function Fi(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function FC(){return gn().memoizedState}function Nu(t,e,n,r){var s=Bn();De.flags|=t,s.memoizedState=Fi(1|e,n,void 0,r===void 0?null:r)}function td(t,e,n,r){var s=gn();r=r===void 0?null:r;var o=void 0;if(We!==null){var a=We.memoizedState;if(o=a.destroy,r!==null&&Im(r,a.deps)){s.memoizedState=Fi(e,n,o,r);return}}De.flags|=t,s.memoizedState=Fi(1|e,n,o,r)}function Cv(t,e){return Nu(8390656,8,t,e)}function Am(t,e){return td(2048,8,t,e)}function LC(t,e){return td(4,2,t,e)}function BC(t,e){return td(4,4,t,e)}function VC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function MC(t,e,n){return n=n!=null?n.concat([t]):null,td(4,4,VC.bind(null,e,t),n)}function Om(){}function zC(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Im(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function UC(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Im(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function WC(t,e,n){return(Ws&21)===0?(t.baseState&&(t.baseState=!1,Rt=!0),t.memoizedState=n):(An(n,e)||(n=HS(),De.lanes|=n,Gs|=n,t.baseState=!0),e)}function TA(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=vp.transition;vp.transition={};try{t(!1),e()}finally{me=n,vp.transition=r}}function GC(){return gn().memoizedState}function kA(t,e,n){var r=Yr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jC(t))HC(e,n);else if(n=SC(t,e,n,r),n!==null){var s=Ct();In(n,t,r,s),KC(n,e,r)}}function NA(t,e,n){var r=Yr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jC(t))HC(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,i=o(a,n);if(s.hasEagerState=!0,s.eagerState=i,An(i,a)){var l=e.interleaved;l===null?(s.next=s,$m(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=SC(t,e,s,r),n!==null&&(s=Ct(),In(n,t,r,s),KC(n,e,r))}}function jC(t){var e=t.alternate;return t===De||e!==null&&e===De}function HC(t,e){ui=nc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function KC(t,e,n){if((n&4194240)!==0){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,cm(t,n)}}var rc={readContext:mn,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useInsertionEffect:lt,useLayoutEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useMutableSource:lt,useSyncExternalStore:lt,useId:lt,unstable_isNewReconciler:!1},EA={readContext:mn,useCallback:function(t,e){return Bn().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:Cv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Nu(4194308,4,VC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Nu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nu(4,2,t,e)},useMemo:function(t,e){var n=Bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=kA.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=Bn();return t={current:t},e.memoizedState=t},useState:Sv,useDebugValue:Om,useDeferredValue:function(t){return Bn().memoizedState=t},useTransition:function(){var t=Sv(!1),e=t[0];return t=TA.bind(null,t[1]),Bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,s=Bn();if(Re){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),Ye===null)throw Error(B(349));(Ws&30)!==0||_C(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Cv(OC.bind(null,r,o,t),[t]),r.flags|=2048,Fi(9,AC.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Bn(),e=Ye.identifierPrefix;if(Re){var n=ir,r=ar;n=(r&~(1<<32-En(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Di++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$A++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},IA={readContext:mn,useCallback:zC,useContext:mn,useEffect:Am,useImperativeHandle:MC,useInsertionEffect:LC,useLayoutEffect:BC,useMemo:UC,useReducer:wp,useRef:FC,useState:function(){return wp(Pi)},useDebugValue:Om,useDeferredValue:function(t){var e=gn();return WC(e,We.memoizedState,t)},useTransition:function(){var t=wp(Pi)[0],e=gn().memoizedState;return[t,e]},useMutableSource:IC,useSyncExternalStore:RC,useId:GC,unstable_isNewReconciler:!1},RA={readContext:mn,useCallback:zC,useContext:mn,useEffect:Am,useImperativeHandle:MC,useInsertionEffect:LC,useLayoutEffect:BC,useMemo:UC,useReducer:bp,useRef:FC,useState:function(){return bp(Pi)},useDebugValue:Om,useDeferredValue:function(t){var e=gn();return We===null?e.memoizedState=t:WC(e,We.memoizedState,t)},useTransition:function(){var t=bp(Pi)[0],e=gn().memoizedState;return[t,e]},useMutableSource:IC,useSyncExternalStore:RC,useId:GC,unstable_isNewReconciler:!1};function sa(t,e){try{var n="",r=e;do n+=s_(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Sp(t,e,n){return{value:t,source:null,stack:n!=null?n:null,digest:e!=null?e:null}}function Df(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var _A=typeof WeakMap=="function"?WeakMap:Map;function qC(t,e,n){n=cr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){oc||(oc=!0,Gf=r),Df(t,e)},n}function XC(t,e,n){n=cr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Df(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Df(t,e),typeof r!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function $v(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new _A;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=jA.bind(null,t,e,n),e.then(t,t))}function Tv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function kv(t,e,n,r,s){return(t.mode&1)===0?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=cr(-1,1),e.tag=2,qr(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=s,t)}var AA=Sr.ReactCurrentOwner,Rt=!1;function St(t,e,n,r){e.child=t===null?NC(e,null,n,r):na(e,t.child,n,r)}function Nv(t,e,n,r,s){n=n.render;var o=e.ref;return Go(e,s),r=Rm(t,e,n,r,o,s),n=_m(),t!==null&&!Rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,gr(t,e,s)):(Re&&n&&xm(e),e.flags|=1,St(t,e,r,s),e.child)}function Ev(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!zm(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,YC(t,e,o,r,s)):(t=_u(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,(t.lanes&s)===0){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ei,n(a,r)&&t.ref===e.ref)return gr(t,e,s)}return e.flags|=1,t=Qr(o,r),t.ref=e.ref,t.return=e,e.child=t}function YC(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Ei(o,r)&&t.ref===e.ref)if(Rt=!1,e.pendingProps=r=o,(t.lanes&s)!==0)(t.flags&131072)!==0&&(Rt=!0);else return e.lanes=t.lanes,gr(t,e,s)}return Pf(t,e,n,r,s)}function QC(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Fo,Mt),Mt|=n;else{if((n&1073741824)===0)return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Fo,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,be(Fo,Mt),Mt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,be(Fo,Mt),Mt|=r;return St(t,e,s,n),e.child}function ZC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pf(t,e,n,r,s){var o=Ot(n)?zs:yt.current;return o=ea(e,o),Go(e,s),n=Rm(t,e,n,r,o,s),r=_m(),t!==null&&!Rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,gr(t,e,s)):(Re&&r&&xm(e),e.flags|=1,St(t,e,n,s),e.child)}function Iv(t,e,n,r,s){if(Ot(n)){var o=!0;Xu(e)}else o=!1;if(Go(e,s),e.stateNode===null)Eu(t,e),TC(e,n,r),Of(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,i=e.memoizedProps;a.props=i;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=mn(u):(u=Ot(n)?zs:yt.current,u=ea(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==r||l!==u)&&wv(e,a,r,u),_r=!1;var p=e.memoizedState;a.state=p,ec(e,r,a,s),l=e.memoizedState,i!==r||p!==l||At.current||_r?(typeof c=="function"&&(Af(e,n,c,r),l=e.memoizedState),(i=_r||vv(e,n,i,r,p,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=i):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,CC(t,e),i=e.memoizedProps,u=e.type===e.elementType?i:Cn(e.type,i),a.props=u,d=e.pendingProps,p=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=mn(l):(l=Ot(n)?zs:yt.current,l=ea(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(i!==d||p!==l)&&wv(e,a,r,l),_r=!1,p=e.memoizedState,a.state=p,ec(e,r,a,s);var h=e.memoizedState;i!==d||p!==h||At.current||_r?(typeof f=="function"&&(Af(e,n,f,r),h=e.memoizedState),(u=_r||vv(e,n,u,r,p,h,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,h,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,h,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Ff(t,e,n,r,o,s)}function Ff(t,e,n,r,s,o){ZC(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&hv(e,n,!1),gr(t,e,o);r=e.stateNode,AA.current=e;var i=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=na(e,t.child,null,o),e.child=na(e,null,i,o)):St(t,e,i,o),e.memoizedState=r.state,s&&hv(e,n,!0),e.child}function JC(t){var e=t.stateNode;e.pendingContext?fv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&fv(t,e.context,!1),km(t,e.containerInfo)}function Rv(t,e,n,r,s){return ta(),wm(s),e.flags|=256,St(t,e,n,r),e.child}var Lf={dehydrated:null,treeContext:null,retryLane:0};function Bf(t){return{baseLanes:t,cachePool:null,transitions:null}}function e2(t,e,n){var r=e.pendingProps,s=Oe.current,o=!1,a=(e.flags&128)!==0,i;if((i=a)||(i=t!==null&&t.memoizedState===null?!1:(s&2)!==0),i?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),be(Oe,s&1),t===null)return Rf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((e.mode&1)===0?e.lanes=1:t.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},(r&1)===0&&o!==null?(o.childLanes=0,o.pendingProps=a):o=sd(a,r,0,null),t=Ps(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Bf(n),e.memoizedState=Lf,t):Dm(e,a));if(s=t.memoizedState,s!==null&&(i=s.dehydrated,i!==null))return OA(t,e,a,r,i,s,n);if(o){o=r.fallback,a=e.mode,s=t.child,i=s.sibling;var l={mode:"hidden",children:r.children};return(a&1)===0&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Qr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),i!==null?o=Qr(i,o):(o=Ps(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?Bf(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=Lf,r}return o=t.child,t=o.sibling,r=Qr(o,{mode:"visible",children:r.children}),(e.mode&1)===0&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Dm(t,e){return e=sd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Jl(t,e,n,r){return r!==null&&wm(r),na(e,t.child,null,n),t=Dm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function OA(t,e,n,r,s,o,a){if(n)return e.flags&256?(e.flags&=-257,r=Sp(Error(B(422))),Jl(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=sd({mode:"visible",children:r.children},s,0,null),o=Ps(o,s,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,(e.mode&1)!==0&&na(e,t.child,null,a),e.child.memoizedState=Bf(a),e.memoizedState=Lf,o);if((e.mode&1)===0)return Jl(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var i=r.dgst;return r=i,o=Error(B(419)),r=Sp(o,r,void 0),Jl(t,e,a,r)}if(i=(a&t.childLanes)!==0,Rt||i){if(r=Ye,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=(s&(r.suspendedLanes|a))!==0?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,mr(t,s),In(r,t,s,-1))}return Mm(),r=Sp(Error(B(421))),Jl(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=HA.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,zt=Kr(s.nextSibling),Wt=e,Re=!0,Tn=null,t!==null&&(nn[rn++]=ar,nn[rn++]=ir,nn[rn++]=Us,ar=t.id,ir=t.overflow,Us=e),e=Dm(e,r.children),e.flags|=4096,e)}function _v(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),_f(t.return,e,n)}function Cp(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function t2(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(St(t,e,r.children,n),r=Oe.current,(r&2)!==0)r=r&1|2,e.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_v(t,n,e);else if(t.tag===19)_v(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Oe,r),(e.mode&1)===0)e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&tc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Cp(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&tc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Cp(e,!0,n,null,o);break;case"together":Cp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Eu(t,e){(e.mode&1)===0&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gs|=e.lanes,(n&e.childLanes)===0)return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=Qr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function DA(t,e,n){switch(e.tag){case 3:JC(e),ta();break;case 5:EC(e);break;case 1:Ot(e.type)&&Xu(e);break;case 4:km(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;be(Zu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Oe,Oe.current&1),e.flags|=128,null):(n&e.child.childLanes)!==0?e2(t,e,n):(be(Oe,Oe.current&1),t=gr(t,e,n),t!==null?t.sibling:null);be(Oe,Oe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,(t.flags&128)!==0){if(r)return t2(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),be(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,QC(t,e,n)}return gr(t,e,n)}var n2,Vf,r2,s2;n2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vf=function(){};r2=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Is(Gn.current);var o=null;switch(n){case"input":s=af(t,s),r=af(t,r),o=[];break;case"select":s=Pe({},s,{value:void 0}),r=Pe({},r,{value:void 0}),o=[];break;case"textarea":s=cf(t,s),r=cf(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ku)}pf(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var i=s[u];for(a in i)i.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bi.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(i=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==i&&(l!=null||i!=null))if(u==="style")if(i){for(a in i)!i.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&i[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,i=i?i.__html:void 0,l!=null&&i!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bi.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&$e("scroll",t),o||i===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};s2=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ua(t,e){if(!Re)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PA(t,e,n){var r=e.pendingProps;switch(vm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(e),null;case 1:return Ot(e.type)&&qu(),ut(e),null;case 3:return r=e.stateNode,ra(),Te(At),Te(yt),Em(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ql(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Tn!==null&&(Kf(Tn),Tn=null))),Vf(t,e),ut(e),null;case 5:Nm(e);var s=Is(Oi.current);if(n=e.type,t!==null&&e.stateNode!=null)r2(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return ut(e),null}if(t=Is(Gn.current),Ql(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[zn]=e,r[_i]=o,t=(e.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(s=0;s<Za.length;s++)$e(Za[s],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":M1(r,o),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},$e("invalid",r);break;case"textarea":U1(r,o),$e("invalid",r)}pf(n,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var i=o[a];a==="children"?typeof i=="string"?r.textContent!==i&&(o.suppressHydrationWarning!==!0&&Yl(r.textContent,i,t),s=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(o.suppressHydrationWarning!==!0&&Yl(r.textContent,i,t),s=["children",""+i]):bi.hasOwnProperty(a)&&i!=null&&a==="onScroll"&&$e("scroll",r)}switch(n){case"input":Ul(r),z1(r,o,!0);break;case"textarea":Ul(r),W1(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ku)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_S(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[zn]=e,t[_i]=r,n2(t,e,!1,!1),e.stateNode=t;e:{switch(a=ff(n,r),n){case"dialog":$e("cancel",t),$e("close",t),s=r;break;case"iframe":case"object":case"embed":$e("load",t),s=r;break;case"video":case"audio":for(s=0;s<Za.length;s++)$e(Za[s],t);s=r;break;case"source":$e("error",t),s=r;break;case"img":case"image":case"link":$e("error",t),$e("load",t),s=r;break;case"details":$e("toggle",t),s=r;break;case"input":M1(t,r),s=af(t,r),$e("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Pe({},r,{value:void 0}),$e("invalid",t);break;case"textarea":U1(t,r),s=cf(t,r),$e("invalid",t);break;default:s=r}pf(n,s),i=s;for(o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="style"?DS(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&AS(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Si(t,l):typeof l=="number"&&Si(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(bi.hasOwnProperty(o)?l!=null&&o==="onScroll"&&$e("scroll",t):l!=null&&sm(t,o,l,a))}switch(n){case"input":Ul(t),z1(t,r,!1);break;case"textarea":Ul(t),W1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+es(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Mo(t,!!r.multiple,o,!1):r.defaultValue!=null&&Mo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ku)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ut(e),null;case 6:if(t&&e.stateNode!=null)s2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=Is(Oi.current),Is(Gn.current),Ql(e)){if(r=e.stateNode,n=e.memoizedProps,r[zn]=e,(o=r.nodeValue!==n)&&(t=Wt,t!==null))switch(t.tag){case 3:Yl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Yl(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zn]=e,e.stateNode=r}return ut(e),null;case 13:if(Te(Oe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Re&&zt!==null&&(e.mode&1)!==0&&(e.flags&128)===0)bC(),ta(),e.flags|=98560,o=!1;else if(o=Ql(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(B(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(B(317));o[zn]=e}else ta(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;ut(e),o=!1}else Tn!==null&&(Kf(Tn),Tn=null),o=!0;if(!o)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,(e.mode&1)!==0&&(t===null||(Oe.current&1)!==0?je===0&&(je=3):Mm())),e.updateQueue!==null&&(e.flags|=4),ut(e),null);case 4:return ra(),Vf(t,e),t===null&&Ii(e.stateNode.containerInfo),ut(e),null;case 10:return Cm(e.type._context),ut(e),null;case 17:return Ot(e.type)&&qu(),ut(e),null;case 19:if(Te(Oe),o=e.memoizedState,o===null)return ut(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)Ua(o,!1);else{if(je!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(a=tc(t),a!==null){for(e.flags|=128,Ua(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Oe,Oe.current&1|2),e.child}t=t.sibling}o.tail!==null&&Be()>oa&&(e.flags|=128,r=!0,Ua(o,!1),e.lanes=4194304)}else{if(!r)if(t=tc(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ua(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Re)return ut(e),null}else 2*Be()-o.renderingStartTime>oa&&n!==1073741824&&(e.flags|=128,r=!0,Ua(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Be(),e.sibling=null,n=Oe.current,be(Oe,r?n&1|2:n&1),e):(ut(e),null);case 22:case 23:return Vm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&(e.mode&1)!==0?(Mt&1073741824)!==0&&(ut(e),e.subtreeFlags&6&&(e.flags|=8192)):ut(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function FA(t,e){switch(vm(e),e.tag){case 1:return Ot(e.type)&&qu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ra(),Te(At),Te(yt),Em(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 5:return Nm(e),null;case 13:if(Te(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));ta()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Te(Oe),null;case 4:return ra(),null;case 10:return Cm(e.type._context),null;case 22:case 23:return Vm(),null;case 24:return null;default:return null}}var eu=!1,dt=!1,LA=typeof WeakSet=="function"?WeakSet:Set,K=null;function Po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Fe(t,e,r)}else n.current=null}function Mf(t,e,n){try{n()}catch(r){Fe(t,e,r)}}var Av=!1;function BA(t,e){if(Cf=Gu,t=lC(),ym(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,i=-1,l=-1,u=0,c=0,d=t,p=null;t:for(;;){for(var f;d!==n||s!==0&&d.nodeType!==3||(i=a+s),d!==o||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===t)break t;if(p===n&&++u===s&&(i=a),p===o&&++c===r&&(l=a),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}n=i===-1||l===-1?null:{start:i,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for($f={focusedElem:t,selectionRange:n},Gu=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var h=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var g=h.memoizedProps,y=h.memoizedState,m=e.stateNode,x=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Cn(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(b){Fe(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return h=Av,Av=!1,h}function ci(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Mf(e,n,o)}s=s.next}while(s!==r)}}function nd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function zf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function o2(t){var e=t.alternate;e!==null&&(t.alternate=null,o2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zn],delete e[_i],delete e[Nf],delete e[wA],delete e[bA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function a2(t){return t.tag===5||t.tag===3||t.tag===4}function Ov(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||a2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Uf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ku));else if(r!==4&&(t=t.child,t!==null))for(Uf(t,e,n),t=t.sibling;t!==null;)Uf(t,e,n),t=t.sibling}function Wf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wf(t,e,n),t=t.sibling;t!==null;)Wf(t,e,n),t=t.sibling}var tt=null,$n=!1;function kr(t,e,n){for(n=n.child;n!==null;)i2(t,e,n),n=n.sibling}function i2(t,e,n){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(qc,n)}catch{}switch(n.tag){case 5:dt||Po(n,e);case 6:var r=tt,s=$n;tt=null,kr(t,e,n),tt=r,$n=s,tt!==null&&($n?(t=tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tt.removeChild(n.stateNode));break;case 18:tt!==null&&($n?(t=tt,n=n.stateNode,t.nodeType===8?gp(t.parentNode,n):t.nodeType===1&&gp(t,n),ki(t)):gp(tt,n.stateNode));break;case 4:r=tt,s=$n,tt=n.stateNode.containerInfo,$n=!0,kr(t,e,n),tt=r,$n=s;break;case 0:case 11:case 14:case 15:if(!dt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&((o&2)!==0||(o&4)!==0)&&Mf(n,e,a),s=s.next}while(s!==r)}kr(t,e,n);break;case 1:if(!dt&&(Po(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){Fe(n,e,i)}kr(t,e,n);break;case 21:kr(t,e,n);break;case 22:n.mode&1?(dt=(r=dt)||n.memoizedState!==null,kr(t,e,n),dt=r):kr(t,e,n);break;default:kr(t,e,n)}}function Dv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new LA),e.forEach(function(r){var s=KA.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function bn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,a=e,i=a;e:for(;i!==null;){switch(i.tag){case 5:tt=i.stateNode,$n=!1;break e;case 3:tt=i.stateNode.containerInfo,$n=!0;break e;case 4:tt=i.stateNode.containerInfo,$n=!0;break e}i=i.return}if(tt===null)throw Error(B(160));i2(o,a,s),tt=null,$n=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Fe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)l2(e,t),e=e.sibling}function l2(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bn(e,t),Ln(t),r&4){try{ci(3,t,t.return),nd(3,t)}catch(g){Fe(t,t.return,g)}try{ci(5,t,t.return)}catch(g){Fe(t,t.return,g)}}break;case 1:bn(e,t),Ln(t),r&512&&n!==null&&Po(n,n.return);break;case 5:if(bn(e,t),Ln(t),r&512&&n!==null&&Po(n,n.return),t.flags&32){var s=t.stateNode;try{Si(s,"")}catch(g){Fe(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,i=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{i==="input"&&o.type==="radio"&&o.name!=null&&IS(s,o),ff(i,a);var u=ff(i,o);for(a=0;a<l.length;a+=2){var c=l[a],d=l[a+1];c==="style"?DS(s,d):c==="dangerouslySetInnerHTML"?AS(s,d):c==="children"?Si(s,d):sm(s,c,d,u)}switch(i){case"input":lf(s,o);break;case"textarea":RS(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?Mo(s,!!o.multiple,f,!1):p!==!!o.multiple&&(o.defaultValue!=null?Mo(s,!!o.multiple,o.defaultValue,!0):Mo(s,!!o.multiple,o.multiple?[]:"",!1))}s[_i]=o}catch(g){Fe(t,t.return,g)}}break;case 6:if(bn(e,t),Ln(t),r&4){if(t.stateNode===null)throw Error(B(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(g){Fe(t,t.return,g)}}break;case 3:if(bn(e,t),Ln(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ki(e.containerInfo)}catch(g){Fe(t,t.return,g)}break;case 4:bn(e,t),Ln(t);break;case 13:bn(e,t),Ln(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Lm=Be())),r&4&&Dv(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(dt=(u=dt)||c,bn(e,t),dt=u):bn(e,t),Ln(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&(t.mode&1)!==0)for(K=t,c=t.child;c!==null;){for(d=K=c;K!==null;){switch(p=K,f=p.child,p.tag){case 0:case 11:case 14:case 15:ci(4,p,p.return);break;case 1:Po(p,p.return);var h=p.stateNode;if(typeof h.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(g){Fe(r,n,g)}}break;case 5:Po(p,p.return);break;case 22:if(p.memoizedState!==null){Fv(d);continue}}f!==null?(f.return=p,K=f):Fv(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(i=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,i.style.display=OS("display",a))}catch(g){Fe(t,t.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Fe(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bn(e,t),Ln(t),r&4&&Dv(t);break;case 21:break;default:bn(e,t),Ln(t)}}function Ln(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(a2(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Si(s,""),r.flags&=-33);var o=Ov(t);Wf(t,o,s);break;case 3:case 4:var a=r.stateNode.containerInfo,i=Ov(t);Uf(t,i,a);break;default:throw Error(B(161))}}catch(l){Fe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VA(t,e,n){K=t,u2(t)}function u2(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var s=K,o=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||eu;if(!a){var i=s.alternate,l=i!==null&&i.memoizedState!==null||dt;i=eu;var u=dt;if(eu=a,(dt=l)&&!u)for(K=s;K!==null;)a=K,l=a.child,a.tag===22&&a.memoizedState!==null?Lv(s):l!==null?(l.return=a,K=l):Lv(s);for(;o!==null;)K=o,u2(o),o=o.sibling;K=s,eu=i,dt=u}Pv(t)}else(s.subtreeFlags&8772)!==0&&o!==null?(o.return=s,K=o):Pv(t)}}function Pv(t){for(;K!==null;){var e=K;if((e.flags&8772)!==0){var n=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:dt||nd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!dt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Cn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&xv(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xv(e,a,n)}break;case 5:var i=e.stateNode;if(n===null&&e.flags&4){n=i;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&ki(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}dt||e.flags&512&&zf(e)}catch(p){Fe(e,e.return,p)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Fv(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function Lv(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nd(4,e)}catch(l){Fe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Fe(e,s,l)}}var o=e.return;try{zf(e)}catch(l){Fe(e,o,l)}break;case 5:var a=e.return;try{zf(e)}catch(l){Fe(e,a,l)}}}catch(l){Fe(e,e.return,l)}if(e===t){K=null;break}var i=e.sibling;if(i!==null){i.return=e.return,K=i;break}K=e.return}}var MA=Math.ceil,sc=Sr.ReactCurrentDispatcher,Pm=Sr.ReactCurrentOwner,pn=Sr.ReactCurrentBatchConfig,pe=0,Ye=null,ze=null,rt=0,Mt=0,Fo=is(0),je=0,Li=null,Gs=0,rd=0,Fm=0,di=null,It=null,Lm=0,oa=1/0,tr=null,oc=!1,Gf=null,Xr=null,tu=!1,Br=null,ac=0,pi=0,jf=null,Iu=-1,Ru=0;function Ct(){return(pe&6)!==0?Be():Iu!==-1?Iu:Iu=Be()}function Yr(t){return(t.mode&1)===0?1:(pe&2)!==0&&rt!==0?rt&-rt:CA.transition!==null?(Ru===0&&(Ru=HS()),Ru):(t=me,t!==0||(t=window.event,t=t===void 0?16:JS(t.type)),t)}function In(t,e,n,r){if(50<pi)throw pi=0,jf=null,Error(B(185));il(t,n,r),((pe&2)===0||t!==Ye)&&(t===Ye&&((pe&2)===0&&(rd|=n),je===4&&Pr(t,rt)),Dt(t,r),n===1&&pe===0&&(e.mode&1)===0&&(oa=Be()+500,Jc&&ls()))}function Dt(t,e){var n=t.callbackNode;C_(t,e);var r=Wu(t,t===Ye?rt:0);if(r===0)n!==null&&H1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&H1(n),e===1)t.tag===0?SA(Bv.bind(null,t)):xC(Bv.bind(null,t)),xA(function(){(pe&6)===0&&ls()}),n=null;else{switch(KS(r)){case 1:n=um;break;case 4:n=GS;break;case 16:n=Uu;break;case 536870912:n=jS;break;default:n=Uu}n=y2(n,c2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function c2(t,e){if(Iu=-1,Ru=0,(pe&6)!==0)throw Error(B(327));var n=t.callbackNode;if(jo()&&t.callbackNode!==n)return null;var r=Wu(t,t===Ye?rt:0);if(r===0)return null;if((r&30)!==0||(r&t.expiredLanes)!==0||e)e=ic(t,r);else{e=r;var s=pe;pe|=2;var o=p2();(Ye!==t||rt!==e)&&(tr=null,oa=Be()+500,Ds(t,e));do try{WA();break}catch(i){d2(t,i)}while(1);Sm(),sc.current=o,pe=s,ze!==null?e=0:(Ye=null,rt=0,e=je)}if(e!==0){if(e===2&&(s=xf(t),s!==0&&(r=s,e=Hf(t,s))),e===1)throw n=Li,Ds(t,0),Pr(t,r),Dt(t,Be()),n;if(e===6)Pr(t,r);else{if(s=t.current.alternate,(r&30)===0&&!zA(s)&&(e=ic(t,r),e===2&&(o=xf(t),o!==0&&(r=o,e=Hf(t,o))),e===1))throw n=Li,Ds(t,0),Pr(t,r),Dt(t,Be()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:bs(t,It,tr);break;case 3:if(Pr(t,r),(r&130023424)===r&&(e=Lm+500-Be(),10<e)){if(Wu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ct(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=kf(bs.bind(null,t,It,tr),e);break}bs(t,It,tr);break;case 4:if(Pr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-En(r);o=1<<a,a=e[a],a>s&&(s=a),r&=~o}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*MA(r/1960))-r,10<r){t.timeoutHandle=kf(bs.bind(null,t,It,tr),r);break}bs(t,It,tr);break;case 5:bs(t,It,tr);break;default:throw Error(B(329))}}}return Dt(t,Be()),t.callbackNode===n?c2.bind(null,t):null}function Hf(t,e){var n=di;return t.current.memoizedState.isDehydrated&&(Ds(t,e).flags|=256),t=ic(t,e),t!==2&&(e=It,It=n,e!==null&&Kf(e)),t}function Kf(t){It===null?It=t:It.push.apply(It,t)}function zA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!An(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pr(t,e){for(e&=~Fm,e&=~rd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-En(e),r=1<<n;t[n]=-1,e&=~r}}function Bv(t){if((pe&6)!==0)throw Error(B(327));jo();var e=Wu(t,0);if((e&1)===0)return Dt(t,Be()),null;var n=ic(t,e);if(t.tag!==0&&n===2){var r=xf(t);r!==0&&(e=r,n=Hf(t,r))}if(n===1)throw n=Li,Ds(t,0),Pr(t,e),Dt(t,Be()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bs(t,It,tr),Dt(t,Be()),null}function Bm(t,e){var n=pe;pe|=1;try{return t(e)}finally{pe=n,pe===0&&(oa=Be()+500,Jc&&ls())}}function js(t){Br!==null&&Br.tag===0&&(pe&6)===0&&jo();var e=pe;pe|=1;var n=pn.transition,r=me;try{if(pn.transition=null,me=1,t)return t()}finally{me=r,pn.transition=n,pe=e,(pe&6)===0&&ls()}}function Vm(){Mt=Fo.current,Te(Fo)}function Ds(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,yA(n)),ze!==null)for(n=ze.return;n!==null;){var r=n;switch(vm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qu();break;case 3:ra(),Te(At),Te(yt),Em();break;case 5:Nm(r);break;case 4:ra();break;case 13:Te(Oe);break;case 19:Te(Oe);break;case 10:Cm(r.type._context);break;case 22:case 23:Vm()}n=n.return}if(Ye=t,ze=t=Qr(t.current,null),rt=Mt=e,je=0,Li=null,Fm=rd=Gs=0,It=di=null,Es!==null){for(e=0;e<Es.length;e++)if(n=Es[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=s,r.next=a}n.pending=r}Es=null}return t}function d2(t,e){do{var n=ze;try{if(Sm(),ku.current=rc,nc){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}nc=!1}if(Ws=0,Ke=We=De=null,ui=!1,Di=0,Pm.current=null,n===null||n.return===null){je=1,Li=e,ze=null;break}e:{var o=t,a=n.return,i=n,l=e;if(e=rt,i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=i,d=c.tag;if((c.mode&1)===0&&(d===0||d===11||d===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=Tv(a);if(f!==null){f.flags&=-257,kv(f,a,i,o,e),f.mode&1&&$v(o,u,e),e=f,l=u;var h=e.updateQueue;if(h===null){var g=new Set;g.add(l),e.updateQueue=g}else h.add(l);break e}else{if((e&1)===0){$v(o,u,e),Mm();break e}l=Error(B(426))}}else if(Re&&i.mode&1){var y=Tv(a);if(y!==null){(y.flags&65536)===0&&(y.flags|=256),kv(y,a,i,o,e),wm(sa(l,i));break e}}o=l=sa(l,i),je!==4&&(je=2),di===null?di=[o]:di.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=qC(o,l,e);yv(o,m);break e;case 1:i=l;var x=o.type,v=o.stateNode;if((o.flags&128)===0&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Xr===null||!Xr.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var b=XC(o,i,e);yv(o,b);break e}}o=o.return}while(o!==null)}h2(n)}catch(C){e=C,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(1)}function p2(){var t=sc.current;return sc.current=rc,t===null?rc:t}function Mm(){(je===0||je===3||je===2)&&(je=4),Ye===null||(Gs&268435455)===0&&(rd&268435455)===0||Pr(Ye,rt)}function ic(t,e){var n=pe;pe|=2;var r=p2();(Ye!==t||rt!==e)&&(tr=null,Ds(t,e));do try{UA();break}catch(s){d2(t,s)}while(1);if(Sm(),pe=n,sc.current=r,ze!==null)throw Error(B(261));return Ye=null,rt=0,je}function UA(){for(;ze!==null;)f2(ze)}function WA(){for(;ze!==null&&!h_();)f2(ze)}function f2(t){var e=g2(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?h2(t):ze=e,Pm.current=null}function h2(t){var e=t;do{var n=e.alternate;if(t=e.return,(e.flags&32768)===0){if(n=PA(n,e,Mt),n!==null){ze=n;return}}else{if(n=FA(n,e),n!==null){n.flags&=32767,ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{je=6,ze=null;return}}if(e=e.sibling,e!==null){ze=e;return}ze=e=t}while(e!==null);je===0&&(je=5)}function bs(t,e,n){var r=me,s=pn.transition;try{pn.transition=null,me=1,GA(t,e,n,r)}finally{pn.transition=s,me=r}return null}function GA(t,e,n,r){do jo();while(Br!==null);if((pe&6)!==0)throw Error(B(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if($_(t,o),t===Ye&&(ze=Ye=null,rt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||tu||(tu=!0,y2(Uu,function(){return jo(),null})),o=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||o){o=pn.transition,pn.transition=null;var a=me;me=1;var i=pe;pe|=4,Pm.current=null,BA(t,n),l2(n,t),cA($f),Gu=!!Cf,$f=Cf=null,t.current=n,VA(n),m_(),pe=i,me=a,pn.transition=o}else t.current=n;if(tu&&(tu=!1,Br=t,ac=s),o=t.pendingLanes,o===0&&(Xr=null),x_(n.stateNode),Dt(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(oc)throw oc=!1,t=Gf,Gf=null,t;return(ac&1)!==0&&t.tag!==0&&jo(),o=t.pendingLanes,(o&1)!==0?t===jf?pi++:(pi=0,jf=t):pi=0,ls(),null}function jo(){if(Br!==null){var t=KS(ac),e=pn.transition,n=me;try{if(pn.transition=null,me=16>t?16:t,Br===null)var r=!1;else{if(t=Br,Br=null,ac=0,(pe&6)!==0)throw Error(B(331));var s=pe;for(pe|=4,K=t.current;K!==null;){var o=K,a=o.child;if((K.flags&16)!==0){var i=o.deletions;if(i!==null){for(var l=0;l<i.length;l++){var u=i[l];for(K=u;K!==null;){var c=K;switch(c.tag){case 0:case 11:case 15:ci(8,c,o)}var d=c.child;if(d!==null)d.return=c,K=d;else for(;K!==null;){c=K;var p=c.sibling,f=c.return;if(o2(c),c===u){K=null;break}if(p!==null){p.return=f,K=p;break}K=f}}}var h=o.alternate;if(h!==null){var g=h.child;if(g!==null){h.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}K=o}}if((o.subtreeFlags&2064)!==0&&a!==null)a.return=o,K=a;else e:for(;K!==null;){if(o=K,(o.flags&2048)!==0)switch(o.tag){case 0:case 11:case 15:ci(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,K=m;break e}K=o.return}}var x=t.current;for(K=x;K!==null;){a=K;var v=a.child;if((a.subtreeFlags&2064)!==0&&v!==null)v.return=a,K=v;else e:for(a=x;K!==null;){if(i=K,(i.flags&2048)!==0)try{switch(i.tag){case 0:case 11:case 15:nd(9,i)}}catch(C){Fe(i,i.return,C)}if(i===a){K=null;break e}var b=i.sibling;if(b!==null){b.return=i.return,K=b;break e}K=i.return}}if(pe=s,ls(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(qc,t)}catch{}r=!0}return r}finally{me=n,pn.transition=e}}return!1}function Vv(t,e,n){e=sa(n,e),e=qC(t,e,1),t=qr(t,e,1),e=Ct(),t!==null&&(il(t,1,e),Dt(t,e))}function Fe(t,e,n){if(t.tag===3)Vv(t,t,n);else for(;e!==null;){if(e.tag===3){Vv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Xr===null||!Xr.has(r))){t=sa(n,t),t=XC(e,t,1),e=qr(e,t,1),t=Ct(),e!==null&&(il(e,1,t),Dt(e,t));break}}e=e.return}}function jA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ct(),t.pingedLanes|=t.suspendedLanes&n,Ye===t&&(rt&n)===n&&(je===4||je===3&&(rt&130023424)===rt&&500>Be()-Lm?Ds(t,0):Fm|=n),Dt(t,e)}function m2(t,e){e===0&&((t.mode&1)===0?e=1:(e=jl,jl<<=1,(jl&130023424)===0&&(jl=4194304)));var n=Ct();t=mr(t,e),t!==null&&(il(t,e,n),Dt(t,n))}function HA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),m2(t,n)}function KA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),m2(t,n)}var g2;g2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||At.current)Rt=!0;else{if((t.lanes&n)===0&&(e.flags&128)===0)return Rt=!1,DA(t,e,n);Rt=(t.flags&131072)!==0}else Rt=!1,Re&&(e.flags&1048576)!==0&&vC(e,Qu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Eu(t,e),t=e.pendingProps;var s=ea(e,yt.current);Go(e,n),s=Rm(null,e,r,t,s,n);var o=_m();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ot(r)?(o=!0,Xu(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Tm(e),s.updater=ed,e.stateNode=s,s._reactInternals=e,Of(e,r,t,n),e=Ff(null,e,r,!0,o,n)):(e.tag=0,Re&&o&&xm(e),St(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Eu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=XA(r),t=Cn(r,t),s){case 0:e=Pf(null,e,r,t,n);break e;case 1:e=Iv(null,e,r,t,n);break e;case 11:e=Nv(null,e,r,t,n);break e;case 14:e=Ev(null,e,r,Cn(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),Pf(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),Iv(t,e,r,s,n);case 3:e:{if(JC(e),t===null)throw Error(B(387));r=e.pendingProps,o=e.memoizedState,s=o.element,CC(t,e),ec(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=sa(Error(B(423)),e),e=Rv(t,e,r,n,s);break e}else if(r!==s){s=sa(Error(B(424)),e),e=Rv(t,e,r,n,s);break e}else for(zt=Kr(e.stateNode.containerInfo.firstChild),Wt=e,Re=!0,Tn=null,n=NC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ta(),r===s){e=gr(t,e,n);break e}St(t,e,r,n)}e=e.child}return e;case 5:return EC(e),t===null&&Rf(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,a=s.children,Tf(r,s)?a=null:o!==null&&Tf(r,o)&&(e.flags|=32),ZC(t,e),St(t,e,a,n),e.child;case 6:return t===null&&Rf(e),null;case 13:return e2(t,e,n);case 4:return km(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=na(e,null,r,n):St(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),Nv(t,e,r,s,n);case 7:return St(t,e,e.pendingProps,n),e.child;case 8:return St(t,e,e.pendingProps.children,n),e.child;case 12:return St(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,a=s.value,be(Zu,r._currentValue),r._currentValue=a,o!==null)if(An(o.value,a)){if(o.children===s.children&&!At.current){e=gr(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var i=o.dependencies;if(i!==null){a=o.child;for(var l=i.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=cr(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),_f(o.return,n,e),i.lanes|=n;break}l=l.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(B(341));a.lanes|=n,i=a.alternate,i!==null&&(i.lanes|=n),_f(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}St(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Go(e,n),s=mn(s),r=r(s),e.flags|=1,St(t,e,r,n),e.child;case 14:return r=e.type,s=Cn(r,e.pendingProps),s=Cn(r.type,s),Ev(t,e,r,s,n);case 15:return YC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),Eu(t,e),e.tag=1,Ot(r)?(t=!0,Xu(e)):t=!1,Go(e,n),TC(e,r,s),Of(e,r,s,n),Ff(null,e,r,!0,t,n);case 19:return t2(t,e,n);case 22:return QC(t,e,n)}throw Error(B(156,e.tag))};function y2(t,e){return WS(t,e)}function qA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(t,e,n,r){return new qA(t,e,n,r)}function zm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function XA(t){if(typeof t=="function")return zm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===am)return 11;if(t===im)return 14}return 2}function Qr(t,e){var n=t.alternate;return n===null?(n=on(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function _u(t,e,n,r,s,o){var a=2;if(r=t,typeof t=="function")zm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ko:return Ps(n.children,s,o,e);case om:a=8,s|=8;break;case nf:return t=on(12,n,e,s|2),t.elementType=nf,t.lanes=o,t;case rf:return t=on(13,n,e,s),t.elementType=rf,t.lanes=o,t;case sf:return t=on(19,n,e,s),t.elementType=sf,t.lanes=o,t;case kS:return sd(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $S:a=10;break e;case TS:a=9;break e;case am:a=11;break e;case im:a=14;break e;case Rr:a=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=on(a,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function Ps(t,e,n,r){return t=on(7,t,r,e),t.lanes=n,t}function sd(t,e,n,r){return t=on(22,t,r,e),t.elementType=kS,t.lanes=n,t.stateNode={isHidden:!1},t}function $p(t,e,n){return t=on(6,t,null,e),t.lanes=n,t}function Tp(t,e,n){return e=on(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YA(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=op(0),this.expirationTimes=op(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=op(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Um(t,e,n,r,s,o,a,i,l){return t=new YA(t,e,n,i,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=on(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tm(o),t}function QA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function x2(t){if(!t)return ts;t=t._reactInternals;e:{if(so(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ot(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(Ot(n))return yC(t,n,e)}return e}function v2(t,e,n,r,s,o,a,i,l){return t=Um(n,r,!0,t,s,o,a,i,l),t.context=x2(null),n=t.current,r=Ct(),s=Yr(n),o=cr(r,s),o.callback=e!=null?e:null,qr(n,o,s),t.current.lanes=s,il(t,s,r),Dt(t,r),t}function od(t,e,n,r){var s=e.current,o=Ct(),a=Yr(s);return n=x2(n),e.context===null?e.context=n:e.pendingContext=n,e=cr(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=qr(s,e,a),t!==null&&(In(t,s,a,o),Tu(t,s,a)),a}function lc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Mv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Wm(t,e){Mv(t,e),(t=t.alternate)&&Mv(t,e)}function ZA(){return null}var w2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Gm(t){this._internalRoot=t}ad.prototype.render=Gm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));od(t,e,null,null)};ad.prototype.unmount=Gm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;js(function(){od(null,t,null,null)}),e[hr]=null}};function ad(t){this._internalRoot=t}ad.prototype.unstable_scheduleHydration=function(t){if(t){var e=YS();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Dr.length&&e!==0&&e<Dr[n].priority;n++);Dr.splice(n,0,t),n===0&&ZS(t)}};function jm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function id(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zv(){}function JA(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=lc(a);o.call(u)}}var a=v2(e,r,t,0,null,!1,!1,"",zv);return t._reactRootContainer=a,t[hr]=a.current,Ii(t.nodeType===8?t.parentNode:t),js(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var i=r;r=function(){var u=lc(l);i.call(u)}}var l=Um(t,0,!1,null,null,!1,!1,"",zv);return t._reactRootContainer=l,t[hr]=l.current,Ii(t.nodeType===8?t.parentNode:t),js(function(){od(e,l,n,r)}),l}function ld(t,e,n,r,s){var o=n._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var i=s;s=function(){var l=lc(a);i.call(l)}}od(e,a,t,s)}else a=JA(n,e,t,s,r);return lc(a)}qS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Qa(e.pendingLanes);n!==0&&(cm(e,n|1),Dt(e,Be()),(pe&6)===0&&(oa=Be()+500,ls()))}break;case 13:js(function(){var r=mr(t,1);if(r!==null){var s=Ct();In(r,t,1,s)}}),Wm(t,1)}};dm=function(t){if(t.tag===13){var e=mr(t,134217728);if(e!==null){var n=Ct();In(e,t,134217728,n)}Wm(t,134217728)}};XS=function(t){if(t.tag===13){var e=Yr(t),n=mr(t,e);if(n!==null){var r=Ct();In(n,t,e,r)}Wm(t,e)}};YS=function(){return me};QS=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};mf=function(t,e,n){switch(e){case"input":if(lf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Zc(r);if(!s)throw Error(B(90));ES(r),lf(r,s)}}}break;case"textarea":RS(t,n);break;case"select":e=n.value,e!=null&&Mo(t,!!n.multiple,e,!1)}};LS=Bm;BS=js;var eO={usingClientEntryPoint:!1,Events:[ul,Ro,Zc,PS,FS,Bm]},Wa={findFiberByHostInstance:Ns,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},tO={bundleType:Wa.bundleType,version:Wa.version,rendererPackageName:Wa.rendererPackageName,rendererConfig:Wa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zS(t),t===null?null:t.stateNode},findFiberByHostInstance:Wa.findFiberByHostInstance||ZA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{qc=nu.inject(tO),Wn=nu}catch{}}Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eO;Ht.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jm(e))throw Error(B(200));return QA(t,e,null,n)};Ht.createRoot=function(t,e){if(!jm(t))throw Error(B(299));var n=!1,r="",s=w2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Um(t,1,!1,null,null,n,!1,r,s),t[hr]=e.current,Ii(t.nodeType===8?t.parentNode:t),new Gm(e)};Ht.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=zS(e),t=t===null?null:t.stateNode,t};Ht.flushSync=function(t){return js(t)};Ht.hydrate=function(t,e,n){if(!id(e))throw Error(B(200));return ld(null,t,e,!0,n)};Ht.hydrateRoot=function(t,e,n){if(!jm(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",a=w2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=v2(e,null,t,1,n!=null?n:null,s,!1,o,a),t[hr]=e.current,Ii(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ad(e)};Ht.render=function(t,e,n){if(!id(e))throw Error(B(200));return ld(null,t,e,!1,n)};Ht.unmountComponentAtNode=function(t){if(!id(t))throw Error(B(40));return t._reactRootContainer?(js(function(){ld(null,null,t,!1,function(){t._reactRootContainer=null,t[hr]=null})}),!0):!1};Ht.unstable_batchedUpdates=Bm;Ht.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!id(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return ld(t,e,n,!1,r)};Ht.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Ht})(vS);var Uv=vS.exports;ef.createRoot=Uv.createRoot,ef.hydrateRoot=Uv.hydrateRoot;const Hm=A.exports.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),ud=A.exports.createContext({});function nO(){return A.exports.useContext(ud).visualElement}const dl=A.exports.createContext(null),oo=typeof document<"u",uc=oo?A.exports.useLayoutEffect:A.exports.useEffect,b2=A.exports.createContext({strict:!1});function rO(t,e,n,r){const s=nO(),o=A.exports.useContext(b2),a=A.exports.useContext(dl),i=A.exports.useContext(Hm).reducedMotion,l=A.exports.useRef(void 0);r=r||o.renderer,!l.current&&r&&(l.current=r(t,{visualState:e,parent:s,props:n,presenceId:a?a.id:void 0,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:i}));const u=l.current;return uc(()=>{u&&u.syncRender()}),A.exports.useEffect(()=>{u&&u.animationState&&u.animationState.animateChanges()}),uc(()=>()=>u&&u.notifyUnmount(),[]),u}function Lo(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function sO(t,e,n){return A.exports.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Lo(n)&&(n.current=r))},[e])}function Bi(t){return typeof t=="string"||Array.isArray(t)}function cd(t){return typeof t=="object"&&typeof t.start=="function"}const oO=["initial","animate","exit","whileHover","whileDrag","whileTap","whileFocus","whileInView"];function dd(t){return cd(t.animate)||oO.some(e=>Bi(t[e]))}function S2(t){return Boolean(dd(t)||t.variants)}function aO(t,e){if(dd(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Bi(n)?n:void 0,animate:Bi(r)?r:void 0}}return t.inherit!==!1?e:{}}function iO(t){const{initial:e,animate:n}=aO(t,A.exports.useContext(ud));return A.exports.useMemo(()=>({initial:e,animate:n}),[Wv(e),Wv(n)])}function Wv(t){return Array.isArray(t)?t.join(" "):t}const Jn=t=>({isEnabled:e=>t.some(n=>!!e[n])}),Vi={measureLayout:Jn(["layout","layoutId","drag"]),animation:Jn(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"]),exit:Jn(["exit"]),drag:Jn(["drag","dragControls"]),focus:Jn(["whileFocus"]),hover:Jn(["whileHover","onHoverStart","onHoverEnd"]),tap:Jn(["whileTap","onTap","onTapStart","onTapCancel"]),pan:Jn(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),inView:Jn(["whileInView","onViewportEnter","onViewportLeave"])};function lO(t){for(const e in t)e==="projectionNodeConstructor"?Vi.projectionNodeConstructor=t[e]:Vi[e].Component=t[e]}function pd(t){const e=A.exports.useRef(null);return e.current===null&&(e.current=t()),e.current}const fi={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let uO=1;function cO(){return pd(()=>{if(fi.hasEverUpdated)return uO++})}const Km=A.exports.createContext({});class dO extends al.Component{getSnapshotBeforeUpdate(){const{visualElement:e,props:n}=this.props;return e&&e.setProps(n),null}componentDidUpdate(){}render(){return this.props.children}}const C2=A.exports.createContext({}),pO=Symbol.for("motionComponentSymbol");var fd={exports:{}},hd={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fO=A.exports,hO=Symbol.for("react.element"),mO=Symbol.for("react.fragment"),gO=Object.prototype.hasOwnProperty,yO=fO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xO={key:!0,ref:!0,__self:!0,__source:!0};function $2(t,e,n){var r,s={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)gO.call(e,r)&&!xO.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:hO,type:t,key:o,ref:a,props:s,_owner:yO.current}}hd.Fragment=mO;hd.jsx=$2;hd.jsxs=$2;(function(t){t.exports=hd})(fd);const Hs=fd.exports.Fragment,T=fd.exports.jsx,X=fd.exports.jsxs;function vO({preloadedFeatures:t,createVisualElement:e,projectionNodeConstructor:n,useRender:r,useVisualState:s,Component:o}){t&&lO(t);function a(l,u){const c={...A.exports.useContext(Hm),...l,layoutId:wO(l)},{isStatic:d}=c;let p=null;const f=iO(l),h=d?void 0:cO(),g=s(l,d);if(!d&&oo){f.visualElement=rO(o,g,c,e);const y=A.exports.useContext(b2).strict,m=A.exports.useContext(C2);f.visualElement&&(p=f.visualElement.loadFeatures(c,y,t,h,n||Vi.projectionNodeConstructor,m))}return X(dO,{visualElement:f.visualElement,props:c,children:[p,T(ud.Provider,{value:f,children:r(o,l,h,sO(g,f.visualElement,u),g,d,f.visualElement)})]})}const i=A.exports.forwardRef(a);return i[pO]=o,i}function wO({layoutId:t}){const e=A.exports.useContext(Km).id;return e&&t!==void 0?e+"-"+t:t}function bO(t){function e(r,s={}){return vO(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const SO=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function qm(t){return typeof t!="string"||t.includes("-")?!1:!!(SO.indexOf(t)>-1||/[A-Z]/.test(t))}const cc={};function CO(t){Object.assign(cc,t)}const dc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],pl=new Set(dc);function T2(t,{layout:e,layoutId:n}){return pl.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!cc[t]||t==="opacity")}const Rn=t=>!!(t!=null&&t.getVelocity),$O={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},TO=(t,e)=>dc.indexOf(t)-dc.indexOf(e);function kO({transform:t,transformKeys:e},{enableHardwareAcceleration:n=!0,allowTransformNone:r=!0},s,o){let a="";e.sort(TO);for(const i of e)a+=`${$O[i]||i}(${t[i]}) `;return n&&!t.z&&(a+="translateZ(0)"),a=a.trim(),o?a=o(t,s?"":a):r&&s&&(a="none"),a}function k2(t){return t.startsWith("--")}const NO=(t,e)=>e&&typeof t=="number"?e.transform(t):t,N2=(t,e)=>n=>Math.max(Math.min(n,e),t),hi=t=>t%1?Number(t.toFixed(5)):t,Mi=/(-)?([\d]*\.?[\d])+/g,qf=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,EO=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function fl(t){return typeof t=="string"}const ao={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},mi=Object.assign(Object.assign({},ao),{transform:N2(0,1)}),ru=Object.assign(Object.assign({},ao),{default:1}),hl=t=>({test:e=>fl(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Er=hl("deg"),jn=hl("%"),te=hl("px"),IO=hl("vh"),RO=hl("vw"),Gv=Object.assign(Object.assign({},jn),{parse:t=>jn.parse(t)/100,transform:t=>jn.transform(t*100)}),Xm=(t,e)=>n=>Boolean(fl(n)&&EO.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),E2=(t,e,n)=>r=>{if(!fl(r))return r;const[s,o,a,i]=r.match(Mi);return{[t]:parseFloat(s),[e]:parseFloat(o),[n]:parseFloat(a),alpha:i!==void 0?parseFloat(i):1}},Rs={test:Xm("hsl","hue"),parse:E2("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+jn.transform(hi(e))+", "+jn.transform(hi(n))+", "+hi(mi.transform(r))+")"},_O=N2(0,255),kp=Object.assign(Object.assign({},ao),{transform:t=>Math.round(_O(t))}),Vr={test:Xm("rgb","red"),parse:E2("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+kp.transform(t)+", "+kp.transform(e)+", "+kp.transform(n)+", "+hi(mi.transform(r))+")"};function AO(t){let e="",n="",r="",s="";return t.length>5?(e=t.substr(1,2),n=t.substr(3,2),r=t.substr(5,2),s=t.substr(7,2)):(e=t.substr(1,1),n=t.substr(2,1),r=t.substr(3,1),s=t.substr(4,1),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Xf={test:Xm("#"),parse:AO,transform:Vr.transform},bt={test:t=>Vr.test(t)||Xf.test(t)||Rs.test(t),parse:t=>Vr.test(t)?Vr.parse(t):Rs.test(t)?Rs.parse(t):Xf.parse(t),transform:t=>fl(t)?t:t.hasOwnProperty("red")?Vr.transform(t):Rs.transform(t)},I2="${c}",R2="${n}";function OO(t){var e,n,r,s;return isNaN(t)&&fl(t)&&((n=(e=t.match(Mi))===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0)+((s=(r=t.match(qf))===null||r===void 0?void 0:r.length)!==null&&s!==void 0?s:0)>0}function _2(t){typeof t=="number"&&(t=`${t}`);const e=[];let n=0;const r=t.match(qf);r&&(n=r.length,t=t.replace(qf,I2),e.push(...r.map(bt.parse)));const s=t.match(Mi);return s&&(t=t.replace(Mi,R2),e.push(...s.map(ao.parse))),{values:e,numColors:n,tokenised:t}}function A2(t){return _2(t).values}function O2(t){const{values:e,numColors:n,tokenised:r}=_2(t),s=e.length;return o=>{let a=r;for(let i=0;i<s;i++)a=a.replace(i<n?I2:R2,i<n?bt.transform(o[i]):hi(o[i]));return a}}const DO=t=>typeof t=="number"?0:t;function PO(t){const e=A2(t);return O2(t)(e.map(DO))}const yr={test:OO,parse:A2,createTransformer:O2,getAnimatableNone:PO},FO=new Set(["brightness","contrast","saturate","opacity"]);function LO(t){let[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(Mi)||[];if(!r)return t;const s=n.replace(r,"");let o=FO.has(e)?1:0;return r!==n&&(o*=100),e+"("+o+s+")"}const BO=/([a-z-]*)\(.*?\)/g,Yf=Object.assign(Object.assign({},yr),{getAnimatableNone:t=>{const e=t.match(BO);return e?e.map(LO).join(" "):t}}),jv={...ao,transform:Math.round},D2={borderWidth:te,borderTopWidth:te,borderRightWidth:te,borderBottomWidth:te,borderLeftWidth:te,borderRadius:te,radius:te,borderTopLeftRadius:te,borderTopRightRadius:te,borderBottomRightRadius:te,borderBottomLeftRadius:te,width:te,maxWidth:te,height:te,maxHeight:te,size:te,top:te,right:te,bottom:te,left:te,padding:te,paddingTop:te,paddingRight:te,paddingBottom:te,paddingLeft:te,margin:te,marginTop:te,marginRight:te,marginBottom:te,marginLeft:te,rotate:Er,rotateX:Er,rotateY:Er,rotateZ:Er,scale:ru,scaleX:ru,scaleY:ru,scaleZ:ru,skew:Er,skewX:Er,skewY:Er,distance:te,translateX:te,translateY:te,translateZ:te,x:te,y:te,z:te,perspective:te,transformPerspective:te,opacity:mi,originX:Gv,originY:Gv,originZ:te,zIndex:jv,fillOpacity:mi,strokeOpacity:mi,numOctaves:jv};function Ym(t,e,n,r){const{style:s,vars:o,transform:a,transformKeys:i,transformOrigin:l}=t;i.length=0;let u=!1,c=!1,d=!0;for(const p in e){const f=e[p];if(k2(p)){o[p]=f;continue}const h=D2[p],g=NO(f,h);if(pl.has(p)){if(u=!0,a[p]=g,i.push(p),!d)continue;f!==(h.default||0)&&(d=!1)}else p.startsWith("origin")?(c=!0,l[p]=g):s[p]=g}if(e.transform||(u||r?s.transform=kO(t,n,d,r):s.transform&&(s.transform="none")),c){const{originX:p="50%",originY:f="50%",originZ:h=0}=l;s.transformOrigin=`${p} ${f} ${h}`}}const Qm=()=>({style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}});function P2(t,e,n){for(const r in e)!Rn(e[r])&&!T2(r,n)&&(t[r]=e[r])}function VO({transformTemplate:t},e,n){return A.exports.useMemo(()=>{const r=Qm();return Ym(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function MO(t,e,n){const r=t.style||{},s={};return P2(s,r,t),Object.assign(s,VO(t,e,n)),t.transformValues?t.transformValues(s):s}function zO(t,e,n){const r={},s=MO(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),r.style=s,r}const UO=["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"],WO=["whileTap","onTap","onTapStart","onTapCancel"],GO=["onPan","onPanStart","onPanSessionStart","onPanEnd"],jO=["whileInView","onViewportEnter","onViewportLeave","viewport"],HO=new Set(["initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","layoutDependency","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","dragSnapToOrigin","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","onHoverStart","onHoverEnd","layoutScroll",...jO,...WO,...UO,...GO]);function pc(t){return HO.has(t)}let F2=t=>!pc(t);function KO(t){!t||(F2=e=>e.startsWith("on")?!pc(e):t(e))}try{KO(require("@emotion/is-prop-valid").default)}catch{}function qO(t,e,n){const r={};for(const s in t)(F2(s)||n===!0&&pc(s)||!e&&!pc(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function Hv(t,e,n){return typeof t=="string"?t:te.transform(e+n*t)}function XO(t,e,n){const r=Hv(e,t.x,t.width),s=Hv(n,t.y,t.height);return`${r} ${s}`}const YO={offset:"stroke-dashoffset",array:"stroke-dasharray"},QO={offset:"strokeDashoffset",array:"strokeDasharray"};function ZO(t,e,n=1,r=0,s=!0){t.pathLength=1;const o=s?YO:QO;t[o.offset]=te.transform(-r);const a=te.transform(e),i=te.transform(n);t[o.array]=`${a} ${i}`}function Zm(t,{attrX:e,attrY:n,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:i=0,...l},u,c){Ym(t,l,u,c),t.attrs=t.style,t.style={};const{attrs:d,style:p,dimensions:f}=t;d.transform&&(f&&(p.transform=d.transform),delete d.transform),f&&(r!==void 0||s!==void 0||p.transform)&&(p.transformOrigin=XO(f,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),o!==void 0&&ZO(d,o,a,i,!1)}const L2=()=>({...Qm(),attrs:{}});function JO(t,e){const n=A.exports.useMemo(()=>{const r=L2();return Zm(r,e,{enableHardwareAcceleration:!1},t.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};P2(r,t.style,t),n.style={...r,...n.style}}return n}function eD(t=!1){return(n,r,s,o,{latestValues:a},i)=>{const u=(qm(n)?JO:zO)(r,a,i),d={...qO(r,typeof n=="string",t),...u,ref:o};return s&&(d["data-projection-id"]=s),A.exports.createElement(n,d)}}const B2=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function V2(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const o in n)t.style.setProperty(o,n[o])}const M2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength"]);function z2(t,e,n,r){V2(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(M2.has(s)?s:B2(s),e.attrs[s])}function Jm(t){const{style:e}=t,n={};for(const r in e)(Rn(e[r])||T2(r,t))&&(n[r]=e[r]);return n}function U2(t){const e=Jm(t);for(const n in t)if(Rn(t[n])){const r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;e[r]=t[n]}return e}function eg(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}const zi=t=>Array.isArray(t),tD=t=>Boolean(t&&typeof t=="object"&&t.mix&&t.toValue),W2=t=>zi(t)?t[t.length-1]||0:t;function Au(t){const e=Rn(t)?t.get():t;return tD(e)?e.toValue():e}function nD({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,o){const a={latestValues:rD(r,s,o,t),renderState:e()};return n&&(a.mount=i=>n(r,i,a)),a}const G2=t=>(e,n)=>{const r=A.exports.useContext(ud),s=A.exports.useContext(dl),o=()=>nD(t,e,r,s);return n?o():pd(o)};function rD(t,e,n,r){const s={},o=r(t);for(const p in o)s[p]=Au(o[p]);let{initial:a,animate:i}=t;const l=dd(t),u=S2(t);e&&u&&!l&&t.inherit!==!1&&(a===void 0&&(a=e.initial),i===void 0&&(i=e.animate));let c=n?n.initial===!1:!1;c=c||a===!1;const d=c?i:a;return d&&typeof d!="boolean"&&!cd(d)&&(Array.isArray(d)?d:[d]).forEach(f=>{const h=eg(t,f);if(!h)return;const{transitionEnd:g,transition:y,...m}=h;for(const x in m){let v=m[x];if(Array.isArray(v)){const b=c?v.length-1:0;v=v[b]}v!==null&&(s[x]=v)}for(const x in g)s[x]=g[x]}),s}const sD={useVisualState:G2({scrapeMotionValuesFromProps:U2,createRenderState:L2,onMount:(t,e,{renderState:n,latestValues:r})=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}Zm(n,r,{enableHardwareAcceleration:!1},t.transformTemplate),z2(e,n)}})},oD={useVisualState:G2({scrapeMotionValuesFromProps:Jm,createRenderState:Qm})};function aD(t,{forwardMotionProps:e=!1},n,r,s){return{...qm(t)?sD:oD,preloadedFeatures:n,useRender:eD(e),createVisualElement:r,projectionNodeConstructor:s,Component:t}}var we;(function(t){t.Animate="animate",t.Hover="whileHover",t.Tap="whileTap",t.Drag="whileDrag",t.Focus="whileFocus",t.InView="whileInView",t.Exit="exit"})(we||(we={}));function md(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Qf(t,e,n,r){A.exports.useEffect(()=>{const s=t.current;if(n&&s)return md(s,e,n,r)},[t,e,n,r])}function iD({whileFocus:t,visualElement:e}){const{animationState:n}=e,r=()=>{n&&n.setActive(we.Focus,!0)},s=()=>{n&&n.setActive(we.Focus,!1)};Qf(e,"focus",t?r:void 0),Qf(e,"blur",t?s:void 0)}function j2(t){return typeof PointerEvent<"u"&&t instanceof PointerEvent?t.pointerType==="mouse":t instanceof MouseEvent}function H2(t){return!!t.touches}function lD(t){return e=>{const n=e instanceof MouseEvent;(!n||n&&e.button===0)&&t(e)}}const uD={pageX:0,pageY:0};function cD(t,e="page"){const r=t.touches[0]||t.changedTouches[0]||uD;return{x:r[e+"X"],y:r[e+"Y"]}}function dD(t,e="page"){return{x:t[e+"X"],y:t[e+"Y"]}}function tg(t,e="page"){return{point:H2(t)?cD(t,e):dD(t,e)}}const K2=(t,e=!1)=>{const n=r=>t(r,tg(r));return e?lD(n):n},pD=()=>oo&&window.onpointerdown===null,fD=()=>oo&&window.ontouchstart===null,hD=()=>oo&&window.onmousedown===null,mD={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},gD={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function q2(t){return pD()?t:fD()?gD[t]:hD()?mD[t]:t}function Ho(t,e,n,r){return md(t,q2(e),K2(n,e==="pointerdown"),r)}function fc(t,e,n,r){return Qf(t,q2(e),n&&K2(n,e==="pointerdown"),r)}function X2(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const Kv=X2("dragHorizontal"),qv=X2("dragVertical");function Y2(t){let e=!1;if(t==="y")e=qv();else if(t==="x")e=Kv();else{const n=Kv(),r=qv();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function Q2(){const t=Y2(!0);return t?(t(),!1):!0}function Xv(t,e,n){return(r,s)=>{!j2(r)||Q2()||(t.animationState&&t.animationState.setActive(we.Hover,e),n&&n(r,s))}}function yD({onHoverStart:t,onHoverEnd:e,whileHover:n,visualElement:r}){fc(r,"pointerenter",t||n?Xv(r,!0,t):void 0,{passive:!t}),fc(r,"pointerleave",e||n?Xv(r,!1,e):void 0,{passive:!e})}const Z2=(t,e)=>e?t===e?!0:Z2(t,e.parentElement):!1;function ng(t){return A.exports.useEffect(()=>()=>t(),[])}function J2(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}var xD=function(){},hc=function(){};const mc=(t,e,n)=>Math.min(Math.max(n,t),e),Np=.001,vD=.01,Yv=10,wD=.05,bD=1;function SD({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,o;xD(t<=Yv*1e3);let a=1-e;a=mc(wD,bD,a),t=mc(vD,Yv,t/1e3),a<1?(s=u=>{const c=u*a,d=c*t,p=c-n,f=Zf(u,a),h=Math.exp(-d);return Np-p/f*h},o=u=>{const d=u*a*t,p=d*n+n,f=Math.pow(a,2)*Math.pow(u,2)*t,h=Math.exp(-d),g=Zf(Math.pow(u,2),a);return(-s(u)+Np>0?-1:1)*((p-f)*h)/g}):(s=u=>{const c=Math.exp(-u*t),d=(u-n)*t+1;return-Np+c*d},o=u=>{const c=Math.exp(-u*t),d=(n-u)*(t*t);return c*d});const i=5/t,l=$D(s,o,i);if(t=t*1e3,isNaN(l))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:t}}}const CD=12;function $D(t,e,n){let r=n;for(let s=1;s<CD;s++)r=r-t(r)/e(r);return r}function Zf(t,e){return t*Math.sqrt(1-e*e)}const TD=["duration","bounce"],kD=["stiffness","damping","mass"];function Qv(t,e){return e.some(n=>t[n]!==void 0)}function ND(t){let e=Object.assign({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},t);if(!Qv(t,kD)&&Qv(t,TD)){const n=SD(t);e=Object.assign(Object.assign(Object.assign({},e),n),{velocity:0,mass:1}),e.isResolvedFromDuration=!0}return e}function rg(t){var{from:e=0,to:n=1,restSpeed:r=2,restDelta:s}=t,o=J2(t,["from","to","restSpeed","restDelta"]);const a={done:!1,value:e};let{stiffness:i,damping:l,mass:u,velocity:c,duration:d,isResolvedFromDuration:p}=ND(o),f=Zv,h=Zv;function g(){const y=c?-(c/1e3):0,m=n-e,x=l/(2*Math.sqrt(i*u)),v=Math.sqrt(i/u)/1e3;if(s===void 0&&(s=Math.min(Math.abs(n-e)/100,.4)),x<1){const b=Zf(v,x);f=C=>{const k=Math.exp(-x*v*C);return n-k*((y+x*v*m)/b*Math.sin(b*C)+m*Math.cos(b*C))},h=C=>{const k=Math.exp(-x*v*C);return x*v*k*(Math.sin(b*C)*(y+x*v*m)/b+m*Math.cos(b*C))-k*(Math.cos(b*C)*(y+x*v*m)-b*m*Math.sin(b*C))}}else if(x===1)f=b=>n-Math.exp(-v*b)*(m+(y+v*m)*b);else{const b=v*Math.sqrt(x*x-1);f=C=>{const k=Math.exp(-x*v*C),I=Math.min(b*C,300);return n-k*((y+x*v*m)*Math.sinh(I)+b*m*Math.cosh(I))/b}}}return g(),{next:y=>{const m=f(y);if(p)a.done=y>=d;else{const x=h(y)*1e3,v=Math.abs(x)<=r,b=Math.abs(n-m)<=s;a.done=v&&b}return a.value=a.done?n:m,a},flipTarget:()=>{c=-c,[e,n]=[n,e],g()}}}rg.needsInterpolation=(t,e)=>typeof t=="string"||typeof e=="string";const Zv=t=>0,Ui=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},Le=(t,e,n)=>-n*t+n*e+t;function Ep(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Jv({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,o=0,a=0;if(!e)s=o=a=n;else{const i=n<.5?n*(1+e):n+e-n*e,l=2*n-i;s=Ep(l,i,t+1/3),o=Ep(l,i,t),a=Ep(l,i,t-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:r}}const ED=(t,e,n)=>{const r=t*t,s=e*e;return Math.sqrt(Math.max(0,n*(s-r)+r))},ID=[Xf,Vr,Rs],ew=t=>ID.find(e=>e.test(t)),e$=(t,e)=>{let n=ew(t),r=ew(e),s=n.parse(t),o=r.parse(e);n===Rs&&(s=Jv(s),n=Vr),r===Rs&&(o=Jv(o),r=Vr);const a=Object.assign({},s);return i=>{for(const l in a)l!=="alpha"&&(a[l]=ED(s[l],o[l],i));return a.alpha=Le(s.alpha,o.alpha,i),n.transform(a)}},Jf=t=>typeof t=="number",RD=(t,e)=>n=>e(t(n)),gd=(...t)=>t.reduce(RD);function t$(t,e){return Jf(t)?n=>Le(t,e,n):bt.test(t)?e$(t,e):r$(t,e)}const n$=(t,e)=>{const n=[...t],r=n.length,s=t.map((o,a)=>t$(o,e[a]));return o=>{for(let a=0;a<r;a++)n[a]=s[a](o);return n}},_D=(t,e)=>{const n=Object.assign(Object.assign({},t),e),r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=t$(t[s],e[s]));return s=>{for(const o in r)n[o]=r[o](s);return n}};function tw(t){const e=yr.parse(t),n=e.length;let r=0,s=0,o=0;for(let a=0;a<n;a++)r||typeof e[a]=="number"?r++:e[a].hue!==void 0?o++:s++;return{parsed:e,numNumbers:r,numRGB:s,numHSL:o}}const r$=(t,e)=>{const n=yr.createTransformer(e),r=tw(t),s=tw(e);return r.numHSL===s.numHSL&&r.numRGB===s.numRGB&&r.numNumbers>=s.numNumbers?gd(n$(r.parsed,s.parsed),n):a=>`${a>0?e:t}`},AD=(t,e)=>n=>Le(t,e,n);function OD(t){if(typeof t=="number")return AD;if(typeof t=="string")return bt.test(t)?e$:r$;if(Array.isArray(t))return n$;if(typeof t=="object")return _D}function DD(t,e,n){const r=[],s=n||OD(t[0]),o=t.length-1;for(let a=0;a<o;a++){let i=s(t[a],t[a+1]);if(e){const l=Array.isArray(e)?e[a]:e;i=gd(l,i)}r.push(i)}return r}function PD([t,e],[n]){return r=>n(Ui(t,e,r))}function FD(t,e){const n=t.length,r=n-1;return s=>{let o=0,a=!1;if(s<=t[0]?a=!0:s>=t[r]&&(o=r-1,a=!0),!a){let l=1;for(;l<n&&!(t[l]>s||l===r);l++);o=l-1}const i=Ui(t[o],t[o+1],s);return e[o](i)}}function s$(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const o=t.length;hc(o===e.length),hc(!r||!Array.isArray(r)||r.length===o-1),t[0]>t[o-1]&&(t=[].concat(t),e=[].concat(e),t.reverse(),e.reverse());const a=DD(e,r,s),i=o===2?PD(t,a):FD(t,a);return n?l=>i(mc(t[0],t[o-1],l)):i}const yd=t=>e=>1-t(1-e),sg=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,LD=t=>e=>Math.pow(e,t),o$=t=>e=>e*e*((t+1)*e-t),BD=t=>{const e=o$(t);return n=>(n*=2)<1?.5*e(n):.5*(2-Math.pow(2,-10*(n-1)))},a$=1.525,VD=4/11,MD=8/11,zD=9/10,og=t=>t,ag=LD(2),UD=yd(ag),i$=sg(ag),l$=t=>1-Math.sin(Math.acos(t)),ig=yd(l$),WD=sg(ig),lg=o$(a$),GD=yd(lg),jD=sg(lg),HD=BD(a$),KD=4356/361,qD=35442/1805,XD=16061/1805,gc=t=>{if(t===1||t===0)return t;const e=t*t;return t<VD?7.5625*e:t<MD?9.075*e-9.9*t+3.4:t<zD?KD*e-qD*t+XD:10.8*t*t-20.52*t+10.72},YD=yd(gc),QD=t=>t<.5?.5*(1-gc(1-t*2)):.5*gc(t*2-1)+.5;function ZD(t,e){return t.map(()=>e||i$).splice(0,t.length-1)}function JD(t){const e=t.length;return t.map((n,r)=>r!==0?r/(e-1):0)}function eP(t,e){return t.map(n=>n*e)}function Ou({from:t=0,to:e=1,ease:n,offset:r,duration:s=300}){const o={done:!1,value:t},a=Array.isArray(e)?e:[t,e],i=eP(r&&r.length===a.length?r:JD(a),s);function l(){return s$(i,a,{ease:Array.isArray(n)?n:ZD(a,n)})}let u=l();return{next:c=>(o.value=u(c),o.done=c>=s,o),flipTarget:()=>{a.reverse(),u=l()}}}function tP({velocity:t=0,from:e=0,power:n=.8,timeConstant:r=350,restDelta:s=.5,modifyTarget:o}){const a={done:!1,value:e};let i=n*t;const l=e+i,u=o===void 0?l:o(l);return u!==l&&(i=u-e),{next:c=>{const d=-i*Math.exp(-c/r);return a.done=!(d>s||d<-s),a.value=a.done?u:u+d,a},flipTarget:()=>{}}}const nw={keyframes:Ou,spring:rg,decay:tP};function nP(t){if(Array.isArray(t.to))return Ou;if(nw[t.type])return nw[t.type];const e=new Set(Object.keys(t));return e.has("ease")||e.has("duration")&&!e.has("dampingRatio")?Ou:e.has("dampingRatio")||e.has("stiffness")||e.has("mass")||e.has("damping")||e.has("restSpeed")||e.has("restDelta")?rg:Ou}const u$=1/60*1e3,rP=typeof performance<"u"?()=>performance.now():()=>Date.now(),c$=typeof window<"u"?t=>window.requestAnimationFrame(t):t=>setTimeout(()=>t(rP()),u$);function sP(t){let e=[],n=[],r=0,s=!1,o=!1;const a=new WeakSet,i={schedule:(l,u=!1,c=!1)=>{const d=c&&s,p=d?e:n;return u&&a.add(l),p.indexOf(l)===-1&&(p.push(l),d&&s&&(r=e.length)),l},cancel:l=>{const u=n.indexOf(l);u!==-1&&n.splice(u,1),a.delete(l)},process:l=>{if(s){o=!0;return}if(s=!0,[e,n]=[n,e],n.length=0,r=e.length,r)for(let u=0;u<r;u++){const c=e[u];c(l),a.has(c)&&(i.schedule(c),t())}s=!1,o&&(o=!1,i.process(l))}};return i}const oP=40;let eh=!0,Wi=!1,th=!1;const Ko={delta:0,timestamp:0},ml=["read","update","preRender","render","postRender"],xd=ml.reduce((t,e)=>(t[e]=sP(()=>Wi=!0),t),{}),fn=ml.reduce((t,e)=>{const n=xd[e];return t[e]=(r,s=!1,o=!1)=>(Wi||iP(),n.schedule(r,s,o)),t},{}),ns=ml.reduce((t,e)=>(t[e]=xd[e].cancel,t),{}),Ip=ml.reduce((t,e)=>(t[e]=()=>xd[e].process(Ko),t),{}),aP=t=>xd[t].process(Ko),d$=t=>{Wi=!1,Ko.delta=eh?u$:Math.max(Math.min(t-Ko.timestamp,oP),1),Ko.timestamp=t,th=!0,ml.forEach(aP),th=!1,Wi&&(eh=!1,c$(d$))},iP=()=>{Wi=!0,eh=!0,th||c$(d$)},yc=()=>Ko;function p$(t,e,n=0){return t-e-n}function lP(t,e,n=0,r=!0){return r?p$(e+-t,e,n):e-(t-e)+n}function uP(t,e,n,r){return r?t>=e+n:t<=-n}const cP=t=>{const e=({delta:n})=>t(n);return{start:()=>fn.update(e,!0),stop:()=>ns.update(e)}};function f$(t){var e,n,{from:r,autoplay:s=!0,driver:o=cP,elapsed:a=0,repeat:i=0,repeatType:l="loop",repeatDelay:u=0,onPlay:c,onStop:d,onComplete:p,onRepeat:f,onUpdate:h}=t,g=J2(t,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]);let{to:y}=g,m,x=0,v=g.duration,b,C=!1,k=!0,I;const R=nP(g);!((n=(e=R).needsInterpolation)===null||n===void 0)&&n.call(e,r,y)&&(I=s$([0,100],[r,y],{clamp:!1}),r=0,y=100);const D=R(Object.assign(Object.assign({},g),{from:r,to:y}));function O(){x++,l==="reverse"?(k=x%2===0,a=lP(a,v,u,k)):(a=p$(a,v,u),l==="mirror"&&D.flipTarget()),C=!1,f&&f()}function V(){m.stop(),p&&p()}function j(J){if(k||(J=-J),a+=J,!C){const re=D.next(Math.max(0,a));b=re.value,I&&(b=I(b)),C=k?re.done:a<=0}h==null||h(b),C&&(x===0&&(v!=null||(v=a)),x<i?uP(a,v,u,k)&&O():V())}function Z(){c==null||c(),m=o(j),m.start()}return s&&Z(),{stop:()=>{d==null||d(),m.stop()}}}function h$(t,e){return e?t*(1e3/e):0}function dP({from:t=0,velocity:e=0,min:n,max:r,power:s=.8,timeConstant:o=750,bounceStiffness:a=500,bounceDamping:i=10,restDelta:l=1,modifyTarget:u,driver:c,onUpdate:d,onComplete:p,onStop:f}){let h;function g(v){return n!==void 0&&v<n||r!==void 0&&v>r}function y(v){return n===void 0?r:r===void 0||Math.abs(n-v)<Math.abs(r-v)?n:r}function m(v){h==null||h.stop(),h=f$(Object.assign(Object.assign({},v),{driver:c,onUpdate:b=>{var C;d==null||d(b),(C=v.onUpdate)===null||C===void 0||C.call(v,b)},onComplete:p,onStop:f}))}function x(v){m(Object.assign({type:"spring",stiffness:a,damping:i,restDelta:l},v))}if(g(t))x({from:t,velocity:e,to:y(t)});else{let v=s*e+t;typeof u<"u"&&(v=u(v));const b=y(v),C=b===n?-1:1;let k,I;const R=D=>{k=I,I=D,e=h$(D-k,yc().delta),(C===1&&D>b||C===-1&&D<b)&&x({from:D,to:b,velocity:e})};m({type:"decay",from:t,velocity:e,timeConstant:o,power:s,restDelta:l,modifyTarget:u,onUpdate:g(v)?R:void 0})}return{stop:()=>h==null?void 0:h.stop()}}const nh=t=>t.hasOwnProperty("x")&&t.hasOwnProperty("y"),rw=t=>nh(t)&&t.hasOwnProperty("z"),su=(t,e)=>Math.abs(t-e);function ug(t,e){if(Jf(t)&&Jf(e))return su(t,e);if(nh(t)&&nh(e)){const n=su(t.x,e.x),r=su(t.y,e.y),s=rw(t)&&rw(e)?su(t.z,e.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(s,2))}}const m$=(t,e)=>1-3*e+3*t,g$=(t,e)=>3*e-6*t,y$=t=>3*t,xc=(t,e,n)=>((m$(e,n)*t+g$(e,n))*t+y$(e))*t,x$=(t,e,n)=>3*m$(e,n)*t*t+2*g$(e,n)*t+y$(e),pP=1e-7,fP=10;function hP(t,e,n,r,s){let o,a,i=0;do a=e+(n-e)/2,o=xc(a,r,s)-t,o>0?n=a:e=a;while(Math.abs(o)>pP&&++i<fP);return a}const mP=8,gP=.001;function yP(t,e,n,r){for(let s=0;s<mP;++s){const o=x$(e,n,r);if(o===0)return e;const a=xc(e,n,r)-t;e-=a/o}return e}const Du=11,ou=1/(Du-1);function xP(t,e,n,r){if(t===e&&n===r)return og;const s=new Float32Array(Du);for(let a=0;a<Du;++a)s[a]=xc(a*ou,t,n);function o(a){let i=0,l=1;const u=Du-1;for(;l!==u&&s[l]<=a;++l)i+=ou;--l;const c=(a-s[l])/(s[l+1]-s[l]),d=i+c*ou,p=x$(d,t,n);return p>=gP?yP(a,d,t,n):p===0?d:hP(a,i,i+ou,t,n)}return a=>a===0||a===1?a:xc(o(a),e,r)}function vP({onTap:t,onTapStart:e,onTapCancel:n,whileTap:r,visualElement:s}){const o=t||e||n||r,a=A.exports.useRef(!1),i=A.exports.useRef(null),l={passive:!(e||t||n||f)};function u(){i.current&&i.current(),i.current=null}function c(){return u(),a.current=!1,s.animationState&&s.animationState.setActive(we.Tap,!1),!Q2()}function d(h,g){!c()||(Z2(s.getInstance(),h.target)?t&&t(h,g):n&&n(h,g))}function p(h,g){!c()||n&&n(h,g)}function f(h,g){u(),!a.current&&(a.current=!0,i.current=gd(Ho(window,"pointerup",d,l),Ho(window,"pointercancel",p,l)),s.animationState&&s.animationState.setActive(we.Tap,!0),e&&e(h,g))}fc(s,"pointerdown",o?f:void 0,l),ng(u)}const wP="production",v$=typeof process>"u"||process.env===void 0?wP:"production",sw=new Set;function w$(t,e,n){t||sw.has(e)||(console.warn(e),n&&console.warn(n),sw.add(e))}const rh=new WeakMap,Rp=new WeakMap,bP=t=>{const e=rh.get(t.target);e&&e(t)},SP=t=>{t.forEach(bP)};function CP({root:t,...e}){const n=t||document;Rp.has(n)||Rp.set(n,{});const r=Rp.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(SP,{root:t,...e})),r[s]}function $P(t,e,n){const r=CP(e);return rh.set(t,n),r.observe(t),()=>{rh.delete(t),r.unobserve(t)}}function TP({visualElement:t,whileInView:e,onViewportEnter:n,onViewportLeave:r,viewport:s={}}){const o=A.exports.useRef({hasEnteredView:!1,isInView:!1});let a=Boolean(e||n||r);s.once&&o.current.hasEnteredView&&(a=!1),(typeof IntersectionObserver>"u"?EP:NP)(a,o.current,t,s)}const kP={some:0,all:1};function NP(t,e,n,{root:r,margin:s,amount:o="some",once:a}){A.exports.useEffect(()=>{if(!t)return;const i={root:r==null?void 0:r.current,rootMargin:s,threshold:typeof o=="number"?o:kP[o]},l=u=>{const{isIntersecting:c}=u;if(e.isInView===c||(e.isInView=c,a&&!c&&e.hasEnteredView))return;c&&(e.hasEnteredView=!0),n.animationState&&n.animationState.setActive(we.InView,c);const d=n.getProps(),p=c?d.onViewportEnter:d.onViewportLeave;p&&p(u)};return $P(n.getInstance(),i,l)},[t,r,s,o])}function EP(t,e,n,{fallback:r=!0}){A.exports.useEffect(()=>{!t||!r||(v$!=="production"&&w$(!1,"IntersectionObserver not available on this device. whileInView animations will trigger on mount."),requestAnimationFrame(()=>{e.hasEnteredView=!0;const{onViewportEnter:s}=n.getProps();s&&s(null),n.animationState&&n.animationState.setActive(we.InView,!0)}))},[t])}const Mr=t=>e=>(t(e),null),IP={inView:Mr(TP),tap:Mr(vP),focus:Mr(iD),hover:Mr(yD)};function b$(){const t=A.exports.useContext(dl);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=A.exports.useId();return A.exports.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}function S$(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const vc=t=>t*1e3,RP={linear:og,easeIn:ag,easeInOut:i$,easeOut:UD,circIn:l$,circInOut:WD,circOut:ig,backIn:lg,backInOut:jD,backOut:GD,anticipate:HD,bounceIn:YD,bounceInOut:QD,bounceOut:gc},ow=t=>{if(Array.isArray(t)){hc(t.length===4);const[e,n,r,s]=t;return xP(e,n,r,s)}else if(typeof t=="string")return RP[t];return t},_P=t=>Array.isArray(t)&&typeof t[0]!="number",aw=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&yr.test(e)&&!e.startsWith("url(")),gs=()=>({type:"spring",stiffness:500,damping:25,restSpeed:10}),au=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),_p=()=>({type:"keyframes",ease:"linear",duration:.3}),AP=t=>({type:"keyframes",duration:.8,values:t}),iw={x:gs,y:gs,z:gs,rotate:gs,rotateX:gs,rotateY:gs,rotateZ:gs,scaleX:au,scaleY:au,scale:au,opacity:_p,backgroundColor:_p,color:_p,default:au},OP=(t,e)=>{let n;return zi(e)?n=AP:n=iw[t]||iw.default,{to:e,...n(e)}},DP={...D2,color:bt,backgroundColor:bt,outlineColor:bt,fill:bt,stroke:bt,borderColor:bt,borderTopColor:bt,borderRightColor:bt,borderBottomColor:bt,borderLeftColor:bt,filter:Yf,WebkitFilter:Yf},cg=t=>DP[t];function dg(t,e){var n;let r=cg(t);return r!==Yf&&(r=yr),(n=r.getAnimatableNone)===null||n===void 0?void 0:n.call(r,e)}const PP={current:!1};function C$(t,e){const n=performance.now(),r=({timestamp:s})=>{const o=s-n;o>=e&&(ns.read(r),t(o-e))};return fn.read(r,!0),()=>ns.read(r)}function FP({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:a,repeatDelay:i,from:l,...u}){return!!Object.keys(u).length}function LP({ease:t,times:e,yoyo:n,flip:r,loop:s,...o}){const a={...o};return e&&(a.offset=e),o.duration&&(a.duration=vc(o.duration)),o.repeatDelay&&(a.repeatDelay=vc(o.repeatDelay)),t&&(a.ease=_P(t)?t.map(ow):ow(t)),o.type==="tween"&&(a.type="keyframes"),(n||s||r)&&(n?a.repeatType="reverse":s?a.repeatType="loop":r&&(a.repeatType="mirror"),a.repeat=s||n||r||o.repeat),o.type!=="spring"&&(a.type="keyframes"),a}function BP(t,e){var n,r;return(r=(n=(pg(t,e)||{}).delay)!==null&&n!==void 0?n:t.delay)!==null&&r!==void 0?r:0}function VP(t){return Array.isArray(t.to)&&t.to[0]===null&&(t.to=[...t.to],t.to[0]=t.from),t}function MP(t,e,n){return Array.isArray(e.to)&&t.duration===void 0&&(t.duration=.8),VP(e),FP(t)||(t={...t,...OP(n,e.to)}),{...e,...LP(t)}}function zP(t,e,n,r,s){const o=pg(r,t)||{};let a=o.from!==void 0?o.from:e.get();const i=aw(t,n);a==="none"&&i&&typeof n=="string"?a=dg(t,n):lw(a)&&typeof n=="string"?a=uw(n):!Array.isArray(n)&&lw(n)&&typeof a=="string"&&(n=uw(a));const l=aw(t,a);function u(){const d={from:a,to:n,velocity:e.getVelocity(),onComplete:s,onUpdate:p=>e.set(p)};return o.type==="inertia"||o.type==="decay"?dP({...d,...o}):f$({...MP(o,d,t),onUpdate:p=>{d.onUpdate(p),o.onUpdate&&o.onUpdate(p)},onComplete:()=>{d.onComplete(),o.onComplete&&o.onComplete()}})}function c(){const d=W2(n);return e.set(d),s(),o.onUpdate&&o.onUpdate(d),o.onComplete&&o.onComplete(),{stop:()=>{}}}return!l||!i||o.type===!1?c:u}function lw(t){return t===0||typeof t=="string"&&parseFloat(t)===0&&t.indexOf(" ")===-1}function uw(t){return typeof t=="number"?0:dg("",t)}function pg(t,e){return t[e]||t.default||t}function fg(t,e,n,r={}){return PP.current&&(r={type:!1}),e.start(s=>{let o;const a=zP(t,e,n,r,s),i=BP(r,t),l=()=>o=a();let u;return i?u=C$(l,vc(i)):l(),()=>{u&&u(),o&&o.stop()}})}const UP=t=>/^\-?\d*\.?\d+$/.test(t),WP=t=>/^0[^.\s]+$/.test(t);function hg(t,e){t.indexOf(e)===-1&&t.push(e)}function mg(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class gi{constructor(){this.subscriptions=[]}add(e){return hg(this.subscriptions,e),()=>mg(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(!!s)if(s===1)this.subscriptions[0](e,n,r);else for(let o=0;o<s;o++){const a=this.subscriptions[o];a&&a(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const GP=t=>!isNaN(parseFloat(t));class jP{constructor(e){this.version="7.6.1",this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new gi,this.velocityUpdateSubscribers=new gi,this.renderSubscribers=new gi,this.canTrackVelocity=!1,this.updateAndNotify=(n,r=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:o}=yc();this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,fn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.updateSubscribers.notify(this.current),this.velocityUpdateSubscribers.getSize()&&this.velocityUpdateSubscribers.notify(this.getVelocity()),r&&this.renderSubscribers.notify(this.current)},this.scheduleVelocityCheck=()=>fn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.velocityUpdateSubscribers.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=GP(this.current)}onChange(e){return this.updateSubscribers.add(e)}clearListeners(){this.updateSubscribers.clear()}onRenderRequest(e){return e(this.get()),this.renderSubscribers.add(e)}attach(e){this.passiveEffect=e}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?h$(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.stopAnimation=e(n)}).then(()=>this.clearAnimation())}stop(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()}isAnimating(){return!!this.stopAnimation}clearAnimation(){this.stopAnimation=null}destroy(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()}}function aa(t){return new jP(t)}const $$=t=>e=>e.test(t),HP={test:t=>t==="auto",parse:t=>t},T$=[ao,te,jn,Er,RO,IO,HP],Ga=t=>T$.find($$(t)),KP=[...T$,bt,yr],qP=t=>KP.find($$(t));function XP(t){const e={};return t.forEachValue((n,r)=>e[r]=n.get()),e}function YP(t){const e={};return t.forEachValue((n,r)=>e[r]=n.getVelocity()),e}function vd(t,e,n){const r=t.getProps();return eg(r,e,n!==void 0?n:r.custom,XP(t),YP(t))}function QP(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,aa(n))}function ZP(t,e){const n=vd(t,e);let{transitionEnd:r={},transition:s={},...o}=n?t.makeTargetAnimatable(n,!1):{};o={...o,...r};for(const a in o){const i=W2(o[a]);QP(t,a,i)}}function JP(t,e,n){var r,s;const o=Object.keys(e).filter(i=>!t.hasValue(i)),a=o.length;if(!!a)for(let i=0;i<a;i++){const l=o[i],u=e[l];let c=null;Array.isArray(u)&&(c=u[0]),c===null&&(c=(s=(r=n[l])!==null&&r!==void 0?r:t.readValue(l))!==null&&s!==void 0?s:e[l]),c!=null&&(typeof c=="string"&&(UP(c)||WP(c))?c=parseFloat(c):!qP(c)&&yr.test(u)&&(c=dg(l,u)),t.addValue(l,aa(c)),n[l]===void 0&&(n[l]=c),t.setBaseTarget(l,c))}}function eF(t,e){return e?(e[t]||e.default||e).from:void 0}function tF(t,e,n){var r;const s={};for(const o in t){const a=eF(o,e);s[o]=a!==void 0?a:(r=n.getValue(o))===null||r===void 0?void 0:r.get()}return s}function wc(t){return Boolean(Rn(t)&&t.add)}function nF(t,e,n={}){t.notifyAnimationStart(e);let r;if(Array.isArray(e)){const s=e.map(o=>sh(t,o,n));r=Promise.all(s)}else if(typeof e=="string")r=sh(t,e,n);else{const s=typeof e=="function"?vd(t,e,n.custom):e;r=k$(t,s,n)}return r.then(()=>t.notifyAnimationComplete(e))}function sh(t,e,n={}){var r;const s=vd(t,e,n.custom);let{transition:o=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(o=n.transitionOverride);const a=s?()=>k$(t,s,n):()=>Promise.resolve(),i=!((r=t.variantChildren)===null||r===void 0)&&r.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:d,staggerDirection:p}=o;return rF(t,e,c+u,d,p,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,c]=l==="beforeChildren"?[a,i]:[i,a];return u().then(c)}else return Promise.all([a(),i(n.delay)])}function k$(t,e,{delay:n=0,transitionOverride:r,type:s}={}){var o;let{transition:a=t.getDefaultTransition(),transitionEnd:i,...l}=t.makeTargetAnimatable(e);const u=t.getValue("willChange");r&&(a=r);const c=[],d=s&&((o=t.animationState)===null||o===void 0?void 0:o.getState()[s]);for(const p in l){const f=t.getValue(p),h=l[p];if(!f||h===void 0||d&&oF(d,p))continue;let g={delay:n,...a};t.shouldReduceMotion&&pl.has(p)&&(g={...g,type:!1,delay:0});let y=fg(p,f,h,g);wc(u)&&(u.add(p),y=y.then(()=>u.remove(p))),c.push(y)}return Promise.all(c).then(()=>{i&&ZP(t,i)})}function rF(t,e,n=0,r=0,s=1,o){const a=[],i=(t.variantChildren.size-1)*r,l=s===1?(u=0)=>u*r:(u=0)=>i-u*r;return Array.from(t.variantChildren).sort(sF).forEach((u,c)=>{a.push(sh(u,e,{...o,delay:n+l(c)}).then(()=>u.notifyAnimationComplete(e)))}),Promise.all(a)}function sF(t,e){return t.sortNodePosition(e)}function oF({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}const gg=[we.Animate,we.InView,we.Focus,we.Hover,we.Tap,we.Drag,we.Exit],aF=[...gg].reverse(),iF=gg.length;function lF(t){return e=>Promise.all(e.map(({animation:n,options:r})=>nF(t,n,r)))}function uF(t){let e=lF(t);const n=dF();let r=!0;const s=(l,u)=>{const c=vd(t,u);if(c){const{transition:d,transitionEnd:p,...f}=c;l={...l,...f,...p}}return l};function o(l){e=l(t)}function a(l,u){var c;const d=t.getProps(),p=t.getVariantContext(!0)||{},f=[],h=new Set;let g={},y=1/0;for(let x=0;x<iF;x++){const v=aF[x],b=n[v],C=(c=d[v])!==null&&c!==void 0?c:p[v],k=Bi(C),I=v===u?b.isActive:null;I===!1&&(y=x);let R=C===p[v]&&C!==d[v]&&k;if(R&&r&&t.manuallyAnimateOnMount&&(R=!1),b.protectedKeys={...g},!b.isActive&&I===null||!C&&!b.prevProp||cd(C)||typeof C=="boolean")continue;const D=cF(b.prevProp,C);let O=D||v===u&&b.isActive&&!R&&k||x>y&&k;const V=Array.isArray(C)?C:[C];let j=V.reduce(s,{});I===!1&&(j={});const{prevResolvedValues:Z={}}=b,J={...Z,...j},re=ne=>{O=!0,h.delete(ne),b.needsAnimating[ne]=!0};for(const ne in J){const ce=j[ne],L=Z[ne];g.hasOwnProperty(ne)||(ce!==L?zi(ce)&&zi(L)?!S$(ce,L)||D?re(ne):b.protectedKeys[ne]=!0:ce!==void 0?re(ne):h.add(ne):ce!==void 0&&h.has(ne)?re(ne):b.protectedKeys[ne]=!0)}b.prevProp=C,b.prevResolvedValues=j,b.isActive&&(g={...g,...j}),r&&t.blockInitialAnimation&&(O=!1),O&&!R&&f.push(...V.map(ne=>({animation:ne,options:{type:v,...l}})))}if(h.size){const x={};h.forEach(v=>{const b=t.getBaseTarget(v);b!==void 0&&(x[v]=b)}),f.push({animation:x})}let m=Boolean(f.length);return r&&d.initial===!1&&!t.manuallyAnimateOnMount&&(m=!1),r=!1,m?e(f):Promise.resolve()}function i(l,u,c){var d;if(n[l].isActive===u)return Promise.resolve();(d=t.variantChildren)===null||d===void 0||d.forEach(f=>{var h;return(h=f.animationState)===null||h===void 0?void 0:h.setActive(l,u)}),n[l].isActive=u;const p=a(c,l);for(const f in n)n[f].protectedKeys={};return p}return{animateChanges:a,setActive:i,setAnimateFunction:o,getState:()=>n}}function cF(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!S$(e,t):!1}function ys(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function dF(){return{[we.Animate]:ys(!0),[we.InView]:ys(),[we.Hover]:ys(),[we.Tap]:ys(),[we.Drag]:ys(),[we.Focus]:ys(),[we.Exit]:ys()}}const pF={animation:Mr(({visualElement:t,animate:e})=>{t.animationState||(t.animationState=uF(t)),cd(e)&&A.exports.useEffect(()=>e.subscribe(t),[e])}),exit:Mr(t=>{const{custom:e,visualElement:n}=t,[r,s]=b$(),o=A.exports.useContext(dl);A.exports.useEffect(()=>{n.isPresent=r;const a=n.animationState&&n.animationState.setActive(we.Exit,!r,{custom:o&&o.custom||e});a&&!r&&a.then(s)},[r])})};class N${constructor(e,n,{transformPagePoint:r}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const u=Op(this.lastMoveEventInfo,this.history),c=this.startEvent!==null,d=ug(u.offset,{x:0,y:0})>=3;if(!c&&!d)return;const{point:p}=u,{timestamp:f}=yc();this.history.push({...p,timestamp:f});const{onStart:h,onMove:g}=this.handlers;c||(h&&h(this.lastMoveEvent,u),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,u)},this.handlePointerMove=(u,c)=>{if(this.lastMoveEvent=u,this.lastMoveEventInfo=Ap(c,this.transformPagePoint),j2(u)&&u.buttons===0){this.handlePointerUp(u,c);return}fn.update(this.updatePoint,!0)},this.handlePointerUp=(u,c)=>{this.end();const{onEnd:d,onSessionEnd:p}=this.handlers,f=Op(Ap(c,this.transformPagePoint),this.history);this.startEvent&&d&&d(u,f),p&&p(u,f)},H2(e)&&e.touches.length>1)return;this.handlers=n,this.transformPagePoint=r;const s=tg(e),o=Ap(s,this.transformPagePoint),{point:a}=o,{timestamp:i}=yc();this.history=[{...a,timestamp:i}];const{onSessionStart:l}=n;l&&l(e,Op(o,this.history)),this.removeListeners=gd(Ho(window,"pointermove",this.handlePointerMove),Ho(window,"pointerup",this.handlePointerUp),Ho(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ns.update(this.updatePoint)}}function Ap(t,e){return e?{point:e(t.point)}:t}function cw(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Op({point:t},e){return{point:t,delta:cw(t,E$(e)),offset:cw(t,fF(e)),velocity:hF(e,.1)}}function fF(t){return t[0]}function E$(t){return t[t.length-1]}function hF(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=E$(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>vc(e)));)n--;if(!r)return{x:0,y:0};const o=(s.timestamp-r.timestamp)/1e3;if(o===0)return{x:0,y:0};const a={x:(s.x-r.x)/o,y:(s.y-r.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function jt(t){return t.max-t.min}function dw(t,e=0,n=.01){return ug(t,e)<n}function pw(t,e,n,r=.5){t.origin=r,t.originPoint=Le(e.min,e.max,t.origin),t.scale=jt(n)/jt(e),(dw(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=Le(n.min,n.max,t.origin)-t.originPoint,(dw(t.translate)||isNaN(t.translate))&&(t.translate=0)}function yi(t,e,n,r){pw(t.x,e.x,n.x,r==null?void 0:r.originX),pw(t.y,e.y,n.y,r==null?void 0:r.originY)}function fw(t,e,n){t.min=n.min+e.min,t.max=t.min+jt(e)}function mF(t,e,n){fw(t.x,e.x,n.x),fw(t.y,e.y,n.y)}function hw(t,e,n){t.min=e.min-n.min,t.max=t.min+jt(e)}function xi(t,e,n){hw(t.x,e.x,n.x),hw(t.y,e.y,n.y)}function gF(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Le(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Le(n,t,r.max):Math.min(t,n)),t}function mw(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function yF(t,{top:e,left:n,bottom:r,right:s}){return{x:mw(t.x,n,s),y:mw(t.y,e,r)}}function gw(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function xF(t,e){return{x:gw(t.x,e.x),y:gw(t.y,e.y)}}function vF(t,e){let n=.5;const r=jt(t),s=jt(e);return s>r?n=Ui(e.min,e.max-r,t.min):r>s&&(n=Ui(t.min,t.max-s,e.min)),mc(0,1,n)}function wF(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const oh=.35;function bF(t=oh){return t===!1?t=0:t===!0&&(t=oh),{x:yw(t,"left","right"),y:yw(t,"top","bottom")}}function yw(t,e,n){return{min:xw(t,e),max:xw(t,n)}}function xw(t,e){var n;return typeof t=="number"?t:(n=t[e])!==null&&n!==void 0?n:0}const vw=()=>({translate:0,scale:1,origin:0,originPoint:0}),vi=()=>({x:vw(),y:vw()}),ww=()=>({min:0,max:0}),et=()=>({x:ww(),y:ww()});function Vn(t){return[t("x"),t("y")]}function I$({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function SF({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function CF(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Dp(t){return t===void 0||t===1}function ah({scale:t,scaleX:e,scaleY:n}){return!Dp(t)||!Dp(e)||!Dp(n)}function Ss(t){return ah(t)||R$(t)||t.z||t.rotate||t.rotateX||t.rotateY}function R$(t){return bw(t.x)||bw(t.y)}function bw(t){return t&&t!=="0%"}function bc(t,e,n){const r=t-n,s=e*r;return n+s}function Sw(t,e,n,r,s){return s!==void 0&&(t=bc(t,s,r)),bc(t,n,r)+e}function ih(t,e=0,n=1,r,s){t.min=Sw(t.min,e,n,r,s),t.max=Sw(t.max,e,n,r,s)}function _$(t,{x:e,y:n}){ih(t.x,e.translate,e.scale,e.originPoint),ih(t.y,n.translate,n.scale,n.originPoint)}function $F(t,e,n,r=!1){var s,o;const a=n.length;if(!a)return;e.x=e.y=1;let i,l;for(let u=0;u<a;u++)i=n[u],l=i.projectionDelta,((o=(s=i.instance)===null||s===void 0?void 0:s.style)===null||o===void 0?void 0:o.display)!=="contents"&&(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Bo(t,{x:-i.scroll.x,y:-i.scroll.y}),l&&(e.x*=l.x.scale,e.y*=l.y.scale,_$(t,l)),r&&Ss(i.latestValues)&&Bo(t,i.latestValues))}function Ar(t,e){t.min=t.min+e,t.max=t.max+e}function Cw(t,e,[n,r,s]){const o=e[s]!==void 0?e[s]:.5,a=Le(t.min,t.max,o);ih(t,e[n],e[r],a,e.scale)}const TF=["x","scaleX","originX"],kF=["y","scaleY","originY"];function Bo(t,e){Cw(t.x,e,TF),Cw(t.y,e,kF)}function A$(t,e){return I$(CF(t.getBoundingClientRect(),e))}function NF(t,e,n){const r=A$(t,n),{scroll:s}=e;return s&&(Ar(r.x,s.x),Ar(r.y,s.y)),r}const EF=new WeakMap;class IF{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=et(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){if(this.visualElement.isPresent===!1)return;const r=i=>{this.stopAnimation(),n&&this.snapToCursor(tg(i,"page").point)},s=(i,l)=>{var u;const{drag:c,dragPropagation:d,onDragStart:p}=this.getProps();c&&!d&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=Y2(c),!this.openGlobalLock)||(this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vn(f=>{var h,g;let y=this.getAxisMotionValue(f).get()||0;if(jn.test(y)){const m=(g=(h=this.visualElement.projection)===null||h===void 0?void 0:h.layout)===null||g===void 0?void 0:g.actual[f];m&&(y=jt(m)*(parseFloat(y)/100))}this.originPoint[f]=y}),p==null||p(i,l),(u=this.visualElement.animationState)===null||u===void 0||u.setActive(we.Drag,!0))},o=(i,l)=>{const{dragPropagation:u,dragDirectionLock:c,onDirectionLock:d,onDrag:p}=this.getProps();if(!u&&!this.openGlobalLock)return;const{offset:f}=l;if(c&&this.currentDirection===null){this.currentDirection=RF(f),this.currentDirection!==null&&(d==null||d(this.currentDirection));return}this.updateAxis("x",l.point,f),this.updateAxis("y",l.point,f),this.visualElement.syncRender(),p==null||p(i,l)},a=(i,l)=>this.stop(i,l);this.panSession=new N$(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o==null||o(e,n)}cancel(){var e,n;this.isDragging=!1,this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!1),(e=this.panSession)===null||e===void 0||e.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),(n=this.visualElement.animationState)===null||n===void 0||n.setActive(we.Drag,!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!iu(e,s,this.currentDirection))return;const o=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=gF(a,this.constraints[e],this.elastic[e])),o.set(a)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),{layout:r}=this.visualElement.projection||{},s=this.constraints;e&&Lo(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=yF(r.actual,e):this.constraints=!1,this.elastic=bF(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Vn(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=wF(r.actual[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Lo(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=NF(r,s.root,this.visualElement.getTransformPagePoint());let a=xF(s.layout.actual,o);if(n){const i=n(SF(a));this.hasMutatedConstraints=!!i,i&&(a=I$(i))}return a}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:i}=this.getProps(),l=this.constraints||{},u=Vn(c=>{var d;if(!iu(c,n,this.currentDirection))return;let p=(d=l==null?void 0:l[c])!==null&&d!==void 0?d:{};a&&(p={min:0,max:0});const f=s?200:1e6,h=s?40:1e7,g={type:"inertia",velocity:r?e[c]:0,bounceStiffness:f,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...o,...p};return this.startAxisValueAnimation(c,g)});return Promise.all(u).then(i)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return fg(e,r,0,n)}stopAnimation(){Vn(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){var n,r;const s="_drag"+e.toUpperCase(),o=this.visualElement.getProps()[s];return o||this.visualElement.getValue(e,(r=(n=this.visualElement.getProps().initial)===null||n===void 0?void 0:n[e])!==null&&r!==void 0?r:0)}snapToCursor(e){Vn(n=>{const{drag:r}=this.getProps();if(!iu(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:i}=s.layout.actual[n];o.set(e[n]-Le(a,i,.5))}})}scalePositionWithinConstraints(){var e;const{drag:n,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!Lo(r)||!s||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Vn(i=>{const l=this.getAxisMotionValue(i);if(l){const u=l.get();o[i]=vF({min:u,max:u},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.getInstance().style.transform=a?a({},""):"none",(e=s.root)===null||e===void 0||e.updateScroll(),s.updateLayout(),this.resolveConstraints(),Vn(i=>{if(!iu(i,n,null))return;const l=this.getAxisMotionValue(i),{min:u,max:c}=this.constraints[i];l.set(Le(u,c,o[i]))})}addListeners(){var e;EF.set(this.visualElement,this);const n=this.visualElement.getInstance(),r=Ho(n,"pointerdown",u=>{const{drag:c,dragListener:d=!0}=this.getProps();c&&d&&this.start(u)}),s=()=>{const{dragConstraints:u}=this.getProps();Lo(u)&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,a=o.addEventListener("measure",s);o&&!o.layout&&((e=o.root)===null||e===void 0||e.updateScroll(),o.updateLayout()),s();const i=md(window,"resize",()=>this.scalePositionWithinConstraints()),l=o.addEventListener("didUpdate",({delta:u,hasLayoutChanged:c})=>{this.isDragging&&c&&(Vn(d=>{const p=this.getAxisMotionValue(d);!p||(this.originPoint[d]+=u[d].translate,p.set(p.get()+u[d].translate))}),this.visualElement.syncRender())});return()=>{i(),r(),a(),l==null||l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:a=oh,dragMomentum:i=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:o,dragElastic:a,dragMomentum:i}}}function iu(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function RF(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}function _F(t){const{dragControls:e,visualElement:n}=t,r=pd(()=>new IF(n));A.exports.useEffect(()=>e&&e.subscribe(r),[r,e]),A.exports.useEffect(()=>r.addListeners(),[r])}function AF({onPan:t,onPanStart:e,onPanEnd:n,onPanSessionStart:r,visualElement:s}){const o=t||e||n||r,a=A.exports.useRef(null),{transformPagePoint:i}=A.exports.useContext(Hm),l={onSessionStart:r,onStart:e,onMove:t,onEnd:(c,d)=>{a.current=null,n&&n(c,d)}};A.exports.useEffect(()=>{a.current!==null&&a.current.updateHandlers(l)});function u(c){a.current=new N$(c,l,{transformPagePoint:i})}fc(s,"pointerdown",o&&u),ng(()=>a.current&&a.current.end())}const OF={pan:Mr(AF),drag:Mr(_F)},lh={current:null},O$={current:!1};function DF(){if(O$.current=!0,!!oo)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>lh.current=t.matches;t.addListener(e),e()}else lh.current=!1}const lu=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","LayoutAnimationStart","SetAxisTarget","Unmount"];function PF(){const t=lu.map(()=>new gi),e={},n={clearAllListeners:()=>t.forEach(r=>r.clear()),updatePropListeners:r=>{lu.forEach(s=>{var o;const a="on"+s,i=r[a];(o=e[s])===null||o===void 0||o.call(e),i&&(e[s]=n[a](i))})}};return t.forEach((r,s)=>{n["on"+lu[s]]=o=>r.add(o),n["notify"+lu[s]]=(...o)=>r.notify(...o)}),n}function FF(t,e,n){const{willChange:r}=e;for(const s in e){const o=e[s],a=n[s];if(Rn(o))t.addValue(s,o),wc(r)&&r.add(s);else if(Rn(a))t.addValue(s,aa(o)),wc(r)&&r.remove(s);else if(a!==o)if(t.hasValue(s)){const i=t.getValue(s);!i.hasAnimated&&i.set(o)}else{const i=t.getStaticValue(s);t.addValue(s,aa(i!==void 0?i:o))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const D$=Object.keys(Vi),LF=D$.length,P$=({treeType:t="",build:e,getBaseTarget:n,makeTargetAnimatable:r,measureViewportBox:s,render:o,readValueFromInstance:a,removeValueFromRenderState:i,sortNodePosition:l,scrapeMotionValuesFromProps:u})=>({parent:c,props:d,presenceId:p,blockInitialAnimation:f,visualState:h,reducedMotionConfig:g},y={})=>{let m=!1;const{latestValues:x,renderState:v}=h;let b;const C=PF(),k=new Map,I=new Map;let R={};const D={...x},O=d.initial?{...x}:{};let V;function j(){!b||!m||(Z(),o(b,v,d.style,z.projection))}function Z(){e(z,v,x,y,d)}function J(){C.notifyUpdate(x)}function re(F,H){const de=H.onChange(Me=>{x[F]=Me,d.onUpdate&&fn.update(J,!1,!0)}),Ve=H.onRenderRequest(z.scheduleRender);I.set(F,()=>{de(),Ve()})}const{willChange:ne,...ce}=u(d);for(const F in ce){const H=ce[F];x[F]!==void 0&&Rn(H)&&(H.set(x[F],!1),wc(ne)&&ne.add(F))}if(d.values)for(const F in d.values){const H=d.values[F];x[F]!==void 0&&Rn(H)&&H.set(x[F])}const L=dd(d),Y=S2(d),z={treeType:t,current:null,depth:c?c.depth+1:0,parent:c,children:new Set,presenceId:p,shouldReduceMotion:null,variantChildren:Y?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(c==null?void 0:c.isMounted()),blockInitialAnimation:f,isMounted:()=>Boolean(b),mount(F){m=!0,b=z.current=F,z.projection&&z.projection.mount(F),Y&&c&&!L&&(V=c==null?void 0:c.addVariantChild(z)),k.forEach((H,de)=>re(de,H)),O$.current||DF(),z.shouldReduceMotion=g==="never"?!1:g==="always"?!0:lh.current,c==null||c.children.add(z),z.setProps(d)},unmount(){var F;(F=z.projection)===null||F===void 0||F.unmount(),ns.update(J),ns.render(j),I.forEach(H=>H()),V==null||V(),c==null||c.children.delete(z),C.clearAllListeners(),b=void 0,m=!1},loadFeatures(F,H,de,Ve,Me,Qt){const ms=[];for(let Da=0;Da<LF;Da++){const go=D$[Da],{isEnabled:Jd,Component:Pa}=Vi[go];Jd(F)&&Pa&&ms.push(A.exports.createElement(Pa,{key:go,...F,visualElement:z}))}if(!z.projection&&Me){z.projection=new Me(Ve,z.getLatestValues(),c&&c.projection);const{layoutId:Da,layout:go,drag:Jd,dragConstraints:Pa,layoutScroll:FR}=F;z.projection.setOptions({layoutId:Da,layout:go,alwaysMeasureLayout:Boolean(Jd)||Pa&&Lo(Pa),visualElement:z,scheduleRender:()=>z.scheduleRender(),animationType:typeof go=="string"?go:"both",initialPromotionConfig:Qt,layoutScroll:FR})}return ms},addVariantChild(F){var H;const de=z.getClosestVariantNode();if(de)return(H=de.variantChildren)===null||H===void 0||H.add(F),()=>de.variantChildren.delete(F)},sortNodePosition(F){return!l||t!==F.treeType?0:l(z.getInstance(),F.getInstance())},getClosestVariantNode:()=>Y?z:c==null?void 0:c.getClosestVariantNode(),getLayoutId:()=>d.layoutId,getInstance:()=>b,getStaticValue:F=>x[F],setStaticValue:(F,H)=>x[F]=H,getLatestValues:()=>x,setVisibility(F){z.isVisible!==F&&(z.isVisible=F,z.scheduleRender())},makeTargetAnimatable(F,H=!0){return r(z,F,d,H)},measureViewportBox(){return s(b,d)},addValue(F,H){z.hasValue(F)&&z.removeValue(F),k.set(F,H),x[F]=H.get(),re(F,H)},removeValue(F){var H;k.delete(F),(H=I.get(F))===null||H===void 0||H(),I.delete(F),delete x[F],i(F,v)},hasValue:F=>k.has(F),getValue(F,H){if(d.values&&d.values[F])return d.values[F];let de=k.get(F);return de===void 0&&H!==void 0&&(de=aa(H),z.addValue(F,de)),de},forEachValue:F=>k.forEach(F),readValue:F=>x[F]!==void 0?x[F]:a(b,F,y),setBaseTarget(F,H){D[F]=H},getBaseTarget(F){var H;const{initial:de}=d,Ve=typeof de=="string"||typeof de=="object"?(H=eg(d,de))===null||H===void 0?void 0:H[F]:void 0;if(de&&Ve!==void 0)return Ve;if(n){const Me=n(d,F);if(Me!==void 0&&!Rn(Me))return Me}return O[F]!==void 0&&Ve===void 0?void 0:D[F]},...C,build(){return Z(),v},scheduleRender(){fn.render(j,!1,!0)},syncRender:j,setProps(F){(F.transformTemplate||d.transformTemplate)&&z.scheduleRender(),d=F,C.updatePropListeners(F),R=FF(z,u(d),R)},getProps:()=>d,getVariant:F=>{var H;return(H=d.variants)===null||H===void 0?void 0:H[F]},getDefaultTransition:()=>d.transition,getTransformPagePoint:()=>d.transformPagePoint,getVariantContext(F=!1){if(F)return c==null?void 0:c.getVariantContext();if(!L){const de=(c==null?void 0:c.getVariantContext())||{};return d.initial!==void 0&&(de.initial=d.initial),de}const H={};for(let de=0;de<BF;de++){const Ve=F$[de],Me=d[Ve];(Bi(Me)||Me===!1)&&(H[Ve]=Me)}return H}};return z},F$=["initial",...gg],BF=F$.length;function uh(t){return typeof t=="string"&&t.startsWith("var(--")}const L$=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function VF(t){const e=L$.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function ch(t,e,n=1){const[r,s]=VF(t);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);return o?o.trim():uh(s)?ch(s,e,n+1):s}function MF(t,{...e},n){const r=t.getInstance();if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.forEachValue(s=>{const o=s.get();if(!uh(o))return;const a=ch(o,r);a&&s.set(a)});for(const s in e){const o=e[s];if(!uh(o))continue;const a=ch(o,r);!a||(e[s]=a,n&&n[s]===void 0&&(n[s]=o))}return{target:e,transitionEnd:n}}const zF=new Set(["width","height","top","left","right","bottom","x","y"]),B$=t=>zF.has(t),UF=t=>Object.keys(t).some(B$),V$=(t,e)=>{t.set(e,!1),t.set(e)},$w=t=>t===ao||t===te;var Tw;(function(t){t.width="width",t.height="height",t.left="left",t.right="right",t.top="top",t.bottom="bottom"})(Tw||(Tw={}));const kw=(t,e)=>parseFloat(t.split(", ")[e]),Nw=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return kw(s[1],e);{const o=r.match(/^matrix\((.+)\)$/);return o?kw(o[1],t):0}},WF=new Set(["x","y","z"]),GF=dc.filter(t=>!WF.has(t));function jF(t){const e=[];return GF.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.syncRender(),e}const Ew={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Nw(4,13),y:Nw(5,14)},HF=(t,e,n)=>{const r=e.measureViewportBox(),s=e.getInstance(),o=getComputedStyle(s),{display:a}=o,i={};a==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{i[u]=Ew[u](r,o)}),e.syncRender();const l=e.measureViewportBox();return n.forEach(u=>{const c=e.getValue(u);V$(c,i[u]),t[u]=Ew[u](l,o)}),t},KF=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(B$);let o=[],a=!1;const i=[];if(s.forEach(l=>{const u=t.getValue(l);if(!t.hasValue(l))return;let c=n[l],d=Ga(c);const p=e[l];let f;if(zi(p)){const h=p.length,g=p[0]===null?1:0;c=p[g],d=Ga(c);for(let y=g;y<h;y++)f?hc(Ga(p[y])===f):f=Ga(p[y])}else f=Ga(p);if(d!==f)if($w(d)&&$w(f)){const h=u.get();typeof h=="string"&&u.set(parseFloat(h)),typeof p=="string"?e[l]=parseFloat(p):Array.isArray(p)&&f===te&&(e[l]=p.map(parseFloat))}else(d==null?void 0:d.transform)&&(f==null?void 0:f.transform)&&(c===0||p===0)?c===0?u.set(f.transform(c)):e[l]=d.transform(p):(a||(o=jF(t),a=!0),i.push(l),r[l]=r[l]!==void 0?r[l]:e[l],V$(u,p))}),i.length){const l=i.indexOf("height")>=0?window.pageYOffset:null,u=HF(e,t,i);return o.length&&o.forEach(([c,d])=>{t.getValue(c).set(d)}),t.syncRender(),oo&&l!==null&&window.scrollTo({top:l}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function qF(t,e,n,r){return UF(e)?KF(t,e,n,r):{target:e,transitionEnd:r}}const XF=(t,e,n,r)=>{const s=MF(t,e,r);return e=s.target,r=s.transitionEnd,qF(t,e,n,r)};function YF(t){return window.getComputedStyle(t)}const M$={treeType:"dom",readValueFromInstance(t,e){if(pl.has(e)){const n=cg(e);return n&&n.default||0}else{const n=YF(t),r=(k2(e)?n.getPropertyValue(e):n[e])||0;return typeof r=="string"?r.trim():r}},sortNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1},getBaseTarget(t,e){var n;return(n=t.style)===null||n===void 0?void 0:n[e]},measureViewportBox(t,{transformPagePoint:e}){return A$(t,e)},resetTransform(t,e,n){const{transformTemplate:r}=n;e.style.transform=r?r({},""):"none",t.scheduleRender()},restoreTransform(t,e){t.style.transform=e.style.transform},removeValueFromRenderState(t,{vars:e,style:n}){delete e[t],delete n[t]},makeTargetAnimatable(t,{transition:e,transitionEnd:n,...r},{transformValues:s},o=!0){let a=tF(r,e||{},t);if(s&&(n&&(n=s(n)),r&&(r=s(r)),a&&(a=s(a))),o){JP(t,r,a);const i=XF(t,r,a,n);n=i.transitionEnd,r=i.target}return{transition:e,transitionEnd:n,...r}},scrapeMotionValuesFromProps:Jm,build(t,e,n,r,s){t.isVisible!==void 0&&(e.style.visibility=t.isVisible?"visible":"hidden"),Ym(e,n,r,s.transformTemplate)},render:V2},QF=P$(M$),ZF=P$({...M$,getBaseTarget(t,e){return t[e]},readValueFromInstance(t,e){var n;return pl.has(e)?((n=cg(e))===null||n===void 0?void 0:n.default)||0:(e=M2.has(e)?e:B2(e),t.getAttribute(e))},scrapeMotionValuesFromProps:U2,build(t,e,n,r,s){Zm(e,n,r,s.transformTemplate)},render:z2}),JF=(t,e)=>qm(t)?ZF(e,{enableHardwareAcceleration:!1}):QF(e,{enableHardwareAcceleration:!0});function Iw(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const ja={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(te.test(t))t=parseFloat(t);else return t;const n=Iw(t,e.target.x),r=Iw(t,e.target.y);return`${n}% ${r}%`}},Rw="_$css",e3={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=t.includes("var("),o=[];s&&(t=t.replace(L$,f=>(o.push(f),Rw)));const a=yr.parse(t);if(a.length>5)return r;const i=yr.createTransformer(t),l=typeof a[0]!="number"?1:0,u=n.x.scale*e.x,c=n.y.scale*e.y;a[0+l]/=u,a[1+l]/=c;const d=Le(u,c,.5);typeof a[2+l]=="number"&&(a[2+l]/=d),typeof a[3+l]=="number"&&(a[3+l]/=d);let p=i(a);if(s){let f=0;p=p.replace(Rw,()=>{const h=o[f];return f++,h})}return p}};class t3 extends al.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:o}=e;CO(r3),o&&(n.group&&n.group.add(o),r&&r.register&&s&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),fi.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:o}=this.props,a=r.projection;return a&&(a.isPresent=o,s||e.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?a.promote():a.relegate()||fn.postRender(()=>{var i;!((i=a.getStack())===null||i===void 0)&&i.members.length||this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),!e.currentAnimation&&e.isLead()&&this.safeToRemove())}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n!=null&&n.group&&n.group.remove(s),r!=null&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e==null||e()}render(){return null}}function n3(t){const[e,n]=b$(),r=A.exports.useContext(Km);return T(t3,{...t,layoutGroup:r,switchLayoutGroup:A.exports.useContext(C2),isPresent:e,safeToRemove:n})}const r3={borderRadius:{...ja,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ja,borderTopRightRadius:ja,borderBottomLeftRadius:ja,borderBottomRightRadius:ja,boxShadow:e3},s3={measureLayout:n3};function o3(t,e,n={}){const r=Rn(t)?t:aa(t);return fg("",r,e,n),{stop:()=>r.stop(),isAnimating:()=>r.isAnimating()}}const z$=["TopLeft","TopRight","BottomLeft","BottomRight"],a3=z$.length,_w=t=>typeof t=="string"?parseFloat(t):t,Aw=t=>typeof t=="number"||te.test(t);function i3(t,e,n,r,s,o){var a,i,l,u;s?(t.opacity=Le(0,(a=n.opacity)!==null&&a!==void 0?a:1,l3(r)),t.opacityExit=Le((i=e.opacity)!==null&&i!==void 0?i:1,0,u3(r))):o&&(t.opacity=Le((l=e.opacity)!==null&&l!==void 0?l:1,(u=n.opacity)!==null&&u!==void 0?u:1,r));for(let c=0;c<a3;c++){const d=`border${z$[c]}Radius`;let p=Ow(e,d),f=Ow(n,d);if(p===void 0&&f===void 0)continue;p||(p=0),f||(f=0),p===0||f===0||Aw(p)===Aw(f)?(t[d]=Math.max(Le(_w(p),_w(f),r),0),(jn.test(f)||jn.test(p))&&(t[d]+="%")):t[d]=f}(e.rotate||n.rotate)&&(t.rotate=Le(e.rotate||0,n.rotate||0,r))}function Ow(t,e){var n;return(n=t[e])!==null&&n!==void 0?n:t.borderRadius}const l3=U$(0,.5,ig),u3=U$(.5,.95,og);function U$(t,e,n){return r=>r<t?0:r>e?1:n(Ui(t,e,r))}function Dw(t,e){t.min=e.min,t.max=e.max}function Sn(t,e){Dw(t.x,e.x),Dw(t.y,e.y)}function Pw(t,e,n,r,s){return t-=e,t=bc(t,1/n,r),s!==void 0&&(t=bc(t,1/s,r)),t}function c3(t,e=0,n=1,r=.5,s,o=t,a=t){if(jn.test(e)&&(e=parseFloat(e),e=Le(a.min,a.max,e/100)-a.min),typeof e!="number")return;let i=Le(o.min,o.max,r);t===o&&(i-=e),t.min=Pw(t.min,e,n,i,s),t.max=Pw(t.max,e,n,i,s)}function Fw(t,e,[n,r,s],o,a){c3(t,e[n],e[r],e[s],e.scale,o,a)}const d3=["x","scaleX","originX"],p3=["y","scaleY","originY"];function Lw(t,e,n,r){Fw(t.x,e,d3,n==null?void 0:n.x,r==null?void 0:r.x),Fw(t.y,e,p3,n==null?void 0:n.y,r==null?void 0:r.y)}function Bw(t){return t.translate===0&&t.scale===1}function W$(t){return Bw(t.x)&&Bw(t.y)}function G$(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function Vw(t){return jt(t.x)/jt(t.y)}function f3(t,e,n=.1){return ug(t,e)<=n}class h3{constructor(){this.members=[]}add(e){hg(this.members,e),e.scheduleRender()}remove(e){if(mg(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,n){var r;const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues,e.snapshot.isShared=!0),!((r=e.root)===null||r===void 0)&&r.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:o}=e.options;o===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{var n,r,s,o,a;(r=(n=e.options).onExitComplete)===null||r===void 0||r.call(n),(a=(s=e.resumingFrom)===null||s===void 0?void 0:(o=s.options).onExitComplete)===null||a===void 0||a.call(o)})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const m3="translate3d(0px, 0px, 0) scale(1, 1) scale(1, 1)";function Mw(t,e,n){const r=t.x.translate/e.x,s=t.y.translate/e.y;let o=`translate3d(${r}px, ${s}px, 0) `;if(o+=`scale(${1/e.x}, ${1/e.y}) `,n){const{rotate:l,rotateX:u,rotateY:c}=n;l&&(o+=`rotate(${l}deg) `),u&&(o+=`rotateX(${u}deg) `),c&&(o+=`rotateY(${c}deg) `)}const a=t.x.scale*e.x,i=t.y.scale*e.y;return o+=`scale(${a}, ${i})`,o===m3?"none":o}const g3=(t,e)=>t.depth-e.depth;class y3{constructor(){this.children=[],this.isDirty=!1}add(e){hg(this.children,e),this.isDirty=!0}remove(e){mg(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(g3),this.isDirty=!1,this.children.forEach(e)}}const zw=["","X","Y","Z"],Uw=1e3;function j$({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a,i={},l=e==null?void 0:e()){this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.potentialNodes=new Map,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.nodes.forEach(S3),this.nodes.forEach(C3)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.id=a,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0,a&&this.root.registerPotentialNode(a,this);for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new y3)}addEventListener(a,i){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new gi),this.eventHandlers.get(a).add(i)}notifyListeners(a,...i){const l=this.eventHandlers.get(a);l==null||l.notify(...i)}hasListeners(a){return this.eventHandlers.has(a)}registerPotentialNode(a,i){this.potentialNodes.set(a,i)}mount(a,i=!1){var l;if(this.instance)return;this.isSVG=a instanceof SVGElement&&a.tagName!=="svg",this.instance=a;const{layoutId:u,layout:c,visualElement:d}=this.options;if(d&&!d.getInstance()&&d.mount(a),this.root.nodes.add(this),(l=this.parent)===null||l===void 0||l.children.add(this),this.id&&this.root.potentialNodes.delete(this.id),i&&(c||u)&&(this.isLayoutDirty=!0),t){let p;const f=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=C$(f,250),fi.hasAnimatedSinceResize&&(fi.hasAnimatedSinceResize=!1,this.nodes.forEach(Gw))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&d&&(u||c)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:f,hasRelativeTargetChanged:h,layout:g})=>{var y,m,x,v,b;if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=(m=(y=this.options.transition)!==null&&y!==void 0?y:d.getDefaultTransition())!==null&&m!==void 0?m:E3,{onLayoutAnimationStart:k,onLayoutAnimationComplete:I}=d.getProps(),R=!this.targetLayout||!G$(this.targetLayout,g)||h,D=!f&&h;if(((x=this.resumeFrom)===null||x===void 0?void 0:x.instance)||D||f&&(R||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,D);const O={...pg(C,"layout"),onPlay:k,onComplete:I};d.shouldReduceMotion&&(O.delay=0,O.type=!1),this.startAnimation(O)}else!f&&this.animationProgress===0&&Gw(this),this.isLead()&&((b=(v=this.options).onExitComplete)===null||b===void 0||b.call(v));this.targetLayout=g})}unmount(){var a,i;this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this),(a=this.getStack())===null||a===void 0||a.remove(this),(i=this.parent)===null||i===void 0||i.children.delete(this),this.instance=void 0,ns.preRender(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){var a;return this.isAnimationBlocked||((a=this.parent)===null||a===void 0?void 0:a.isTreeAnimationBlocked())||!1}startUpdate(){var a;this.isUpdateBlocked()||(this.isUpdating=!0,(a=this.nodes)===null||a===void 0||a.forEach($3))}willUpdate(a=!0){var i,l,u;if(this.root.isUpdateBlocked()){(l=(i=this.options).onExitComplete)===null||l===void 0||l.call(i);return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const h=this.path[f];h.shouldResetTransform=!0,h.updateScroll()}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const p=(u=this.options.visualElement)===null||u===void 0?void 0:u.getProps().transformTemplate;this.prevTransformTemplateValue=p==null?void 0:p(this.latestValues,""),this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}didUpdate(){if(this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ww);return}!this.isUpdating||(this.isUpdating=!1,this.potentialNodes.size&&(this.potentialNodes.forEach(I3),this.potentialNodes.clear()),this.nodes.forEach(b3),this.nodes.forEach(x3),this.nodes.forEach(v3),this.clearAllSnapshots(),Ip.update(),Ip.preRender(),Ip.render())}clearAllSnapshots(){this.nodes.forEach(w3),this.sharedNodes.forEach(T3)}scheduleUpdateProjection(){fn.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){fn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){if(this.snapshot||!this.instance)return;const a=this.measure(),i=this.removeTransform(this.removeElementScroll(a));qw(i),this.snapshot={measured:a,layout:i,latestValues:{}}}updateLayout(){var a;if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const i=this.measure();qw(i);const l=this.layout;this.layout={measured:i,actual:this.removeElementScroll(i)},this.layoutCorrected=et(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.actual),(a=this.options.visualElement)===null||a===void 0||a.notifyLayoutMeasure(this.layout.actual,l==null?void 0:l.actual)}updateScroll(){this.options.layoutScroll&&this.instance&&(this.isScrollRoot=r(this.instance),this.scroll=n(this.instance))}resetTransform(){var a;if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!W$(this.projectionDelta),u=(a=this.options.visualElement)===null||a===void 0?void 0:a.getProps().transformTemplate,c=u==null?void 0:u(this.latestValues,""),d=c!==this.prevTransformTemplateValue;i&&(l||Ss(this.latestValues)||d)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(){const{visualElement:a}=this.options;if(!a)return et();const i=a.measureViewportBox(),{scroll:l}=this.root;return l&&(Ar(i.x,l.x),Ar(i.y,l.y)),i}removeElementScroll(a){const i=et();Sn(i,a);for(let l=0;l<this.path.length;l++){const u=this.path[l],{scroll:c,options:d,isScrollRoot:p}=u;if(u!==this.root&&c&&d.layoutScroll){if(p){Sn(i,a);const{scroll:f}=this.root;f&&(Ar(i.x,-f.x),Ar(i.y,-f.y))}Ar(i.x,c.x),Ar(i.y,c.y)}}return i}applyTransform(a,i=!1){const l=et();Sn(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];!i&&c.options.layoutScroll&&c.scroll&&c!==c.root&&Bo(l,{x:-c.scroll.x,y:-c.scroll.y}),Ss(c.latestValues)&&Bo(l,c.latestValues)}return Ss(this.latestValues)&&Bo(l,this.latestValues),l}removeTransform(a){var i;const l=et();Sn(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];if(!c.instance||!Ss(c.latestValues))continue;ah(c.latestValues)&&c.updateSnapshot();const d=et(),p=c.measure();Sn(d,p),Lw(l,c.latestValues,(i=c.snapshot)===null||i===void 0?void 0:i.layout,d)}return Ss(this.latestValues)&&Lw(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection()}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}resolveTargetDelta(){var a;const{layout:i,layoutId:l}=this.options;!this.layout||!(i||l)||(!this.targetDelta&&!this.relativeTarget&&(this.relativeParent=this.getClosestProjectingParent(),this.relativeParent&&this.relativeParent.layout&&(this.relativeTarget=et(),this.relativeTargetOrigin=et(),xi(this.relativeTargetOrigin,this.layout.actual,this.relativeParent.layout.actual),Sn(this.relativeTarget,this.relativeTargetOrigin))),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=et(),this.targetWithTransforms=et()),this.relativeTarget&&this.relativeTargetOrigin&&((a=this.relativeParent)===null||a===void 0?void 0:a.target)?mF(this.target,this.relativeTarget,this.relativeParent.target):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.actual):Sn(this.target,this.layout.actual),_$(this.target,this.targetDelta)):Sn(this.target,this.layout.actual),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,this.relativeParent=this.getClosestProjectingParent(),this.relativeParent&&Boolean(this.relativeParent.resumingFrom)===Boolean(this.resumingFrom)&&!this.relativeParent.options.layoutScroll&&this.relativeParent.target&&(this.relativeTarget=et(),this.relativeTargetOrigin=et(),xi(this.relativeTargetOrigin,this.target,this.relativeParent.target),Sn(this.relativeTarget,this.relativeTargetOrigin)))))}getClosestProjectingParent(){if(!(!this.parent||ah(this.parent.latestValues)||R$(this.parent.latestValues)))return(this.parent.relativeTarget||this.parent.targetDelta)&&this.parent.layout?this.parent:this.parent.getClosestProjectingParent()}calcProjection(){var a;const{layout:i,layoutId:l}=this.options;if(this.isTreeAnimating=Boolean(((a=this.parent)===null||a===void 0?void 0:a.isTreeAnimating)||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(i||l))return;const u=this.getLead();Sn(this.layoutCorrected,this.layout.actual),$F(this.layoutCorrected,this.treeScale,this.path,Boolean(this.resumingFrom)||this!==u);const{target:c}=u;if(!c)return;this.projectionDelta||(this.projectionDelta=vi(),this.projectionDeltaWithTransform=vi());const d=this.treeScale.x,p=this.treeScale.y,f=this.projectionTransform;yi(this.projectionDelta,this.layoutCorrected,c,this.latestValues),this.projectionTransform=Mw(this.projectionDelta,this.treeScale),(this.projectionTransform!==f||this.treeScale.x!==d||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",c))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var i,l,u;(l=(i=this.options).scheduleRender)===null||l===void 0||l.call(i),a&&((u=this.getStack())===null||u===void 0||u.scheduleRender()),this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,i=!1){var l;const u=this.snapshot,c=(u==null?void 0:u.latestValues)||{},d={...this.latestValues},p=vi();this.relativeTarget=this.relativeTargetOrigin=void 0,this.attemptToResolveRelativeTarget=!i;const f=et(),h=u==null?void 0:u.isShared,g=(((l=this.getStack())===null||l===void 0?void 0:l.members.length)||0)<=1,y=Boolean(h&&!g&&this.options.crossfade===!0&&!this.path.some(N3));this.animationProgress=0,this.mixTargetDelta=m=>{var x;const v=m/1e3;jw(p.x,a.x,v),jw(p.y,a.y,v),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&((x=this.relativeParent)===null||x===void 0?void 0:x.layout)&&(xi(f,this.layout.actual,this.relativeParent.layout.actual),k3(this.relativeTarget,this.relativeTargetOrigin,f,v)),h&&(this.animationValues=d,i3(d,c,this.latestValues,v,y,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=v},this.mixTargetDelta(0)}startAnimation(a){var i,l;this.notifyListeners("animationStart"),(i=this.currentAnimation)===null||i===void 0||i.stop(),this.resumingFrom&&((l=this.resumingFrom.currentAnimation)===null||l===void 0||l.stop()),this.pendingAnimation&&(ns.update(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=fn.update(()=>{fi.hasAnimatedSinceResize=!0,this.currentAnimation=o3(0,Uw,{...a,onUpdate:u=>{var c;this.mixTargetDelta(u),(c=a.onUpdate)===null||c===void 0||c.call(a,u)},onComplete:()=>{var u;(u=a.onComplete)===null||u===void 0||u.call(a),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){var a;this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0),(a=this.getStack())===null||a===void 0||a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){var a;this.currentAnimation&&((a=this.mixTargetDelta)===null||a===void 0||a.call(this,Uw),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:i,target:l,layout:u,latestValues:c}=a;if(!(!i||!l||!u)){if(this!==a&&this.layout&&u&&H$(this.options.animationType,this.layout.actual,u.actual)){l=this.target||et();const d=jt(this.layout.actual.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const p=jt(this.layout.actual.y);l.y.min=a.target.y.min,l.y.max=l.y.min+p}Sn(i,l),Bo(i,c),yi(this.projectionDeltaWithTransform,this.layoutCorrected,i,c)}}registerSharedNode(a,i){var l,u,c;this.sharedNodes.has(a)||this.sharedNodes.set(a,new h3),this.sharedNodes.get(a).add(i),i.promote({transition:(l=i.options.initialPromotionConfig)===null||l===void 0?void 0:l.transition,preserveFollowOpacity:(c=(u=i.options.initialPromotionConfig)===null||u===void 0?void 0:u.shouldPreserveFollowOpacity)===null||c===void 0?void 0:c.call(u,i)})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:i}=this.options;return i?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:i}=this.options;return i?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:i,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let i=!1;const l={};for(let u=0;u<zw.length;u++){const d="rotate"+zw[u];!a.getStaticValue(d)||(i=!0,l[d]=a.getStaticValue(d),a.setStaticValue(d,0))}if(!!i){a==null||a.syncRender();for(const u in l)a.setStaticValue(u,l[u]);a.scheduleRender()}}getProjectionStyles(a={}){var i,l,u;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const d=(i=this.options.visualElement)===null||i===void 0?void 0:i.getProps().transformTemplate;if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Au(a.pointerEvents)||"",c.transform=d?d(this.latestValues,""):"none",c;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const y={};return this.options.layoutId&&(y.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,y.pointerEvents=Au(a.pointerEvents)||""),this.hasProjected&&!Ss(this.latestValues)&&(y.transform=d?d({},""):"none",this.hasProjected=!1),y}const f=p.animationValues||p.latestValues;this.applyTransformsToTarget(),c.transform=Mw(this.projectionDeltaWithTransform,this.treeScale,f),d&&(c.transform=d(f,c.transform));const{x:h,y:g}=this.projectionDelta;c.transformOrigin=`${h.origin*100}% ${g.origin*100}% 0`,p.animationValues?c.opacity=p===this?(u=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:c.opacity=p===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const y in cc){if(f[y]===void 0)continue;const{correct:m,applyTo:x}=cc[y],v=m(f[y],p);if(x){const b=x.length;for(let C=0;C<b;C++)c[x[C]]=v}else c[y]=v}return this.options.layoutId&&(c.pointerEvents=p===this?Au(a.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var i;return(i=a.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(Ww),this.root.sharedNodes.clear()}}}function x3(t){t.updateLayout()}function v3(t){var e,n,r;const s=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{actual:o,measured:a}=t.layout,{animationType:i}=t.options;i==="size"?Vn(p=>{const f=s.isShared?s.measured[p]:s.layout[p],h=jt(f);f.min=o[p].min,f.max=f.min+h}):H$(i,s.layout,o)&&Vn(p=>{const f=s.isShared?s.measured[p]:s.layout[p],h=jt(o[p]);f.max=f.min+h});const l=vi();yi(l,o,s.layout);const u=vi();s.isShared?yi(u,t.applyTransform(a,!0),s.measured):yi(u,o,s.layout);const c=!W$(l);let d=!1;if(!t.resumeFrom&&(t.relativeParent=t.getClosestProjectingParent(),t.relativeParent&&!t.relativeParent.resumeFrom)){const{snapshot:p,layout:f}=t.relativeParent;if(p&&f){const h=et();xi(h,s.layout,p.layout);const g=et();xi(g,o,f.actual),G$(h,g)||(d=!0)}}t.notifyListeners("didUpdate",{layout:o,snapshot:s,delta:u,layoutDelta:l,hasLayoutChanged:c,hasRelativeTargetChanged:d})}else t.isLead()&&((r=(n=t.options).onExitComplete)===null||r===void 0||r.call(n));t.options.transition=void 0}function w3(t){t.clearSnapshot()}function Ww(t){t.clearMeasurements()}function b3(t){const{visualElement:e}=t.options;e!=null&&e.getProps().onBeforeLayoutMeasure&&e.notifyBeforeLayoutMeasure(),t.resetTransform()}function Gw(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0}function S3(t){t.resolveTargetDelta()}function C3(t){t.calcProjection()}function $3(t){t.resetRotation()}function T3(t){t.removeLeadSnapshot()}function jw(t,e,n){t.translate=Le(e.translate,0,n),t.scale=Le(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Hw(t,e,n,r){t.min=Le(e.min,n.min,r),t.max=Le(e.max,n.max,r)}function k3(t,e,n,r){Hw(t.x,e.x,n.x,r),Hw(t.y,e.y,n.y,r)}function N3(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const E3={duration:.45,ease:[.4,0,.1,1]};function I3(t,e){let n=t.root;for(let o=t.path.length-1;o>=0;o--)if(Boolean(t.path[o].instance)){n=t.path[o];break}const s=(n&&n!==t.root?n.instance:document).querySelector(`[data-projection-id="${e}"]`);s&&t.mount(s,!0)}function Kw(t){t.min=Math.round(t.min),t.max=Math.round(t.max)}function qw(t){Kw(t.x),Kw(t.y)}function H$(t,e,n){return t==="position"||t==="preserve-aspect"&&!f3(Vw(e),Vw(n),.2)}const R3=j$({attachResizeListener:(t,e)=>md(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Pp={current:void 0},_3=j$({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Pp.current){const t=new R3(0,{});t.mount(window),t.setOptions({layoutScroll:!0}),Pp.current=t}return Pp.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>Boolean(window.getComputedStyle(t).position==="fixed")}),A3={...pF,...IP,...OF,...s3},Ha=bO((t,e)=>aD(t,e,A3,JF,_3));function K$(){const t=A.exports.useRef(!1);return uc(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function O3(){const t=K$(),[e,n]=A.exports.useState(0),r=A.exports.useCallback(()=>{t.current&&n(e+1)},[e]);return[A.exports.useCallback(()=>fn.postRender(r),[r]),e]}class D3 extends A.exports.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function P3({children:t,isPresent:e}){const n=A.exports.useId(),r=A.exports.useRef(null),s=A.exports.useRef({width:0,height:0,top:0,left:0});return A.exports.useInsertionEffect(()=>{const{width:o,height:a,top:i,left:l}=s.current;if(e||!r.current||!o||!a)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${i}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),T(D3,{isPresent:e,childRef:r,sizeRef:s,children:A.exports.cloneElement(t,{ref:r})})}const Fp=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:o,mode:a})=>{const i=pd(F3),l=A.exports.useId(),u=A.exports.useMemo(()=>({id:l,initial:e,isPresent:n,custom:s,onExitComplete:c=>{i.set(c,!0);for(const d of i.values())if(!d)return;r&&r()},register:c=>(i.set(c,!1),()=>i.delete(c))}),o?void 0:[n]);return A.exports.useMemo(()=>{i.forEach((c,d)=>i.set(d,!1))},[n]),A.exports.useEffect(()=>{!n&&!i.size&&r&&r()},[n]),a==="popLayout"&&(t=T(P3,{isPresent:n,children:t})),T(dl.Provider,{value:u,children:t})};function F3(){return new Map}const bo=t=>t.key||"";function L3(t,e){t.forEach(n=>{const r=bo(n);e.set(r,n)})}function B3(t){const e=[];return A.exports.Children.forEach(t,n=>{A.exports.isValidElement(n)&&e.push(n)}),e}const q$=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:o=!0,mode:a="sync"})=>{s&&(a="wait",w$(!1,"Replace exitBeforeEnter with mode='wait'"));let[i]=O3();const l=A.exports.useContext(Km).forceRender;l&&(i=l);const u=K$(),c=B3(t);let d=c;const p=new Set,f=A.exports.useRef(d),h=A.exports.useRef(new Map).current,g=A.exports.useRef(!0);if(uc(()=>{g.current=!1,L3(c,h),f.current=d}),ng(()=>{g.current=!0,h.clear(),p.clear()}),g.current)return T(Hs,{children:d.map(v=>T(Fp,{isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:o,mode:a,children:v},bo(v)))});d=[...d];const y=f.current.map(bo),m=c.map(bo),x=y.length;for(let v=0;v<x;v++){const b=y[v];m.indexOf(b)===-1&&p.add(b)}return a==="wait"&&p.size&&(d=[]),p.forEach(v=>{if(m.indexOf(v)!==-1)return;const b=h.get(v);if(!b)return;const C=y.indexOf(v),k=()=>{h.delete(v),p.delete(v);const I=f.current.findIndex(R=>R.key===v);if(f.current.splice(I,1),!p.size){if(f.current=c,u.current===!1)return;i(),r&&r()}};d.splice(C,0,T(Fp,{isPresent:!1,onExitComplete:k,custom:e,presenceAffectsLayout:o,mode:a,children:b},bo(b)))}),d=d.map(v=>{const b=v.key;return p.has(b)?v:T(Fp,{isPresent:!0,presenceAffectsLayout:o,mode:a,children:v},bo(v))}),v$!=="production"&&a==="wait"&&d.length>1&&console.warn(`You're attempting to animate multiple children within AnimatePresence, but its mode is set to "wait". This will lead to odd visual behaviour.`),T(Hs,{children:p.size?d:d.map(v=>A.exports.cloneElement(v))})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3=1e-7,M3=1e-4;class X${constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class yg{refCount(e){return kt("refCount")}incRef(e){return kt("incRef")}timerAvailable(){return!0}time(e){return kt("time")}read(e){return kt("read")}readSync(e){return kt("readSync")}readToGPU(e,n){return kt("readToGPU")}numDataIds(){return kt("numDataIds")}disposeData(e,n){return kt("disposeData")}write(e,n,r){return kt("write")}move(e,n,r,s,o){return kt("move")}createTensorFromTexture(e,n,r){return kt("createTensorFromTexture")}memory(){return kt("memory")}floatPrecision(){return kt("floatPrecision")}epsilon(){return this.floatPrecision()===32?V3:M3}dispose(){return kt("dispose")}}function kt(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,sr(t,e,n)}function z3(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,sr(t,n,r),sr(e,n,r)}function Gi(t,e,n){return Math.max(t,Math.min(e,n))}function wd(t){return t%2===0?t:t+1}function sr(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Q$(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function U3(t,e){const n=Math.random();return e*n+(1-n)*t}function W3(t,e){let n=0;for(let r=0;r<t.length;r++){const s=Number(t[r])-Number(e[r]);n+=s*s}return n}function $(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function at(t,e,n=""){$(Ne(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function io(t){$(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function xr(t,e=[],n=!1){if(e==null&&(e=[]),Array.isArray(t)||nt(t)&&!n)for(let r=0;r<t.length;++r)xr(t[r],e,n);else e.push(t);return e}function M(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function G3(t){return t.length===0}function Ne(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Ks(t){return t%1===0}function j3(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function Sc(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function H3(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return Y$(e),e}function Fs(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function dh(t,e=s=>0,n,r){return new Promise((s,o)=>{let a=0;const i=()=>{if(t()){s();return}a++;const l=e(a);if(n!=null&&a>=n){o();return}r!=null?r(i,l):setTimeout(i,l)};i()})}function Z$(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Ue(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),$(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),$(t.every(r=>Ks(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Cr(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:Ue(e,t).sort();let a=0;for(let i=0;i<t.length;++i){if(o!=null){if(o[a]===i&&t[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${t[i]}' is not 1`);(o[a]==null||o[a]>i)&&t[i]===1&&(n.push(t[i]),r.push(i)),o[a]<=i&&a++}t[i]!==1&&(n.push(t[i]),r.push(i))}return{newShape:n,keptDims:r}}function Kn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Xe(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function J$(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function eT(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function tT(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function nt(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function Cc(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function nT(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function lr(t){return typeof t=="string"||t instanceof String}function rT(t){return typeof t=="boolean"}function sT(t){return typeof t=="number"}function gl(t){return Array.isArray(t)?gl(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":sT(t)?"float32":lr(t)?"string":rT(t)?"bool":"float32"}function rs(t){return!!(t&&t.constructor&&t.call&&t.apply)}function $c(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function He(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function oT(t,e,n,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let a=0;a<o;a++)s[a]=n[t+a]}else{const o=e[0],a=e.slice(1),i=a.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<o;l++)s[l]=oT(t+l*i,a,n,r)}return s}function Ls(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,o)=>s*o)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return oT(0,t,e,n)}function xg(t,e){const n=vr(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function vr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function K3(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return Ls(t,new Float32Array(n));if(e==="int32")return Ls(t,new Int32Array(n));if(e==="bool")return Ls(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function vg(t){t.forEach(e=>{$(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Tc(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function bd(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function qs(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xw="tfjsflags";class aT{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=q3,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(_().getBool("IS_TEST")||_().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];_().getBool("IS_TEST")||_().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(qs(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);Xw in e&&e[Xw].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=Y3(s,o)})}}function q3(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(X3(e,r[0],r[1]),r.join("="))),e}function X3(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Y3(t,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function _(){return wg}let wg=null;function Q3(t){wg=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Lp;function iT(){if(Lp==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Lp=t}return Lp}function Z3(){const t=iT();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function bg(t,e){const n=Z3();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Sg="Abs",Cg="Acos",$g="Acosh",Sd="Add",Tg="AddN",kg="All",Ng="Any",Eg="ArgMax",Ig="ArgMin",Rg="Asin",_g="Asinh",Ag="Atan",Og="Atanh",Dg="Atan2",Pg="AvgPool",lT="AvgPoolGrad",Fg="AvgPool3D",uT="AvgPool3DGrad",Lg="BatchMatMul",Bg="BatchToSpaceND",Vg="Bincount",J3="BroadcastTo",Mg="BroadcastArgs",Cd="Cast",zg="Ceil",Ug="ClipByValue",Wg="Complex",Gg="ComplexAbs",jg="Concat",Hg="Conv2D",Kg="Conv2DBackpropFilter",qg="Conv2DBackpropInput",Xg="Conv3D",cT="Conv3DBackpropFilterV2",Yg="Conv3DBackpropInputV2",Qg="Cos",Zg="Cosh",Jg="Cumprod",ey="Cumsum",ty="CropAndResize",ny="DenseBincount",ry="DepthToSpace",sy="DepthwiseConv2dNative",oy="DepthwiseConv2dNativeBackpropFilter",ay="DepthwiseConv2dNativeBackpropInput",iy="Diag",ly="Dilation2D",eL="Dilation2DBackpropInput",tL="Dilation2DBackpropFilter",uy="RealDiv",cy="Einsum",dy="Elu",dT="EluGrad",py="Erf",fy="Equal",hy="Exp",my="ExpandDims",gy="Expm1",yy="FFT",xy="Fill",vy="FlipLeftRight",wy="Floor",by="FloorDiv",Sy="FusedBatchNorm",Cy="GatherV2",$y="GatherNd",Ty="Greater",ky="GreaterEqual",$d="Identity",Ny="IFFT",Ey="Imag",Iy="IsFinite",Ry="IsInf",_y="IsNan",Ay="LeakyRelu",Oy="Less",Dy="LessEqual",Py="LinSpace",Fy="Log",Ly="Log1p",By="LogicalAnd",Vy="LogicalNot",My="LogicalOr",nL="LogicalXor",rL="LogSoftmax",sL="LowerBound",zy="LRN",pT="LRNGrad",Uy="Max",Wy="Maximum",Gy="MaxPool",fT="MaxPoolGrad",jy="MaxPool3D",hT="MaxPool3DGrad",Hy="MaxPoolWithArgmax",Ky="Mean",qy="Min",Xy="Minimum",Yy="MirrorPad",Qy="Mod",Zy="Multinomial",Jy="Multiply",e0="Neg",t0="NotEqual",n0="NonMaxSuppressionV3",r0="NonMaxSuppressionV4",s0="NonMaxSuppressionV5",o0="OnesLike",a0="OneHot",i0="Pack",l0="PadV2",oL="Pool",u0="Pow",c0="Prelu",d0="Prod",p0="RaggedGather",f0="RaggedRange",h0="RaggedTensorToTensor",m0="Range",g0="Real",y0="Reciprocal",x0="Relu",v0="Reshape",w0="ResizeNearestNeighbor",mT="ResizeNearestNeighborGrad",b0="ResizeBilinear",gT="ResizeBilinearGrad",S0="Relu6",C0="Reverse",$0="Round",T0="Rsqrt",k0="ScatterNd",N0="SearchSorted",E0="Select",I0="Selu",R0="Slice",_0="Sin",A0="Sinh",O0="Sign",D0="Sigmoid",P0="Softplus",F0="Sqrt",L0="Sum",B0="SpaceToBatchND",V0="SplitV",M0="Softmax",z0="SparseFillEmptyRows",U0="SparseReshape",W0="SparseSegmentMean",G0="SparseSegmentSum",j0="SparseToDense",H0="SquaredDifference",yT="Square",K0="StridedSlice",q0="StringNGrams",X0="StringSplit",Y0="StringToHashBucketFast",Q0="Sub",Z0="Tan",J0="Tanh",Td="Tile",ex="TopK",tx="Transform",wi="Transpose",nx="Unique",rx="Unpack",sx="UnsortedSegmentSum",aL="UpperBound",ox="ZerosLike",ax="Step",kc="FromPixels",ix="RotateWithOffset",Nc="_FusedMatMul",Ec="FusedConv2D",Ic="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(...t){_().getBool("IS_TEST")||_().getBool("PROD")||console.warn(...t)}function iL(...t){_().getBool("IS_TEST")||_().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ia=bg("kernelRegistry",()=>new Map),ji=bg("gradRegistry",()=>new Map);function Rc(t,e){const n=ux(t,e);return ia.get(n)}function ph(t){return ji.get(t)}function _c(t){const e=ia.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,a]=s,[i]=o.split("_");i===t&&n.push(a)}return n}function lx(t){const{kernelName:e,backendName:n}=t,r=ux(e,n);ia.has(r)&&sn(`The kernel '${e}' for backend '${n}' is already registered`),ia.set(r,t)}function lL(t){const{kernelName:e}=t;ji.has(e)&&_().getBool("DEBUG")&&sn(`Overriding the gradient for '${e}'`),ji.set(e,t)}function uL(t,e){const n=ux(t,e);if(!ia.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);ia.delete(n)}function cL(t){if(!ji.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);ji.delete(t)}function dL(t,e){_c(t).forEach(r=>{const s=Object.assign({},r,{backendName:e});lx(s)})}function ux(t,e){return`${e}_${t}`}var fh=Se,an=null;try{an=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Se(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Se.prototype.__isLong__;Object.defineProperty(Se.prototype,"__isLong__",{value:!0});function Bt(t){return(t&&t.__isLong__)===!0}Se.isLong=Bt;var Yw={},Qw={};function lo(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=Qw[t],r)?r:(n=Ce(t,(t|0)<0?-1:0,!0),s&&(Qw[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=Yw[t],r)?r:(n=Ce(t,t<0?-1:0,!1),s&&(Yw[t]=n),n))}Se.fromInt=lo;function ln(t,e){if(isNaN(t))return e?_s:un;if(e){if(t<0)return _s;if(t>=xT)return bT}else{if(t<=-Jw)return _t;if(t+1>=Jw)return wT}return t<0?ln(-t,e).neg():Ce(t%la|0,t/la|0,e)}Se.fromNumber=ln;function Ce(t,e,n){return new Se(t,e,n)}Se.fromBits=Ce;var Ac=Math.pow;function cx(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return un;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return cx(t.substring(1),e,n).neg();for(var s=ln(Ac(n,8)),o=un,a=0;a<t.length;a+=8){var i=Math.min(8,t.length-a),l=parseInt(t.substring(a,a+i),n);if(i<8){var u=ln(Ac(n,i));o=o.mul(u).add(ln(l))}else o=o.mul(s),o=o.add(ln(l))}return o.unsigned=e,o}Se.fromString=cx;function Pn(t,e){return typeof t=="number"?ln(t,e):typeof t=="string"?cx(t,e):Ce(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Se.fromValue=Pn;var Zw=1<<16,pL=1<<24,la=Zw*Zw,xT=la*la,Jw=xT/2,eb=lo(pL),un=lo(0);Se.ZERO=un;var _s=lo(0,!0);Se.UZERO=_s;var Vo=lo(1);Se.ONE=Vo;var vT=lo(1,!0);Se.UONE=vT;var hh=lo(-1);Se.NEG_ONE=hh;var wT=Ce(-1,2147483647,!1);Se.MAX_VALUE=wT;var bT=Ce(-1,-1,!0);Se.MAX_UNSIGNED_VALUE=bT;var _t=Ce(0,-2147483648,!1);Se.MIN_VALUE=_t;var U=Se.prototype;U.toInt=function(){return this.unsigned?this.low>>>0:this.low};U.toNumber=function(){return this.unsigned?(this.high>>>0)*la+(this.low>>>0):this.high*la+(this.low>>>0)};U.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(_t)){var n=ln(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=ln(Ac(e,6),this.unsigned),a=this,i="";;){var l=a.div(o),u=a.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(a=l,a.isZero())return c+i;for(;c.length<6;)c="0"+c;i=""+c+i}};U.getHighBits=function(){return this.high};U.getHighBitsUnsigned=function(){return this.high>>>0};U.getLowBits=function(){return this.low};U.getLowBitsUnsigned=function(){return this.low>>>0};U.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_t)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&(e&1<<n)==0;n--);return this.high!=0?n+33:n+1};U.isZero=function(){return this.high===0&&this.low===0};U.eqz=U.isZero;U.isNegative=function(){return!this.unsigned&&this.high<0};U.isPositive=function(){return this.unsigned||this.high>=0};U.isOdd=function(){return(this.low&1)===1};U.isEven=function(){return(this.low&1)===0};U.equals=function(e){return Bt(e)||(e=Pn(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};U.eq=U.equals;U.notEquals=function(e){return!this.eq(e)};U.neq=U.notEquals;U.ne=U.notEquals;U.lessThan=function(e){return this.comp(e)<0};U.lt=U.lessThan;U.lessThanOrEqual=function(e){return this.comp(e)<=0};U.lte=U.lessThanOrEqual;U.le=U.lessThanOrEqual;U.greaterThan=function(e){return this.comp(e)>0};U.gt=U.greaterThan;U.greaterThanOrEqual=function(e){return this.comp(e)>=0};U.gte=U.greaterThanOrEqual;U.ge=U.greaterThanOrEqual;U.compare=function(e){if(Bt(e)||(e=Pn(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};U.comp=U.compare;U.negate=function(){return!this.unsigned&&this.eq(_t)?_t:this.not().add(Vo)};U.neg=U.negate;U.add=function(e){Bt(e)||(e=Pn(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,i=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,p=0,f=0;return f+=o+u,p+=f>>>16,f&=65535,p+=s+l,d+=p>>>16,p&=65535,d+=r+i,c+=d>>>16,d&=65535,c+=n+a,c&=65535,Ce(p<<16|f,c<<16|d,this.unsigned)};U.subtract=function(e){return Bt(e)||(e=Pn(e)),this.add(e.neg())};U.sub=U.subtract;U.multiply=function(e){if(this.isZero())return un;if(Bt(e)||(e=Pn(e)),an){var n=an.mul(this.low,this.high,e.low,e.high);return Ce(n,an.get_high(),this.unsigned)}if(e.isZero())return un;if(this.eq(_t))return e.isOdd()?_t:un;if(e.eq(_t))return this.isOdd()?_t:un;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(eb)&&e.lt(eb))return ln(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,a=this.low&65535,i=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,p=0,f=0,h=0;return h+=a*c,f+=h>>>16,h&=65535,f+=o*c,p+=f>>>16,f&=65535,f+=a*u,p+=f>>>16,f&=65535,p+=s*c,d+=p>>>16,p&=65535,p+=o*u,d+=p>>>16,p&=65535,p+=a*l,d+=p>>>16,p&=65535,d+=r*c+s*u+o*l+a*i,d&=65535,Ce(f<<16|h,d<<16|p,this.unsigned)};U.mul=U.multiply;U.divide=function(e){if(Bt(e)||(e=Pn(e)),e.isZero())throw Error("division by zero");if(an){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?an.div_u:an.div_s)(this.low,this.high,e.low,e.high);return Ce(n,an.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?_s:un;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return _s;if(e.gt(this.shru(1)))return vT;o=_s}else{if(this.eq(_t)){if(e.eq(Vo)||e.eq(hh))return _t;if(e.eq(_t))return Vo;var a=this.shr(1);return r=a.div(e).shl(1),r.eq(un)?e.isNegative()?Vo:hh:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(_t))return this.unsigned?_s:un;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=un}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(r)/Math.LN2),l=i<=48?1:Ac(2,i-48),u=ln(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=ln(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=Vo),o=o.add(u),s=s.sub(c)}return o};U.div=U.divide;U.modulo=function(e){if(Bt(e)||(e=Pn(e)),an){var n=(this.unsigned?an.rem_u:an.rem_s)(this.low,this.high,e.low,e.high);return Ce(n,an.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};U.mod=U.modulo;U.rem=U.modulo;U.not=function(){return Ce(~this.low,~this.high,this.unsigned)};U.and=function(e){return Bt(e)||(e=Pn(e)),Ce(this.low&e.low,this.high&e.high,this.unsigned)};U.or=function(e){return Bt(e)||(e=Pn(e)),Ce(this.low|e.low,this.high|e.high,this.unsigned)};U.xor=function(e){return Bt(e)||(e=Pn(e)),Ce(this.low^e.low,this.high^e.high,this.unsigned)};U.shiftLeft=function(e){return Bt(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ce(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Ce(0,this.low<<e-32,this.unsigned)};U.shl=U.shiftLeft;U.shiftRight=function(e){return Bt(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ce(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Ce(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};U.shr=U.shiftRight;U.shiftRightUnsigned=function(e){if(Bt(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return Ce(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Ce(n,0,this.unsigned):Ce(n>>>e-32,0,this.unsigned)};U.shru=U.shiftRightUnsigned;U.shr_u=U.shiftRightUnsigned;U.toSigned=function(){return this.unsigned?Ce(this.low,this.high,!1):this};U.toUnsigned=function(){return this.unsigned?this:Ce(this.low,this.high,!0)};U.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};U.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};U.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Se.fromBytes=function(e,n,r){return r?Se.fromBytesLE(e,n):Se.fromBytesBE(e,n)};Se.fromBytesLE=function(e,n){return new Se(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Se.fromBytesBE=function(e,n){return new Se(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const fL=dS({__proto__:null,default:fh},[fh]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ts=fh||fL;function yl(t){return Ts.fromString(t,!0,16)}const ST=yl("c3a5c85c97cb3127"),Cs=yl("b492b66fbe98f273"),pt=yl("9ae16a3b2f90404f");function mh(t){return t.xor(t.shru(47))}function CT(t,e,n){const r=t.slice(e,e+n);return Ts.fromBytes(Array.from(r),!0,!0)}function ge(t,e){return CT(t,e,8)}function tb(t,e){return CT(t,e,4)}function Ge(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Zr(t,e,n=yl("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function hL(t,e,n,r,s,o){s=s.add(t),o=Ge(o.add(s).add(r),21);const a=s;return s=s.add(e),s=s.add(n),o=o.add(Ge(s,44)),[s.add(r),o.add(a)]}function uu(t,e,n,r){return hL(ge(t,e),ge(t,e+8),ge(t,e+16),ge(t,e+24),n,r)}function mL(t,e=t.length){if(e>=8){const n=pt.add(e*2),r=ge(t,0).add(pt),s=ge(t,e-8),o=Ge(s,37).mul(n).add(r),a=Ge(r,25).add(s).mul(n);return Zr(o,a,n)}if(e>=4){const n=pt.add(e*2),r=tb(t,0);return Zr(r.shl(3).add(e),tb(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],o=n+(r<<8),a=e+(s<<2);return mh(pt.mul(o).xor(ST.mul(a))).mul(pt)}return pt}function gL(t,e=t.length){const n=pt.add(e*2),r=ge(t,0).mul(Cs),s=ge(t,8),o=ge(t,e-8).mul(n),a=ge(t,e-16).mul(pt);return Zr(Ge(r.add(s),43).add(Ge(o,30)).add(a),r.add(Ge(s.add(pt),18)).add(o),n)}function yL(t,e=t.length){const n=pt.add(e*2),r=ge(t,0).mul(pt),s=ge(t,8),o=ge(t,e-8).mul(n),a=ge(t,e-16).mul(pt),i=Ge(r.add(s),43).add(Ge(o,30)).add(a),l=Zr(i,r.add(Ge(s.add(pt),18)).add(o),n),u=ge(t,16).mul(n),c=ge(t,24),d=i.add(ge(t,e-32)).mul(n),p=l.add(ge(t,e-24)).mul(n);return Zr(Ge(u.add(c),43).add(Ge(d,30)).add(p),u.add(Ge(c.add(r),18)).add(d),n)}function $T(t,e=t.length){const n=Ts.fromNumber(81,!0);if(e<=32)return e<=16?mL(t,e):gL(t,e);if(e<=64)return yL(t,e);let r=n,s=n.mul(Cs).add(113),o=mh(s.mul(pt).add(113)).mul(pt),a=[Ts.UZERO,Ts.UZERO],i=[Ts.UZERO,Ts.UZERO];r=r.mul(pt).add(ge(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=Ge(r.add(s).add(a[0]).add(ge(t,l+8)),37).mul(Cs),s=Ge(s.add(a[1]).add(ge(t,l+48)),42).mul(Cs),r=r.xor(i[1]),s=s.add(a[0]).add(ge(t,l+40)),o=Ge(o.add(i[0]),33).mul(Cs),a=uu(t,l,a[1].mul(Cs),r.add(i[0])),i=uu(t,l+32,o.add(i[1]),s.add(ge(t,l+16))),[o,r]=[r,o],l+=64;while(l!==u);const d=Cs.add(o.and(255).shl(1));return l=c,i[0]=i[0].add(e-1&63),a[0]=a[0].add(i[0]),i[0]=i[0].add(a[0]),r=Ge(r.add(s).add(a[0]).add(ge(t,l+8)),37).mul(d),s=Ge(s.add(a[1]).add(ge(t,l+48)),42).mul(d),r=r.xor(i[1].mul(9)),s=s.add(a[0].mul(9).add(ge(t,l+40))),o=Ge(o.add(i[0]),33).mul(d),a=uu(t,l,a[1].mul(d),r.add(i[0])),i=uu(t,l+32,o.add(i[1]),s.add(ge(t,l+16))),[o,r]=[r,o],Zr(Zr(a[0],i[0],d).add(mh(s).mul(ST)).add(o),Zr(a[1],i[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uo(t,e){return e==="string"?dr(t):xl([t],e)}function xL(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function xl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=xr(t)),_().getBool("DEBUG")&&J$(t,e),xL(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function tn(){return _().platform.now()}function vL(t,e){return _().platform.fetch(t,e)}function dr(t,e="utf-8"){return e=e||"utf-8",_().platform.encode(t,e)}function Xs(t,e="utf-8"){return e=e||"utf-8",_().platform.decode(t,e)}const wL=Object.freeze(Object.defineProperty({__proto__:null,createScalarValue:uo,toTypedArray:xl,now:tn,fetch:vL,encodeString:dr,decodeString:Xs,shuffle:Y$,shuffleCombo:z3,clamp:Gi,nearestLargerEven:wd,swap:sr,sum:Q$,randUniform:U3,distSquared:W3,assert:$,assertShapesMatch:at,assertNonNull:io,flatten:xr,sizeFromShape:M,isScalarShape:G3,arraysEqual:Ne,isInt:Ks,tanh:j3,sizeToSquarishShape:Sc,createShuffledIndices:H3,rightPad:Fs,repeatedTry:dh,inferFromImplicitShape:Z$,parseAxisParam:Ue,squeezeShape:Cr,getTypedArrayFromDType:Kn,getArrayFromDType:Xe,checkConversionForErrors:J$,isValidDtype:eT,hasEncodingLoss:tT,isTypedArray:nt,bytesPerElement:Cc,bytesFromStringArray:nT,isString:lr,isBoolean:rT,isNumber:sT,inferDtype:gl,isFunction:rs,nearestDivisor:$c,computeStrides:He,toNestedArray:Ls,makeOnesTypedArray:xg,makeZerosTypedArray:vr,makeZerosNestedTypedArray:K3,assertNonNegativeIntegerDimensions:vg,locToIndex:Tc,indexToLoc:bd,isPromise:qs,hexToLong:yl,fingerPrint64:$T},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bL{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new CL)}profileKernel(e,n,r){let s;const o=()=>{s=r()};let a;const i=tn();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();a=Promise.resolve({kernelMs:tn()-i})}if(_().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{SL(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:o,extraInfo:a}=e;r.forEach(i=>{Promise.all([i.data(),s,a]).then(l=>{this.logger.logKernelProfile(n,i,l[0],l[1],o,l[2])})})}}function SL(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class CL{logKernelProfile(e,n,r,s,o,a){const i=typeof s=="number"?Fs(`${s}ms`,9):s.error,l=Fs(e,25),u=n.rank,c=n.size,d=Fs(n.shape.toString(),14);let p="";for(const f in o){const h=o[f];if(h!=null){const g=h.shape||n.shape,y=g.length;p+=`${f}: ${y}D ${y>0?g:""} `}}console.log(`%c${l}	%c${i}	%c${u}D ${d}	%c${c}	%c${p}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const p=c[d];let f=!1;for(let h=0;h<e.length;h++)if(r[p.id]){u.outputs.forEach(g=>r[g.id]=!0),f=!0,s[u.id]=!0;break}if(f)break}}const o={};o[n.id]=!0;const a={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const p in c)o[c[p].id]=!0,a[u.id]=!0;break}}const i=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&a[u.id]){const c={};for(const p in u.inputs){const f=u.inputs[p];r[f.id]&&(c[p]=f)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,i.push(d)}}return i}function TL(t,e,n,r){for(let s=e.length-1;s>=0;s--){const o=e[s],a=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?a.push(u):a.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const i=o.gradient(a);for(const l in o.inputs){if(!(l in i))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(i)}.`);const u=n(()=>i[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!Ne(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nb=20,Ka=3,Bp=7;function kL(t,e,n,r){const s=He(e),o=NL(t,e,n,s),a=e.length,i=Pu(t,e,n,s,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(i.map(u=>"    "+u).join(`
`)),l.join(`
`)}function NL(t,e,n,r){const s=M(e),o=r[r.length-1],a=new Array(o).fill(0),i=e.length,l=n==="complex64"?ei(t):t;if(i>1)for(let u=0;u<s/o;u++){const c=u*o;for(let d=0;d<o;d++)a[d]=Math.max(a[d],Ja(l[c+d],0,n).length)}return a}function Ja(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(Bp))} + ${parseFloat(t[1].toFixed(Bp))}j`:lr(t)?r=`'${t}'`:n==="bool"?r=TT(t):r=parseFloat(t.toFixed(Bp)).toString(),Fs(r,e)}function TT(t){return t===0?"false":"true"}function Pu(t,e,n,r,s,o=!0){const a=n==="complex64"?2:1,i=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=ei(t);return[Ja(g[0],0,n)]}return n==="bool"?[TT(t[0])]:[t[0].toString()]}if(l===1){if(i>nb){const y=Ka*a;let m=Array.from(t.slice(0,y)),x=Array.from(t.slice((i-Ka)*a,i*a));return n==="complex64"&&(m=ei(m),x=ei(x)),["["+m.map((v,b)=>Ja(v,s[b],n)).join(", ")+", ..., "+x.map((v,b)=>Ja(v,s[i-Ka+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?ei(t):Array.from(t)).map((y,m)=>Ja(y,s[m],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*a,p=[];if(i>nb){for(let g=0;g<Ka;g++){const y=g*d,m=y+d;p.push(...Pu(t.slice(y,m),u,n,c,s,!1))}p.push("...");for(let g=i-Ka;g<i;g++){const y=g*d,m=y+d;p.push(...Pu(t.slice(y,m),u,n,c,s,g===i-1))}}else for(let g=0;g<i;g++){const y=g*d,m=y+d;p.push(...Pu(t.slice(y,m),u,n,c,s,g===i-1))}const f=l===2?",":"";p[0]="["+p[0]+f;for(let g=1;g<p.length-1;g++)p[g]=" "+p[g]+f;let h=`,
`;for(let g=2;g<l;g++)h+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(o?"":h),p}function ei(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ua{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=M(e),r!=null){const s=r.length;$(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Xe(n,this.size),this.strides=He(e)}set(e,...n){n.length===0&&(n=[0]),$(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return kn().makeTensor(this.values,this.shape,this.dtype)}}let kn=null,So=null;function EL(t){kn=t}function IL(t){So=t}class _e{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=M(e),this.strides=He(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return So.buffer(this.shape,this.dtype,e)}bufferSync(){return So.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Ls(this.shape,e,this.dtype==="complex64")}arraySync(){return Ls(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=kn().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Xs(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),kn().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=kn().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Xs(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await kn().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(kn().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return So.print(this,e)}clone(){return this.throwIfDisposed(),So.clone(this)}toString(e=!1){const n=this.dataSync();return kL(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),So.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),kn().makeVariable(this,e,n,r)}}Object.defineProperty(_e,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function RL(){return bg("Tensor",()=>_e)}RL();class Hi extends _e{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ne(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);kn().disposeTensor(this),this.dataId=e.dataId,kn().incRef(this,null)}dispose(){kn().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Hi,Symbol.hasInstance,{value:t=>t instanceof _e&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gh;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(gh||(gh={}));var yh;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(yh||(yh={}));var xh;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(xh||(xh={}));var vh;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(vh||(vh={}));var wh;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(wh||(wh={}));const _L={float32:vh,int32:yh,bool:xh,complex64:wh};function On(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return _L[t][e]}function kd(t){return On(t,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ae(t,e){if(t.dtype===e.dtype)return[t,e];const n=On(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function kT(t,e){$(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function AL(t,e){return e.some(n=>n.id===t.id)}function dx(t){const e=[];return NT(t,e,new Set),e}function NT(t,e,n){if(t==null)return;if(t instanceof _e){e.push(t);return}if(!OL(t))return;const r=t;for(const s in r){const o=r[s];n.has(o)||(n.add(o),NT(o,e,n))}}function OL(t){return Array.isArray(t)||typeof t=="object"}const DL=Object.freeze(Object.defineProperty({__proto__:null,makeTypesMatch:Ae,assertTypesMatch:kT,isTensorInList:AL,getTensorsInContainer:dx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vp(t){return t.kernelName!=null}class rb{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ca{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new rb}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(sn(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new bL(this.backendInstance),!0}setupRegisteredKernels(){_c(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){_c(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof yg)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,sn(`Initialization of backend ${e} failed`),sn(a.stack||a.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return sn(`Initialization of backend ${e} failed`),sn(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,o=this.readSync(n),a=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,o,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return ca.nextTensorId++}nextVariableId(){return ca.nextVariableId++}clone(e){const n=E.runKernel($d,{x:e}),r={x:e},s=a=>({x:()=>{const i="float32",l={x:a},u={dtype:i};return E.runKernel(Cd,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,o,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(Rc(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let o=0;r.forEach(l=>{o+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=s-n-o-a;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let l;const u=Vp(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Vp(e)){const{kernelName:h,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;const m=Rc(h,this.backendName);$(m!=null,()=>`Cannot find registered kernel '${h}' for backend '${this.backendName}'`),i=()=>{const x=this.backend.numDataIds();l=m.kernelFunc({inputs:g,attrs:y,backend:this.backend});const v=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,x,v);const b=v.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(s){const C=this.getTensorsForGradient(h,g,b);r=this.saveTensorsForBackwardMode(C)}return b}}else{const{forwardFunc:h}=e,g=y=>{!s||(r=y.map(m=>this.keep(this.clone(m))))};i=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>h(this.backend,g));const m=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,m),m}}const{inputs:c,attrs:d}=e,p=Vp(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=i():(f=this.profiler.profileKernel(u,c,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),s&&this.addTapeNode(u,c,n,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(h=>c[h]!=null?c[h].shape:null),outputShapes:n.map(h=>h.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=ph(e);if(s!=null){const o=s.inputsToSave||[],a=s.outputsToSave||[];let i;s.saveAllInputs?($(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(n).map(u=>n[u])):i=o.map(u=>n[u]);const l=r.filter((u,c)=>a[c]);return i.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&lr(e[0])&&(o=e.map(l=>dr(l)));const a=s.write(o,n,r),i=new _e(n,r,a,this.nextTensorId());if(this.trackTensor(i,s),r==="string"){const l=this.state.tensorInfo.get(a),u=nT(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return i}makeTensorFromDataId(e,n,r,s){r=r||"float32";const o={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:o}=e,a=new _e(s,o,r,this.nextTensorId());return this.trackTensor(a,n),a}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new Hi(e,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Cc(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Hi||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Cc(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,o,a){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:o},l=ph(e);l!=null&&(s=l.gradFunc),s!=null&&(i.gradient=u=>(u=u.map((c,d)=>{if(c==null){const p=r[d],f=vr(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return c}),s(u.length>1?u:u[0],o,a))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=dx(e),r=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const a=this.state.activeScope.track[o];!a.kept&&!r.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,n,r,s=!1){if($(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));$(o instanceof _e,()=>"The result y returned by f() must be a tensor.");const a=$L(this.state.activeTape,n,o);if(!s&&a.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[o.id]=r==null?PL(o.shape):r,TL(i,a,u=>this.tidy(u),FL);const l=n.map(u=>i[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return $(rs(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{$(n.every(i=>i instanceof _e),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((i,l)=>{s[l]=i});const o=(i,l)=>(r=e(...n,l),$(r.value instanceof _e,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),$(rs(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(i,l)=>{const u=r.gradFunc(i,l),c=Array.isArray(u)?u:[u];$(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),$(c.every(p=>p instanceof _e),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((p,f)=>{d[f]=()=>p}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=tn(),r=await this.backend.time(e);return r.wallMs=tn()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new rb;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ca.nextTensorId=0;ca.nextVariableId=0;function PL(t){const e=xg(M(t),"float32");return E.makeTensor(e,t,"float32")}function ET(){const t=iT();if(t._tfengine==null){const e=new aT(t);t._tfengine=new ca(e)}return Q3(t._tfengine.ENV),EL(()=>t._tfengine),t._tfengine}const E=ET();function FL(t,e){const n={a:t,b:e};return E.runKernel(Sd,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(){return typeof navigator<"u"&&navigator!=null}let bh;function BL(t){bh=t}function px(t){if(bh!==void 0)return bh;if(t||LL()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function fx(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const VL=Object.freeze(Object.defineProperty({__proto__:null,mockIsMobile:BL,isMobile:px,isBrowser:fx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ft=_();Ft.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Ft.registerFlag("IS_BROWSER",()=>fx());Ft.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Ft.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Ft.registerFlag("PROD",()=>!1);Ft.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ft.getBool("DEBUG"));Ft.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Ft.registerFlag("IS_TEST",()=>!1);Ft.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Ft.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Ft.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Ft.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Ft.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(t,e){let n=t;if(nt(t))return e==="string"?[]:[t.length];if(typeof t=="object"&&"texture"in t){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||nt(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&_().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&IT(t,r,[]),r}function IT(t,e,n){if(n=n||[],!Array.isArray(t)&&!nt(t)){$(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}$(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),$(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)IT(t[s],r,n.concat(s))}function sb(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function S(t,e,n,r="numeric"){if(t instanceof _e)return sb(r,t.dtype,e,n),t;let s=gl(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),sb(r,s,e,n),t==null||!nt(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=qn(t,s);!nt(t)&&!Array.isArray(t)&&(t=[t]);const i=s!=="string"?xl(t,s):xr(t,[],!0);return E.makeTensor(i,o,s)}function Ki(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,a)=>S(o,`${e}[${a}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hx="__op";function N(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+hx;const s=(...o)=>{E.startScope(n);try{const a=r(...o);return qs(a)&&console.error("Cannot return a Promise inside of tidy."),E.endScope(a),a}catch(a){throw E.endScope(null),a}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(t,e){const n=S(t,"real","complex"),r=S(e,"imag","complex");at(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return E.runKernel(Wg,s)}const wr=N({complex_:ML});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function us(t,e,n,r){if(r==null&&(r=gl(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(typeof t=="object"&&"texture"in t){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from texture only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return t.channels=t.channels||"RGBA",E.backend.createTensorFromTexture(t,e||n,r)}if(!nt(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){vg(e);const s=M(e),o=M(n);$(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let a=0;a<n.length;++a){const i=n[a],l=a===n.length-1?i!==M(e.slice(a)):!0;$(n[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!nt(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?xl(t,r):xr(t,[],!0),E.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(t,e,n){const r=qn(t,n);return us(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sh={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oc=4;async function zL(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(a=>a.name):Object.keys(t);for(let a=0;a<s.length;++a){const i=s[a],l=Array.isArray(t)?t[a].tensor:t[i];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${l.dtype}`);const u={name:i,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const p=await l.bytes(),f=p.reduce((y,m)=>y+m.length,0)+Oc*p.length,h=new Uint8Array(f);let g=0;for(let y=0;y<p.length;y++){const m=p[y],x=new Uint8Array(new Uint32Array([m.length]).buffer);h.set(x,g),g+=Oc,h.set(m,g),g+=m.length}d(h)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(r);return{data:UL(o),specs:n}}function RT(t,e){const n={};let r,s=0;for(const o of e){const a=o.name,i=o.dtype,l=o.shape,u=M(l);let c;if("quantization"in o){const d=o.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${o.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(i!=="float32")throw new Error(`Weight ${o.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${i}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=Sh[d.dtype],f=t.slice(s,s+u*p),h=d.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(i==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){c=new Float32Array(h.length);for(let g=0;g<h.length;g++){const y=h[g];c[g]=y*d.scale+d.min}}else if(d.dtype==="float16")r===void 0&&(r=qL()),c=r(h);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(i==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);c=new Int32Array(h.length);for(let g=0;g<h.length;g++){const y=h[g];c[g]=Math.round(y*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${i}`);s+=u*p}else if(i==="string"){const d=M(o.shape);c=[];for(let p=0;p<d;p++){const f=new Uint32Array(t.slice(s,s+Oc))[0];s+=Oc;const h=new Uint8Array(t.slice(s,s+f));c.push(h),s+=f}}else{const d=Sh[i],p=t.slice(s,s+u*d);if(i==="float32")c=new Float32Array(p);else if(i==="int32")c=new Int32Array(p);else if(i==="bool")c=new Uint8Array(p);else if(i==="complex64"){c=new Float32Array(p);const f=new Float32Array(c.length/2),h=new Float32Array(c.length/2);for(let m=0;m<f.length;m++)f[m]=c[m*2],h[m]=c[m*2+1];const g=_n(f,l,"float32"),y=_n(h,l,"float32");n[a]=wr(g,y),g.dispose(),y.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${i}`);s+=u*d}i!=="complex64"&&(n[a]=_n(c,l,i))}return n}function UL(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const mx=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ob(t){return mx?Buffer.byteLength(t):new Blob([t]).size}function WL(t){if(mx)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function GL(t){if(mx){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function gx(t){if(t.length===1)return t[0];let e=0;t.forEach(s=>{e+=s.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(s=>{n.set(new Uint8Array(s),r),r+=s.byteLength}),n.buffer}function ab(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function _T(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function AT(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function yx(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),AT(t,n,r)}function vl(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:ob(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:ob(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function OT(t){const e=[];for(const n of t)e.push(...n.weights);return e}function jL(){const t=n=>{let r=n<<13,s=0;for(;(r&8388608)===0;)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function HL(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function KL(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function qL(){const t=jL(),e=HL(),n=KL();return r=>{const s=new ArrayBuffer(4*r.length),o=new Uint32Array(s);for(let a=0;a<r.length;a++){const i=r[a],l=t[n[i>>10]+(i&1023)]+e[i>>10];o[a]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ie{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Ie.instance==null&&(Ie.instance=new Ie),Ie.instance}static registerSaveRouter(e){Ie.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Ie.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Ie.getHandlers(e,"save")}static getLoadHandlers(e,n){return Ie.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Ie.getInstance().loadRouters:Ie.getInstance().saveRouters).forEach(a=>{const i=a(e,r);i!==null&&s.push(i)}),s}}const XL=t=>Ie.registerSaveRouter(t),YL=t=>Ie.registerLoadRouter(t),QL=t=>Ie.getSaveHandlers(t),ZL=(t,e)=>Ie.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ch="tensorflowjs",$h=1,As="models_store",zr="model_info_store";function DT(){if(!_().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Th(t){const e=t.result;e.createObjectStore(As,{keyPath:"modelPath"}),e.createObjectStore(zr,{keyPath:"modelPath"})}class Ys{constructor(e){if(this.indexedDB=DT(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const o=this.indexedDB.open(Ch,$h);o.onupgradeneeded=()=>Th(o),o.onsuccess=()=>{const a=o.result;if(n==null){const i=a.transaction(As,"readonly"),u=i.objectStore(As).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(a.close(),s(u.error)),i.oncomplete=()=>a.close()}else{const i=vl(n),l=a.transaction(zr,"readwrite");let u=l.objectStore(zr);const c=u.put({modelPath:this.modelPath,modelArtifactsInfo:i});let d;c.onsuccess=()=>{d=a.transaction(As,"readwrite");const f=d.objectStore(As).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:i});f.onsuccess=()=>r({modelArtifactsInfo:i}),f.onerror=h=>{u=l.objectStore(zr);const g=u.delete(this.modelPath);g.onsuccess=()=>(a.close(),s(f.error)),g.onerror=y=>(a.close(),s(f.error))}},c.onerror=p=>(a.close(),s(c.error)),l.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},o.onerror=a=>s(o.error)})}}Ys.URL_SCHEME="indexeddb://";const PT=t=>_().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ys.URL_SCHEME)?JL(t.slice(Ys.URL_SCHEME.length)):null;Ie.registerSaveRouter(PT);Ie.registerLoadRouter(PT);function JL(t){return new Ys(t)}function e4(t){return t.startsWith(Ys.URL_SCHEME)?t.slice(Ys.URL_SCHEME.length):t}class t4{constructor(){this.indexedDB=DT()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Ch,$h);r.onupgradeneeded=()=>Th(r),r.onsuccess=()=>{const s=r.result,o=s.transaction(zr,"readonly"),i=o.objectStore(zr).getAll();i.onsuccess=()=>{const l={};for(const u of i.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},i.onerror=l=>(s.close(),n(i.error)),o.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=e4(e),new Promise((n,r)=>{const s=this.indexedDB.open(Ch,$h);s.onupgradeneeded=()=>Th(s),s.onsuccess=()=>{const o=s.result,a=o.transaction(zr,"readwrite"),i=a.objectStore(zr),l=i.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=i.delete(e),d=()=>{u=o.transaction(As,"readwrite");const f=u.objectStore(As).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=h=>r(l.error)};c.onsuccess=d,c.onerror=p=>(d(),o.close(),r(l.error))}},l.onerror=c=>(o.close(),r(l.error)),a.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const or="/",Co="tensorflowjs_models",FT="info",n4="model_topology",r4="weight_specs",s4="weight_data",o4="model_metadata";function LT(t){return{info:[Co,t,FT].join(or),topology:[Co,t,n4].join(or),weightSpecs:[Co,t,r4].join(or),weightData:[Co,t,s4].join(or),modelMetadata:[Co,t,o4].join(or)}}function BT(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function a4(t){const e=t.split(or);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(or)}function i4(t){return t.startsWith(Qs.URL_SCHEME)?t.slice(Qs.URL_SCHEME.length):t}class Qs{constructor(e){if(!_().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=LT(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=vl(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,WL(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw BT(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const i=JSON.parse(o);n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,i.signature!=null&&(n.signature=i.signature),i.userDefinedMetadata!=null&&(n.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(n.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(n.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(n.trainingConfig=i.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=GL(a),n}}Qs.URL_SCHEME="localstorage://";const VT=t=>_().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Qs.URL_SCHEME)?l4(t.slice(Qs.URL_SCHEME.length)):null;Ie.registerSaveRouter(VT);Ie.registerLoadRouter(VT);function l4(t){return new Qs(t)}class u4{constructor(){$(_().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),$(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Co+or,r=or+FT;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(n)&&o.endsWith(r)){const a=a4(o);e[a]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=i4(e);const n=LT(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return BT(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qo="://";class ct{constructor(){this.managers={}}static getInstance(){return ct.instance==null&&(ct.instance=new ct),ct.instance}static registerManager(e,n){$(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(qo)&&(e=e.slice(0,e.indexOf(qo))),$(e.length>0,()=>"scheme must not be an empty string.");const r=ct.getInstance();$(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=ct.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ct.getInstance().managers)}}function Fu(t){if(t.indexOf(qo)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ct.getSchemes().join(",")}`);return{scheme:t.split(qo)[0],path:t.split(qo)[1]}}async function MT(t,e,n=!1){$(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Ie.getLoadHandlers(t);$(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),$(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],o=Ie.getSaveHandlers(e);$(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),$(o.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const a=o[0],i=Fu(t).scheme,l=Fu(t).path,u=i===Fu(t).scheme,c=await s.load();n&&u&&await ct.getManager(i).removeModel(l);const d=await a.save(c);return n&&!u&&await ct.getManager(i).removeModel(l),d.modelArtifactsInfo}async function c4(){const t=ct.getSchemes(),e={};for(const n of t){const r=await ct.getManager(n).listModels();for(const s in r){const o=n+qo+s;e[o]=r[s]}}return e}async function d4(t){const e=Fu(t);return ct.getManager(e.scheme).removeModel(e.path)}async function p4(t,e){return MT(t,e,!1)}async function f4(t,e){return MT(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h4{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!_().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(_().get("IS_BROWSER")){_().setPlatform("browser",new h4);try{ct.registerManager(Qs.URL_SCHEME,new u4)}catch{}try{ct.registerManager(Ys.URL_SCHEME,new t4)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m4={importFetch:()=>require("node-fetch")};let Mp;class g4{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return _().global.fetch!=null?_().global.fetch(e,n):(Mp==null&&(Mp=m4.importFetch()),Mp(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}}_().get("IS_NODE")&&!_().get("IS_BROWSER")&&_().setPlatform("node",new g4);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(t,e="float32",n){return e=e||"float32",vg(t),new ua(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(t,e){const n=S(t,"x","cast");if(!eT(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return E.runKernel(Cd,r,s)}const ke=N({cast_:y4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(t){const n={x:S(t,"x","clone","string_or_numeric")};return E.runKernel($d,n)}const pr=N({clone_:x4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xx(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ET();const v4={buffer:Ee,cast:ke,clone:pr,print:xx};IL(v4);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w4="model",b4=".json",S4=".weights.bin";function ib(t){return new Promise(e=>setTimeout(e)).then(t)}class Zs{constructor(e){if(!_().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Zs.URL_SCHEME)&&(e=e.slice(Zs.URL_SCHEME.length)),(e==null||e.length===0)&&(e=w4),this.modelJsonFileName=e+b4,this.weightDataFileName=e+S4}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=_T(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await ib(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const i=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;i.download=this.weightDataFileName,i.href=n,await ib(()=>i.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:vl(e)}}}}Zs.URL_SCHEME="downloads://";class C4{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const o=JSON.parse(s.target.result),a=o.modelTopology;if(a==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}const l=yx(o,u=>this.loadWeights(u));e(l)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const a of e)n.push(...a.weights),r.push(...a.paths);const s=this.checkManifestAndWeightFiles(e),o=r.map(a=>this.loadWeightsFile(a,s[a]));return Promise.all(o).then(a=>[n,gx(a)])}loadWeightsFile(e,n){return new Promise((r,s)=>{const o=new FileReader;o.onload=a=>{const i=a.target.result;r(i)},o.onerror=a=>s(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(o=>ab(o.name)),s={};for(const o of e)o.paths.forEach(a=>{const i=ab(a);if(n.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(n.push(i),r.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);s[a]=this.weightsFiles[r.indexOf(i)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const $4=t=>_().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Zs.URL_SCHEME)?T4(t.slice(Zs.URL_SCHEME.length)):null;Ie.registerSaveRouter($4);function T4(t="model"){return new Zs(t)}function k4(t){return new C4(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lb(t,e,n,r){a(t),n=n==null?0:n,r=r==null?1:r,i(n,r);let s=0;const o=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function a(l){$(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function i(l,u){$(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),$(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),$(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zT(t,e){e==null&&(e={});const n=e.fetchFunc==null?_().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),s=0,o=.5,i=(e.onProgress==null?await Promise.all(r):await lb(r,e.onProgress,s,o)).map(d=>d.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(i):await lb(i,e.onProgress,l,u)}async function N4(t,e="",n,r){return UT(a=>zT(a,{requestInit:r}))(t,e,n)}function UT(t){return async(e,n="",r)=>{const s=e.map(()=>!1),o={},a=r!=null?r.map(()=>!1):[],i=[];if(e.forEach((f,h)=>{let g=0;f.weights.forEach(y=>{const m="quantization"in y?y.quantization.dtype:y.dtype,x=Sh[m]*M(y.shape),v=()=>{s[h]=!0,o[h]==null&&(o[h]=[]),o[h].push({manifestEntry:y,groupOffset:g,sizeBytes:x})};r!=null?r.forEach((b,C)=>{b===y.name&&(v(),a[C]=!0)}):v(),i.push(y.name),g+=x})}),!a.every(f=>f)){const f=r.filter((h,g)=>!a[g]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${i.join(", ")}.`)}const l=s.reduce((f,h,g)=>(h&&f.push(g),f),[]),u=[];l.forEach(f=>{e[f].paths.forEach(h=>{const g=n+(n.endsWith("/")?"":"/")+h;u.push(g)})});const c=await t(u),d={};let p=0;return l.forEach(f=>{const h=e[f].paths.length;let g=0;for(let b=0;b<h;b++)g+=c[p+b].byteLength;const y=new ArrayBuffer(g),m=new Uint8Array(y);let x=0;for(let b=0;b<h;b++){const C=new Uint8Array(c[p+b]);m.set(C,x),x+=C.byteLength}o[f].forEach(b=>{const C=y.slice(b.groupOffset,b.groupOffset+b.sizeBytes),k=RT(C,[b.manifestEntry]);for(const I in k)d[I]=k[I]}),p+=h}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E4="application/octet-stream",I4="application/json";class vx{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?($(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=_().platform.fetch,$(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&$(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=_T(e,r);n.body.append("model.json",new Blob([JSON.stringify(s)],{type:I4}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:E4}),"model.weights.bin");const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:vl(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return yx(n,o=>this.loadWeights(o))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=R4(n),o=this.weightPathPrefix||r,a=OT(e),i=[],l=[];for(const c of e)for(const d of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):i.push(o+d+s);this.weightUrlConverter&&i.push(...await Promise.all(l));const u=await zT(i,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,gx(u)]}}vx.URL_SCHEME_REGEX=/^https?:\/\//;function R4(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function kh(t){return t.match(vx.URL_SCHEME_REGEX)!=null}const WT=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>kh(r)):n=kh(t),n)return wx(t,e)}return null};Ie.registerSaveRouter(WT);Ie.registerLoadRouter(WT);function wx(t,e){return new vx(t,e)}function _4(t,e){return wx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zp{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class GT{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class A4{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function O4(t,e,n,r){const s=arguments;return new A4(jT(...s))}function jT(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new zp(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new zp({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new zp({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function D4(t){return new GT(t)}function P4(t){return new GT(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bx=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:k4,browserHTTPRequest:_4,concatenateArrayBuffers:gx,decodeWeights:RT,encodeWeights:zL,fromMemory:O4,fromMemorySync:jT,getLoadHandlers:ZL,getModelArtifactsForJSON:yx,getModelArtifactsForJSONSync:AT,getModelArtifactsInfoForJSON:vl,getSaveHandlers:QL,getWeightSpecs:OT,http:wx,isHTTPScheme:kh,loadWeights:N4,registerLoadRouter:YL,registerSaveRouter:XL,weightsLoaderFactory:UT,withSaveHandler:D4,withSaveHandlerSync:P4,copyModel:p4,listModels:c4,moveModel:f4,removeModel:d4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(t,e,n=!1,r=!1){let s=S(t,"a","matMul"),o=S(e,"b","matMul");[s,o]=Ae(s,o);const a={a:s,b:o},i={transposeA:n,transposeB:r};return E.runKernel(Lg,a,i)}const fe=N({matMul_:F4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L4(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:S(t,"indices","oneHot","int32")},i={dtype:s,depth:e,onValue:n,offValue:r};return E.runKernel(a0,a,i)}const Dc=N({oneHot_:L4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(){_().set("PROD",!0)}function V4(){_().set("DEBUG",!0)}function M4(){_().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function z4(t){_().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function U4(){E.disposeVariables()}function er(){return E}function W4(){return E.memory()}function G4(t){return E.profile(t)}function ie(t,e){return E.tidy(t,e)}function gt(t){dx(t).forEach(n=>n.dispose())}function Un(t){return E.keep(t)}function j4(t){return E.time(t)}function H4(t){return E.setBackend(t)}function K4(){return E.ready()}function q4(){return E.backendName}function X4(t){E.removeBackend(t)}function Y4(t){return E.findBackend(t)}function Q4(t){return E.findBackendFactory(t)}function HT(t,e,n=1){return E.registerBackend(t,e,n)}function Z4(){return E.backend}function J4(t,e){_().setPlatform(t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t){const n={input:S(t,"input","imag")};return E.runKernel(Ey,n)}const wl=N({imag_:eB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(t){const n={x:S(t,"x","neg")};return E.runKernel(e0,n)}const Hn=N({neg_:tB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(t){const n={input:S(t,"input","real")};return E.runKernel(g0,n)}const da=N({real_:nB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rB(t,e,n){const r=S(t,"x","transpose");if(e==null&&(e=r.shape.map((a,i)=>i).reverse()),$(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(a=>{$(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?ie(()=>{let a=da(r),i=wl(r);return a=E.runKernel(wi,{x:a},o),i=E.runKernel(wi,{x:i},o),n&&(i=Hn(i)),wr(a,i)}):E.runKernel(wi,s,o)}const qi=N({transpose_:rB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sB(t,e,n){const r=S(t,"labels","confusionMatrix"),s=S(e,"predictions","confusionMatrix");$(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),$(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),$(s.rank===1,()=>`Expected the rank of predictions to be 1, but got ${s.rank}`),$(r.shape[0]===s.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${s.shape[0]}. Labels and predictions should have the same number of elements.`),$(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const o=Dc(ke(r,"int32"),n),a=Dc(ke(s,"int32"),n),i=qi(o),l=fe(i,a);return ke(l,"int32")}const oB=N({confusionMatrix_:sB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aB=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:oB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xi(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const o=n-1-s,a=t[o]||1;(e[e.length-1-s]||1)>1&&a===1&&r.unshift(o)}return r}function Sx(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],o=e.length-r-1,a=e[o];(s==null||s===1&&a>1)&&n.unshift(o)}return n}function le(t,e){const n=[],r=Math.max(t.length,e.length);for(let s=0;s<r;s++){let o=t[t.length-s-1];o==null&&(o=1);let a=e[e.length-s-1];if(a==null&&(a=1),o===1)n.unshift(a);else if(a===1)n.unshift(o);else if(o!==a){const i=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(i)}else n.unshift(o)}return n}const iB=Object.freeze(Object.defineProperty({__proto__:null,getBroadcastDims:Xi,getReductionAxes:Sx,assertAndGetBroadcastShape:le},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cx(t,e,n){if(io(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=qn(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return us(t,e,r,n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xs;function KT(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,o=!1,a=!1,i=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)o=!0;else if(t.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)i=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Rc(kc,E.backendName)!=null){const h={pixels:t},g={numChannels:e};return E.runKernel(kc,h,g)}const[u,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(a)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(o||s||i){if(xs==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")xs=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else xs=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});xs.canvas.width=u,xs.canvas.height=c,xs.drawImage(t,0,0,u,c),d=xs.getImageData(0,0,u,c).data}let p;if(e===4)p=new Int32Array(d);else{const h=u*c;p=new Int32Array(h*e);for(let g=0;g<h;g++)for(let y=0;y<e;++y)p[g*e+y]=d[g*4+y]}return Cx(p,[c,u,e],"int32")}function lB(t){return t!=null&&t.data instanceof Uint8Array}function uB(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function cB(t){return t!=null&&t.width!==0&&t.height!==0}function dB(t){return uB()&&!(t instanceof ImageBitmap)&&cB(t)&&!lB(t)}async function pB(t,e=3){let n=null;if(_().getBool("WRAP_TO_IMAGEBITMAP")&&dB(t)){let r;try{r=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===t.width&&r.height===t.height?n=r:n=t}else n=t;return KT(n,e)}async function fB(t,e){let n=S(t,"img","toPixels");if(!(t instanceof _e)){const u=n;n=ke(u,"int32"),u.dispose()}if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,s]=n.shape.slice(0,2),o=n.rank===2?1:n.shape[2];if(o>4||o===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${o}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const a=await n.data(),i=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*r*4);for(let u=0;u<r*s;++u){const c=[0,0,0,255];for(let p=0;p<o;p++){const f=a[u*o+p];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);o===1?(c[0]=f*i,c[1]=f*i,c[2]=f*i):c[p]=f*i}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){e.width=s,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,s,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}const qT=N({fromPixels_:KT}),hB=Object.freeze(Object.defineProperty({__proto__:null,fromPixelsAsync:pB,toPixels:fB,fromPixels:qT},Symbol.toStringTag,{value:"Module"}));function $x(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(M(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,o=s[s.length-1];let a=1;for(let d=0;d<s.length-1;++d)a*=s[d];const i=t.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=i[d],l.push(i[d]);const c=[...He(t.shape).map(d=>d/u),1].slice(0,o);return[l,a,u,c]}const mB=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:$x},Symbol.toStringTag,{value:"Module"}));function Tx(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(o+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(o+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(o+` update.rank != ${s+t.length-r}`);for(let a=0;a<s;++a)if(n.shape[a]!==e.shape[a])throw new Error(o+` updates.shape[${a}] (${n.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<n.rank-s;++a)if(n.shape[a+s]!==t[a+r])throw new Error(o+` updates.shape[${a+s}] (${n.shape[a+s]}) != shape[${a+s}] (${t[a+s]})`)}function kx(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}Tx(n,e,t)}function Nd(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=n.length;let a=1;for(let d=s;d<o;++d)a*=n[d];const i=s<1?1:s,l=M(e.shape)/i,u=[...He(n.slice(0,s)),1],c=M(n);return{sliceRank:s,numUpdates:l,sliceSize:a,strides:u,outputSize:c}}const gB=Object.freeze(Object.defineProperty({__proto__:null,validateUpdateShape:Tx,validateInput:kx,calculateShapes:Nd},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nh=-2,yB=-1;function XT(t,e,n){const r=t.shape.length;$(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),$(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)$(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function xB(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function YT(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function QT(t,e,n,r){const s=[...t];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<n;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function ZT(t,e,n){return n<=t?n:n-(e-1)}function JT(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function vB(t,e,n,r,s,o,a,i,l){const u=t.length;let c=new Array(u),d=new Array(u),p=new Array(u);if(e.length&&n>0){const f=e[0],h=n+1;c=ek(a,f,h,r,t),d=tk(i,f,h,s,t),p=QT(o,f,h,t)}else for(let f=0;f<u;f++)c[f]=rk(a,r,o,t,f,l),d[f]=sk(i,s,o,t,f,l),p[f]=nk(o,f,l);return{begin:c,end:d,strides:p}}function ek(t,e,n,r,s){const o=[...s],a=JT(n,e);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=0;else{const l=ZT(e,n,i);let u=r[l];t&1<<l&&(u=0),o[i]=u}return o}function tk(t,e,n,r,s){const o=[...s],a=JT(n,e);for(let i=0;i<o.length;i++)if(a.indexOf(i)>-1)o[i]=Number.MAX_SAFE_INTEGER;else{const l=ZT(e,n,i);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[i]=u}for(let i=0;i<o.length;i++){const l=s[i];o[i]<0&&(o[i]+=l),o[i]=Gi(0,o[i],s[i])}return o}function nk(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function rk(t,e,n,r,s,o){let a=e[s];const i=n[s]||1;(t&1<<s||o&1<<s||a==null)&&(i>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),a=Gi(0,a,l-1),a}function sk(t,e,n,r,s,o){let a=e[s];const i=n[s]||1;(t&1<<s||o&1<<s||a==null)&&(i>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),i>0?a=Gi(0,a,l):a=Gi(-1,a,l-1),a}function Nx(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function Ex(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function ok(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(a=>{$(a!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(s).fill(-1):typeof n=="number"?o=[n,...new Array(s-1).fill(-1)]:n.length<s?o=n.concat(new Array(s-n.length).fill(-1)):o=n,o=o.map((a,i)=>a>=0?a:($(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${i}.`),t.shape[i]-r[i])),[r,o]}function ak(t,e,n,r,s,o,a,i,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)c&&(1<<v&i)!==0&&d.numAddAxisAfterEllipsis++,1<<v&a&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};wB(d,p);let f=!0,h=!0,g=!0;const y=[],m=[];for(let v=0;v<t.length;++v){if(p.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const b=!!(p.shrinkAxisMask&1<<v),C=t[v];if(C===-1){y.push(b?1:-1);continue}const k=[p.beginMask&1<<v,p.endMask&1<<v],I=[p.strides[v]>0?0:-1,p.strides[v]>0?C:C-1];if(b&&p.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&p.strides[v]===1;const R=!!(p.beginMask&1<<v&&p.endMask&1<<v);if(p.beginValid&&p.endValid){if(b){const j=p.begin[v]<0?C+p.begin[v]:p.begin[v];if(p.begin[v]=j,p.end[v]=p.begin[v]+1,j<0||j>=C)throw Error(`slice index ${p.begin[v]} of dimension ${v} out of bounds.`)}else p.begin[v]=ub(p.begin[v],0,p.strides[v],C,k,I),p.end[v]=ub(p.end[v],1,p.strides[v],C,k,I);const V=p.strides[v]===1&&p.begin[v]===0&&p.end[v]===C;f=f&&V,h=h&&(v===0&&p.strides[v]===1||V)}else f=f&&p.strides[v]===1&&R,h=h&&(v===0&&p.strides[v]===1||R);let D,O=!1;if(p.beginValid&&p.endValid?(D=p.end[v]-p.begin[v],O=!0):b?(D=1,O=!0):R&&C>=0&&(p.strides[v]<0?D=-C:D=C,O=!0),O){let V;D===0||D<0!=p.strides[v]<0?V=0:V=Math.trunc(D/p.strides[v])+(D%p.strides[v]!==0?1:0),y.push(V)}else y.push(-1)}for(let v=0;v<p.finalShapeGatherIndices.length;++v){const b=p.finalShapeGatherIndices[v];b>=0?m.push(y[b]):b===Nh&&m.push(1)}return{finalShapeSparse:m.filter((v,b)=>p.finalShapeGatherIndices[b]!==Nh),finalShape:m,isIdentity:f,sliceDim0:h,isSimpleSlice:g,begin:p.begin,end:p.end,strides:p.strides}}function wB(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(Nh),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(yB),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function ub(t,e,n,r,s,o){if(s[e])return n>0?o[e]:o[e+1&1];{const a=t<0?r+t:t;return a<o[0]?o[0]:a>o[1]?o[1]:a}}const ik=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:XT,maskToAxes:xB,computeOutShape:YT,stridesWithElidedDims:QT,getNormalizedAxes:vB,startIndicesWithElidedDims:ek,stopIndicesWithElidedDims:tk,stridesForAxis:nk,startForAxis:rk,stopForAxis:sk,isSliceContinous:Nx,computeFlatOffset:Ex,parseSliceParams:ok,sliceInfo:ak},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lk{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Fr{constructor(){this.classNameMap={}}static getMap(){return Fr.instance==null&&(Fr.instance=new Fr),Fr.instance}static register(e){Fr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function cs(t){$(t.className!=null,()=>"Class being registered does not have the static className property defined."),$(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),$(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Fr.register(t)}const bB=Object.freeze(Object.defineProperty({__proto__:null,Serializable:lk,SerializationMap:Fr,registerClass:cs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SB=.001,uk=.1;function CB(t,e,n){return n==null&&(n=Ix()),Eh(t,e,(r,s)=>Rx(r,s,n))}function Ix(){return E.backend.floatPrecision()===32?SB:uk}function Eh(t,e,n){let r=!0;if((nt(t)||nt(e))&&(r=!1),nt(t)&&nt(e)&&(r=!0),r){const a=t.constructor.name,i=e.constructor.name;if(a!==i)throw new Error(`Arrays are of different type. Actual: ${a}. Expected: ${i}`)}if(Array.isArray(t)&&Array.isArray(e)){const a=qn(t),i=qn(e);if(!Ne(a,i))throw new Error(`Arrays have different shapes. Actual: [${a}]. Expected: [${i}]`)}const s=nt(t)?t:xr(t),o=nt(e)?e:xr(e);if(s.length!==o.length)throw new Error(`Arrays have different lengths actual: ${s.length} vs expected: ${o.length}.
Actual:   ${s}.
Expected: ${o}.`);for(let a=0;a<o.length;++a){const i=s[a],l=o[a];if(!n(i,l))throw new Error(`Arrays differ: actual[${a}] = ${i}, expected[${a}] = ${l}.
Actual:   ${s}.
Expected: ${o}.`)}typeof expect<"u"&&expect().nothing()}function $B(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function TB(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return lr(t)||lr(t[0])||lr(e)||lr(e[0])?Eh(t,n,(r,s)=>r==s):Eh(t,e,(r,s)=>Rx(r,s,0))}function kB(t,e,n){if(n==null&&(n=Ix()),!Rx(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function Rx(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function NB(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function EB(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let s=0;s<r.length;s++)if(n[s]!==r[s])throw new Error(`Expected ArrayBuffer value at ${s} to be ${r[s]} but got ${n[s]} instead`)}function ck(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?ck(n):t[e]=dr(n)}return t}function IB(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",r=>n(e)),e.load()})}async function RB(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const _B=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:uk,expectArraysClose:CB,testEpsilon:Ix,expectPromiseToFail:$B,expectArraysEqual:TB,expectNumbersClose:kB,expectValuesInRange:NB,expectArrayBuffersEqual:EB,encodeStrings:ck,createVideoElement:IB,play:RB},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const AB="4.0.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OB(t,e){let n=S(t,"a","add"),r=S(e,"b","add");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(Sd,s)}const ee=N({add_:OB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(t,e){let n=S(t,"a","floorDiv"),r=S(e,"b","floorDiv");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(by,s)}const _x=N({floorDiv_:DB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t,e){let n=S(t,"a","div"),r=S(e,"b","div");if([n,r]=Ae(n,r),n.dtype==="int32"&&r.dtype==="int32")return _x(n,r);const s={a:n,b:r},o={};return E.runKernel(uy,s,o)}const xe=N({div_:PB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FB(t,e){let n=S(t,"a","mul"),r=S(e,"b","mul");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(Jy,s)}const W=N({mul_:FB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(t){const e=S(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return E.runKernel(Gg,n)}else{const n={x:e};return E.runKernel(Sg,n)}}const Et=N({abs_:LB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BB(t){const n={x:S(t,"x","acos")};return E.runKernel(Cg,n)}const dk=N({acos_:BB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t){const n={x:S(t,"x","acosh")};return E.runKernel($g,n)}const pk=N({acosh_:VB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(t){$(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),$(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,o)=>S(s,`tensors${o}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!Ne(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return E.runKernel(Tg,r)}const fk=N({addN_:MB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zB(t,e=null,n=!1){const s={x:S(t,"x","all","bool")},o={axis:e,keepDims:n};return E.runKernel(kg,s,o)}const hk=N({all_:zB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e=null,n=!1){const s={x:S(t,"x","any","bool")},o={axis:e,keepDims:n};return E.runKernel(Ng,s,o)}const mk=N({any_:UB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(t,e=0){const r={x:S(t,"x","argMax")},s={axis:e};return E.runKernel(Eg,r,s)}const gk=N({argMax_:WB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GB(t,e=0){const r={x:S(t,"x","argMin")},s={axis:e};return E.runKernel(Ig,r,s)}const yk=N({argMin_:GB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jB(t){const n={x:S(t,"x","asin")};return E.runKernel(Rg,n)}const xk=N({asin_:jB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(t){const n={x:S(t,"x","asinh")};return E.runKernel(_g,n)}const vk=N({asinh_:HB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(t){const n={x:S(t,"x","atan")};return E.runKernel(Ag,n)}const wk=N({atan_:KB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(t,e){let n=S(t,"a","atan2"),r=S(e,"b","atan2");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(Dg,s)}const bk=N({atan2_:qB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(t){const n={x:S(t,"x","atanh")};return E.runKernel(Og,n)}const Sk=N({atanh_:XB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ck(t,e,n,r,s="NHWC",o){const a=t[3],i=[...e,a],l=Sa(s);return qt(t,i,n,o,r,null,null,l)}function co(t,e,n,r,s,o,a="channelsLast"){const[i,l]=Pc(e);let u;if(a==="channelsLast")u=[i,l,t[3],t[3]];else if(a==="channelsFirst")u=[i,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${a}`);return qt(t,u,n,r,s,o,!1,a)}function bl(t,e,n,r,s,o,a="NDHWC"){const[i,l,u]=Ih(e);let c,d;if(a==="NDHWC")d="channelsLast",c=[i,l,u,t[4],t[4]];else if(a==="NCDHW")d="channelsFirst",c=[i,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${a}`);return Sl(t,c,n,r,s,!1,d,o)}function qt(t,e,n,r,s,o,a=!1,i="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d]=t;else if(i==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${i}`);const[p,f,,h]=e,[g,y]=Pc(n),[m,x]=Pc(r),v=Xo(p,m),b=Xo(f,x),{padInfo:C,outHeight:k,outWidth:I}=ZB(s,u,c,g,y,v,b,o,i),R=a?h*d:h;let D;return i==="channelsFirst"?D=[l,R,k,I]:i==="channelsLast"&&(D=[l,k,I,R]),{batchSize:l,dataFormat:i,inHeight:u,inWidth:c,inChannels:d,outHeight:k,outWidth:I,outChannels:R,padInfo:C,strideHeight:g,strideWidth:y,filterHeight:p,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:b,dilationHeight:m,dilationWidth:x,inShape:t,outShape:D,filterShape:e}}function Sl(t,e,n,r,s,o=!1,a="channelsLast",i){let[l,u,c,d,p]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d,p]=t;else if(a==="channelsFirst")[l,p,u,c,d]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,h,g,,y]=e,[m,x,v]=Ih(n),[b,C,k]=Ih(r),I=Xo(f,b),R=Xo(h,C),D=Xo(g,k),{padInfo:O,outDepth:V,outHeight:j,outWidth:Z}=JB(s,u,c,d,m,x,v,I,R,D,i),J=o?y*p:y;let re;return a==="channelsFirst"?re=[l,J,V,j,Z]:a==="channelsLast"&&(re=[l,V,j,Z,J]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:V,outHeight:j,outWidth:Z,outChannels:J,padInfo:O,strideDepth:m,strideHeight:x,strideWidth:v,filterDepth:f,filterHeight:h,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:R,effectiveFilterWidth:D,dilationDepth:b,dilationHeight:C,dilationWidth:k,inShape:t,outShape:re,filterShape:e}}function YB(t,e,n,r,s){r==null&&(r=Ax(t,e,n));const o=t[0],a=t[1],i=Bs((o-e+2*r)/n+1,s),l=Bs((a-e+2*r)/n+1,s);return[i,l]}function QB(t,e,n,r,s,o){s==null&&(s=Ax(t,e,r));const a=t[0],i=t[1],l=t[2],u=Bs((a-e+2*s)/r+1,o),c=Bs((i-e+2*s)/r+1,o),d=Bs((l-e+2*s)/r+1,o);return[u,c,d,n]}function Ax(t,e,n,r=1){const s=Xo(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function Pc(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Ih(t){return typeof t=="number"?[t,t,t]:t}function Xo(t,e){return e<=1?t:t+(t-1)*(e-1)}function ZB(t,e,n,r,s,o,a,i,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=YB([e,n],o,r,t,i);c=f[0],d=f[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const p=Math.max(0,(c-1)*r+o-e),f=Math.max(0,(d-1)*s+a-n),h=Math.floor(p/2),g=p-h,y=Math.floor(f/2),m=f-y;u={top:h,bottom:g,left:y,right:m,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),d=Math.ceil((n-a+1)/s);else if(typeof t=="object"){const p=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],h=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];u={top:p,bottom:f,left:h,right:g,type:p===0&&f===0&&h===0&&g===0?"VALID":"EXPLICIT"},c=Bs((e-o+p+f)/r+1,i),d=Bs((n-a+h+g)/s+1,i)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function JB(t,e,n,r,s,o,a,i,l,u,c){let d,p,f,h;if(typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=QB([e,n,r,1],i,1,s,t,c);p=y[0],f=y[1],h=y[2]}else if(t==="same"){p=Math.ceil(e/s),f=Math.ceil(n/o),h=Math.ceil(r/a);const g=(p-1)*s+i-e,y=(f-1)*o+l-n,m=(h-1)*a+u-r,x=Math.floor(g/2),v=g-x,b=Math.floor(y/2),C=y-b,k=Math.floor(m/2),I=m-k;d={top:b,bottom:C,left:k,right:I,front:x,back:v,type:"SAME"}}else if(t==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-i+1)/s),f=Math.ceil((n-l+1)/o),h=Math.ceil((r-u+1)/a);else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:f,outWidth:h}}function Bs(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Yi(t){const[e,n,r]=Pc(t);return e===1&&n===1&&r===1}function Vt(t,e){return Yi(t)||Yi(e)}function Sa(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function yn(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")$(Ks(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{$(Ks(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(t,e){const r={x:S(t,"x","reshape","string_or_numeric")},s={shape:e};return E.runKernel(v0,r,s)}const P=N({reshape_:eV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(t,e,n,r,s){const o=S(t,"x","avgPool","float32"),a=1;$(Vt(n,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let i=o,l=!1;o.rank===3&&(l=!0,i=P(o,[1,o.shape[0],o.shape[1],o.shape[2]])),$(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),yn("avgPool",r,s);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=E.runKernel(Pg,u,c);return d=ke(d,o.dtype),l?P(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ox=N({avgPool_:tV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(t,e,n,r,s,o="NDHWC"){const a=S(t,"x","avgPool3d","float32");let i=a,l=!1;a.rank===4&&(l=!0,i=P(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),$(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),$(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),yn("avgPool3d",r,s);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o};let d=E.runKernel(Fg,u,c);return d=ke(d,i.dtype),l?P(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const $k=N({avgPool3d_:nV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rV(t,e=0){$(t.length>=1,()=>"Pass at least one tensor to concat");const n=Ki(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return pr(n[0]);const r=n,s={axis:e};return E.runKernel(jg,r,s)}const st=N({concat_:rV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(t){const n={x:S(t,"x","sigmoid","float32")};return E.runKernel(D0,n)}const Vs=N({sigmoid_:sV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t,e,n){const r=S(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:n};return E.runKernel(R0,s,o)}const he=N({slice_:oV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t){const n={x:S(t,"x","tanh","float32")};return E.runKernel(J0,n)}const Fc=N({tanh_:aV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(t,e,n,r,s,o){const a=S(t,"forgetBias","basicLSTMCell"),i=S(e,"lstmKernel","basicLSTMCell"),l=S(n,"lstmBias","basicLSTMCell"),u=S(r,"data","basicLSTMCell"),c=S(s,"c","basicLSTMCell"),d=S(o,"h","basicLSTMCell"),p=st([u,d],1),f=fe(p,i),h=ee(f,l),g=h.shape[0],y=h.shape[1]/4,m=[g,y],x=he(h,[0,0],m),v=he(h,[0,y],m),b=he(h,[0,y*2],m),C=he(h,[0,y*3],m),k=ee(W(Vs(x),Fc(v)),W(c,Vs(ee(a,b)))),I=W(Fc(k),Vs(C));return[k,I]}const Tk=N({basicLSTMCell_:iV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(t,e,n){const r=S(t,"x","batchToSpaceND"),s=e.reduce((i,l)=>i*l);$(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),$(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),$(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},a={blockShape:e,crops:n};return E.runKernel(Bg,o,a)}const Dx=N({batchToSpaceND_:lV});function uV(t){let e;return t.rank===0||t.rank===1?e=P(t,[1,1,1,t.size]):t.rank===2?e=P(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=P(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(t,e,n,r,s,o){o==null&&(o=.001);const a=S(t,"x","batchNorm"),i=S(e,"mean","batchNorm"),l=S(n,"variance","batchNorm");let u;s!=null&&(u=S(s,"scale","batchNorm"));let c;r!=null&&(c=S(r,"offset","batchNorm")),$(i.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),$(c==null||i.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),$(u==null||i.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:uV(a),scale:u,offset:c,mean:i,variance:l},f={varianceEpsilon:o},h=E.runKernel(Sy,p,f);return P(h,a.shape)}const Cl=N({batchNorm_:cV});function dV(t,e,n,r,s,o){const a=S(t,"x","batchNorm"),i=S(e,"mean","batchNorm"),l=S(n,"variance","batchNorm");let u;s!=null&&(u=S(s,"scale","batchNorm"));let c;return r!=null&&(c=S(r,"offset","batchNorm")),$(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),$(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),$(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&$(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&$(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Cl(a,i,l,c,u,o)}const kk=N({batchNorm2d_:dV});function pV(t,e,n,r,s,o){const a=S(t,"x","batchNorm"),i=S(e,"mean","batchNorm"),l=S(n,"variance","batchNorm");let u;s!=null&&(u=S(s,"scale","batchNorm"));let c;return r!=null&&(c=S(r,"offset","batchNorm")),$(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),$(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),$(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&$(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&$(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Cl(a,i,l,c,u,o)}const Nk=N({batchNorm3d_:pV});function fV(t,e,n,r,s,o){const a=S(t,"x","batchNorm"),i=S(e,"mean","batchNorm"),l=S(n,"variance","batchNorm");let u;s!=null&&(u=S(s,"scale","batchNorm"));let c;return r!=null&&(c=S(r,"offset","batchNorm")),$(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),$(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),$(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&$(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&$(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Cl(a,i,l,c,u,o)}const Ek=N({batchNorm4d_:fV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(t,e,n){const r=S(t,"x","bincount"),s=S(e,"weights","bincount");$(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),$(n>=0,()=>`size must be non-negative, but got ${n}.`),$(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},a={size:n};return E.runKernel(Vg,o,a)}const Px=N({bincount_:hV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t,e){const n=S(t,"s0","broadcastArgs","int32"),r=S(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return E.runKernel(Mg,s)}const Ik=N({broadcastArgs_:mV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(t,e){let n=S(t,"broadcastTo","x");const r=n.shape;if(e.some(u=>!(u>0)||u%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=P(n,u)}const s=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return pr(n);const i={x:n},l={reps:o};return E.runKernel(Td,i,l)}const Yo=N({broadcastTo_:gV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(t){const n={x:S(t,"x","ceil","float32")};return E.runKernel(zg,n)}const Rk=N({ceil_:yV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t,e,n){const r={shape:t,value:e,dtype:n};return E.runKernel(xy,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(t,e,n){const r=S(t,"x","clipByValue");if($(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Ca(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:n};return E.runKernel(Ug,s,o)}const _k=N({clipByValue_:xV});function vV(t){return st(t,0)}const Ak=N({concat1d_:vV});function wV(t,e){return st(t,e)}const Ok=N({concat2d_:wV});function bV(t,e){return st(t,e)}const Dk=N({concat3d_:bV});function SV(t,e){return st(t,e)}const Pk=N({concat4d_:SV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(t,e,n,r,s="NHWC",o=[1,1],a){const i=S(t,"x","conv2d","float32"),l=S(e,"filter","conv2d","float32");let u=i,c=!1;i.rank===3&&(c=!0,u=P(i,[1,i.shape[0],i.shape[1],i.shape[2]])),$(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),$(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),yn("conv2d",r,a);const d=s==="NHWC"?u.shape[3]:u.shape[1];$(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),$(Vt(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const p={x:u,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:a},h=E.runKernel(Hg,p,f);return c?P(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const $l=N({conv2d_:CV});function $V(t,e,n,r,s="NWC",o=1,a){const i=S(t,"x","conv1d"),l=S(e,"filter","conv1d");let u=i,c=!1;i.rank===2&&(c=!0,u=P(i,[1,i.shape[0],i.shape[1]])),$(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),$(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),yn("conv1d",r,a),$(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),$(Vt(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),$(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=P(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=P(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=$l(p,d,[1,n],r,"NHWC",[1,o],a);return c?P(y,[y.shape[2],y.shape[3]]):P(y,[y.shape[0],y.shape[2],y.shape[3]])}const Fk=N({conv1d_:$V});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(t,e,n,r,s,o="NHWC",a){$(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,l=e,u=!1;e.rank===3&&(u=!0,l=P(e,[1,e.shape[0],e.shape[1],e.shape[2]]),i=[1,t[0],t[1],t[2]]),$(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),$(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),$(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?i[3]:i[1],d=o==="NHWC"?l.shape[3]:l.shape[1];$(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),$(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),yn("conv2dDerInput",s,a);const p={dy:l,filter:n},f={strides:r,pad:s,dataFormat:o,dimRoundingMode:a,inputShape:i},h=E.runKernel(qg,p,f);return u?P(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Lk=N({conv2DBackpropInput_:TV});function kV(t,e,n,r,s,o){const a=S(t,"x","conv2dTranspose"),i=S(e,"filter","conv2dTranspose");return Lk(n,a,i,r,s,"NHWC",o)}const Bk=N({conv2dTranspose_:kV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NV(t,e,n,r,s="NDHWC",o=[1,1,1]){const a=S(t,"x","conv3d"),i=S(e,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=P(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),$(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),$(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),$(l.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${i.shape[3]}.`),$(Vt(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),$(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`);const c={x:l,filter:i},d={strides:n,pad:r,dataFormat:s,dilations:o},p=E.runKernel(Xg,c,d);return u?P(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Vk=N({conv3d_:NV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(t,e,n,r,s){$(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,a=e,i=!1;e.rank===4&&(i=!0,a=P(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=a.shape[4];$(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),$(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),$(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),$(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),$(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:a,filter:n},d={pad:s,strides:r,inputShape:o},p=E.runKernel(Yg,c,d);return i?P(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const IV=N({conv3DBackpropInput_:EV});function RV(t,e,n,r,s){const o=S(t,"x","conv3dTranspose"),a=S(e,"filter","conv3dTranspose");return IV(n,o,a,r,s)}const Mk=N({conv3dTranspose_:RV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(t){const n={x:S(t,"x","cos","float32")};return E.runKernel(Qg,n)}const zk=N({cos_:_V});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(t){const n={x:S(t,"x","cosh","float32")};return E.runKernel(Zg,n)}const Uk=N({cosh_:AV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t,e=0,n=!1,r=!1){const o={x:S(t,"x","cumprod")},a={axis:e,exclusive:n,reverse:r};return E.runKernel(Jg,o,a)}const Wk=N({cumprod_:OV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(t,e=0,n=!1,r=!1){const o={x:S(t,"x","cumsum")},a={axis:e,exclusive:n,reverse:r};return E.runKernel(ey,o,a)}const Gk=N({cumsum_:DV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PV(t,e,n,r=!1){const s=S(t,"x","denseBincount"),o=S(e,"weights","denseBincount");$(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),$(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),$(n>=0,()=>`size must be non-negative, but got ${n}.`),$(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const a={x:s,weights:o},i={size:n,binaryOutput:r};return E.runKernel(ny,a,i)}const jk=N({denseBincount_:PV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t,e,n="NHWC"){const r=S(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];$(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),$(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),$(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),$(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${r.shape}`);const i={x:r},l={blockSize:e,dataFormat:n};return E.runKernel(ry,i,l)}const Hk=N({depthToSpace_:FV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LV(t,e,n,r,s="NHWC",o=[1,1],a){const i=S(t,"x","depthwiseConv2d","float32"),l=S(e,"filter","depthwiseConv2d","float32");let u=i,c=!1;i.rank===3&&(c=!0,u=P(i,[1,i.shape[0],i.shape[1],i.shape[2]])),$(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),$(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];$(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),yn("depthwiseConv2d",r,a);const p={x:u,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:a},h=E.runKernel(sy,p,f);return c?P(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Ed=N({depthwiseConv2d_:LV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(t){const n={x:S(t,"x","diag")};return E.runKernel(iy,n)}const Kk=N({diag_:BV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VV(t,e,n,r,s=[1,1],o="NHWC"){const a=S(t,"x","dilation2d"),i=S(e,"filter","dilation2d");$(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),$(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),$(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=a,u=!1;a.rank===3&&(l=P(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0);const c={x:l,filter:i},d={strides:n,pad:r,dilations:s},p=E.runKernel(ly,c,d);return u?P(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const qk=N({dilation2d_:VV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t,e){let n=S(t,"a","equal","string_or_numeric"),r=S(e,"b","equal","string_or_numeric");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(fy,s)}const Fx=N({equal_:MV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zV(t,e,n){const r=S(e,"a","where"),s=S(n,"b","where"),o=S(t,"condition","where","bool"),a=le(le(o.shape,r.shape),s.shape),i=Yo(o,a),l=Yo(r,a),u=Yo(s,a),c={condition:i,t:l,e:u};return E.runKernel(E0,c)}const Js=N({where_:zV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(t){const n={x:S(t,"x","zerosLike")};return E.runKernel(ox,n)}const Pt=N({zerosLike_:UV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WV(t,e){let n=S(t,"a","div"),r=S(e,"b","div");[n,r]=Ae(n,r);const s=xe(n,r),o=Pt(s),a=Fx(r,o);return Js(a,o,s)}const Xk=N({divNoNan_:WV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GV(t,e){const n=S(t,"t1","dot"),r=S(e,"t2","dot");$((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if($(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),n.rank===1&&r.rank===1){const a=P(n,[1,-1]),i=P(r,[-1,1]),l=fe(a,i);return P(l,[])}else if(n.rank===1&&r.rank===2){const a=P(n,[1,-1]),i=P(r,[r.shape[0],r.shape[1]]),l=fe(a,i);return P(l,[l.size])}else if(n.rank===2&&r.rank===1){const a=P(r,[-1,1]),i=fe(n,a);return P(i,[i.size])}else{const a=P(r,[r.shape[0],r.shape[1]]);return fe(n,a)}}const Yk=N({dot_:GV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(t,...e){const n=e.map((s,o)=>S(s,`tensors${o}`,"einsum")),r={equation:t};return E.runKernel(cy,n,r)}const Qk=N({einsum_:jV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(t){const n={x:S(t,"x","elu","float32")};return E.runKernel(dy,n)}const Lx=N({elu_:HV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KV(t){let e=S(t,"x","erf");$(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ke(e,"float32"));const n={x:e};return E.runKernel(py,n)}const Zk=N({erf_:KV});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Jk(t,e,n){const r=t.length+e.length,s=[];let o=0,a=0;for(let i=0;i<r;i++)n.indexOf(i)===-1?s.push(t[o++]):s.push(e[a++]);return s}function Zn(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);const s=e.map(o=>t[o]);return[n,s]}function Xt(t,e){const n=e.map(r=>1);return Jk(t,n,e)}function Fn(t,e,n){$(Bx(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function xn(t,e){if(Bx(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Vx(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function vn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(t,e=null,n=!1){const s={x:S(t,"x","max")},o={reductionIndices:e,keepDims:n};return E.runKernel(Uy,s,o)}const Ms=N({max_:qV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XV(t,e=null,n=!1){const s={x:S(t,"x","min")},o={axis:e,keepDims:n};return E.runKernel(qy,s,o)}const Lc=N({min_:XV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YV(t,e){let n=S(t,"base","pow"),r=S(e,"exp","pow");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(u0,s)}const pa=N({pow_:YV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oe(t,e){if((nt(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&nt(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return us(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QV(t){const n={x:S(t,"x","sqrt","float32")};return E.runKernel(F0,n)}const Xn=N({sqrt_:QV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZV(t){const e=S(t,"x","square"),n={};return E.runKernel("Square",{x:e},n)}const hn=N({square_:ZV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JV(t,e=null,n=!1){let r=S(t,"x","sum");r.dtype==="bool"&&(r=ke(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return E.runKernel(L0,s,o)}const ye=N({sum_:JV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eM(t,e="euclidean",n=null,r=!1){t=S(t,"x","norm");const s=eN(t,e,n);let o=s.shape;if(r){const a=Ue(n,t.shape);o=Xt(s.shape,a)}return P(s,o)}function eN(t,e,n=null){if(t.rank===0)return Et(t);if(t.rank!==1&&n===null)return eN(P(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return ye(Et(t),n);if(e===1/0)return Ms(Et(t),n);if(e===-1/0)return Lc(Et(t),n);if(e==="euclidean"||e===2)return Xn(ye(pa(Et(t),oe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Ms(ye(Et(t),n[0]),n[1]-1);if(e===1/0)return Ms(ye(Et(t),n[1]),n[0]);if(e===-1/0)return Lc(ye(Et(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Xn(ye(hn(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Tl=N({norm_:eM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tM(t,e=null,n=!1){return Tl(t,"euclidean",e,n)}const tN=N({euclideanNorm_:tM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nM(t){const n={x:S(t,"x","exp")};return E.runKernel(hy,n)}const ss=N({exp_:nM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rM(t,e=0){const n=S(t,"x","expandDims","string_or_numeric");$(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return E.runKernel(my,r,s)}const Or=N({expandDims_:rM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sM(t){const n={x:S(t,"x","expm1")};return E.runKernel(gy,n)}const nN=N({expm1_:sM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oM(t,e){const n=S(t,"x","tile","string_or_numeric");$(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return E.runKernel(Td,r,s)}const Qo=N({tile_:oM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aM(t,e,n,r="float32"){e==null&&(e=t);const s=Ee([t,e],r),o=t<=e?t:e;for(let i=0;i<o;++i)s.set(1,i,i);const a=P(s.toTensor(),[t,e]);if(n==null)return a;if(n.length===1)return Qo(Or(a,0),[n[0],1,1]);if(n.length===2)return Qo(Or(Or(a,0),0),[n[0],n[1],1,1]);if(n.length===3)return Qo(Or(Or(Or(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Mx=N({eye_:aM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iM(t){const n={x:S(t,"x","floor","float32")};return E.runKernel(wy,n)}const zx=N({floor_:iM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lM(t,e,n=0,r=0){const s=S(t,"x","gather"),o=S(e,"indices","gather","int32"),a={x:s,indices:o},i={axis:n,batchDims:r};return E.runKernel(Cy,a,i)}const Ux=N({gather_:lM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uM(t,e){let n=S(t,"a","greater","string_or_numeric"),r=S(e,"b","greater","string_or_numeric");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(Ty,s)}const kl=N({greater_:uM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cM(t,e){let n=S(t,"a","greaterEqual","string_or_numeric"),r=S(e,"b","greaterEqual","string_or_numeric");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(ky,s)}const Wx=N({greaterEqual_:cM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dM(t){const n={x:S(t,"x","isFinite")};return E.runKernel(Iy,n)}const rN=N({isFinite_:dM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pM(t){const n={x:S(t,"x","isInf")};return E.runKernel(Ry,n)}const sN=N({isInf_:pM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fM(t){const n={x:S(t,"x","isNaN")};return E.runKernel(_y,n)}const oN=N({isNaN_:fM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hM(t,e=.2){const r={x:S(t,"x","leakyRelu")},s={alpha:e};return E.runKernel(Ay,r,s)}const Gx=N({leakyRelu_:hM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mM(t,e){let n=S(t,"a","less","string_or_numeric"),r=S(e,"b","less","string_or_numeric");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(Oy,s)}const aN=N({less_:mM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gM(t,e){let n=S(t,"a","lessEqual","string_or_numeric"),r=S(e,"b","lessEqual","string_or_numeric");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(Dy,s)}const Id=N({lessEqual_:gM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iN(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return E.runKernel(Py,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(t,e=5,n=1,r=1,s=.5){const o=S(t,"x","localResponseNormalization");$(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),$(Ks(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=o,i=!1;o.rank===3&&(i=!0,a=P(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:a},u={depthRadius:e,bias:n,alpha:r,beta:s},c=E.runKernel(zy,l,u);return i?P(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const lN=N({localResponseNormalization_:yM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xM(t){const n={x:S(t,"x","log","float32")};return E.runKernel(Fy,n)}const fa=N({log_:xM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vM(t){const n={x:S(t,"x","log1p")};return E.runKernel(Ly,n)}const jx=N({log1p_:vM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wM(t){return $(rs(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const r=S(e,"x","tf.grad","string_or_numeric"),s=n!=null?S(n,"dy","tf.grad"):null;return E.tidy(()=>{const{value:o,grads:a}=E.gradients(()=>t(r),[r],s);return s!=null&&at(o.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Rd(a),a[0]})}}function bM(t){return $(rs(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{$(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=Ki(e,"args","tf.grads","string_or_numeric"),s=n!=null?S(n,"dy","tf.grads"):null;return E.tidy(()=>{const{value:o,grads:a}=E.gradients(()=>t(...r),r,s);return s!=null&&at(o.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Rd(a),a})}}function SM(t){return $(rs(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{$(e instanceof _e,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),$(n==null||n instanceof _e,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:s}=E.gradients(()=>t(e),[e],n);return Rd(r),{grad:r[0],value:s}}}function CM(t){return $(rs(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{$(Array.isArray(e)&&e.every(s=>s instanceof _e),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),$(n==null||n instanceof _e,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=E.gradients(()=>t(...e),e,n);return n!=null&&at(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Rd(r.grads),r}}function uN(t,e){$(rs(t),()=>"The f passed in variableGrads(f) must be a function"),$(e==null||Array.isArray(e)&&e.every(u=>u instanceof Hi),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in E.registeredVariables)e.push(E.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),$(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:a,grads:i}=E.gradients(t,e,null,o);$(i.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),$(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((u,c)=>{i[c]!=null&&(l[u.name]=i[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:a,grads:l}}function Yn(t){return E.customGrad(t)}function Rd(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $M(t){const n={x:S(t,"x","softplus")};return E.runKernel(P0,n)}const Hx=N({softplus_:$M});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TM(t){const e=S(t,"x","logSigmoid");return Yn(r=>({value:Hn(Hx(Hn(r))),gradFunc:a=>W(a,Vs(Hn(r)))}))(e)}const cN=N({logSigmoid_:TM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kM(t,e){let n=S(t,"a","sub"),r=S(e,"b","sub");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(Q0,s)}const se=N({sub_:kM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NM(t,e=-1){const n=S(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Yn((s,o)=>{const i=Ms(s,e,!0),l=se(s,i),u=se(ke(l,"float32"),fa(ye(ss(l),e,!0)));return o([u]),{value:u,gradFunc:(d,p)=>{const[f]=p,h=!0,g=ss(f);return se(d,W(ye(d,e,h),g))}}})(n)}const dN=N({logSoftmax_:NM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EM(t,e=null,n=!1){const r=S(t,"x","logSumExp"),s=Ue(e,r.shape),o=Ms(r,s,!0),a=se(r,o),i=ss(a),l=ye(i,s),u=fa(l),c=ee(P(o,u.shape),u);if(n){const d=Xt(c.shape,s);return P(c,d)}return c}const Kx=N({logSumExp_:EM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IM(t,e){const n=S(t,"a","logicalAnd","bool"),r=S(e,"b","logicalAnd","bool");le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(By,s)}const Qi=N({logicalAnd_:IM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RM(t){const n={x:S(t,"x","logicalNot","bool")};return E.runKernel(Vy,n)}const qx=N({logicalNot_:RM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _M(t,e){const n=S(t,"a","logicalOr","bool"),r=S(e,"b","logicalOr","bool");le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(My,s)}const Xx=N({logicalOr_:_M});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(t,e){const n=S(t,"a","logicalXor","bool"),r=S(e,"b","logicalXor","bool");return le(n.shape,r.shape),Qi(Xx(t,e),qx(Qi(t,e)))}const pN=N({logicalXor_:AM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cu=2147483648;function OM(t,e,n="left"){const r=S(t,"sortedSequence","searchSorted"),s=S(e,"values","searchSorted"),o=r.shape[r.shape.length-1],a=s.shape[s.shape.length-1],i=P(r,[-1,o]),l=P(s,[-1,a]);if(i.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(i.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(M(l.shape)>=cu)throw new Error(`values tensor size must less than ${cu}`);if(i.shape[1]>=cu)throw new Error(`trailing dim_size must less than ${cu} for int32 output type, was ${i.shape[1]}`);const u={sortedSequence:i,values:l},c={side:n};return E.runKernel(N0,u,c)}const _d=N({searchSorted_:OM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fN(t,e){return _d(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DM(t,e,n,r,s){const o=S(t,"x","maxPool"),a=1;let i=o,l=!1;o.rank===3&&(l=!0,i=P(o,[1,o.shape[0],o.shape[1],o.shape[2]])),$(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),$(Vt(n,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),yn("maxPool",r,s);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=E.runKernel(Gy,u,c);return l?P(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Yx=N({maxPool_:DM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(t,e=[1,1,1],n,r,s,o="NDHWC"){const a=S(t,"x","maxPool3d");let i=a,l=!1;a.rank===4&&(l=!0,i=P(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),$(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),$(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),yn("maxPool3d",r,s);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o},d=E.runKernel(jy,u,c);return l?P(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const hN=N({maxPool3d_:PM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(t,e,n,r,s=!1){const a={x:S(t,"x","maxPoolWithArgmax")},i={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},l=E.runKernel(Hy,a,i);return{result:l[0],indexes:l[1]}}const mN=N({maxPoolWithArgmax_:FM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LM(t,e){let n=S(t,"a","maximum"),r=S(e,"b","maximum");[n,r]=Ae(n,r),n.dtype==="bool"&&(n=ke(n,"int32"),r=ke(r,"int32")),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(Wy,s)}const Qx=N({maximum_:LM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BM(t,e=null,n=!1){const s={x:S(t,"x","mean")},o={axis:e,keepDims:n};return E.runKernel(Ky,s,o)}const Zi=N({mean_:BM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function br(t,e="float32"){if(e==="complex64"){const r=br(t,"float32"),s=br(t,"float32");return wr(r,s)}const n=vr(M(t),e);return E.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ur(t,e="float32"){if(e==="complex64"){const r=Ur(t,"float32"),s=br(t,"float32");return wr(r,s)}const n=xg(M(t),e);return E.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gN(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=S(t,"x","meshgrid",t instanceof _e?t.dtype:"float32");if(e===void 0)return[r];let s=S(e,"y","meshgrid",e instanceof _e?e.dtype:"float32");const o=M(r.shape),a=M(s.shape);return n==="xy"?(r=P(r,[1,-1]),s=P(s,[-1,1]),[fe(Ur([a,1],r.dtype),r),fe(s,Ur([1,o],s.dtype))]):(r=P(r,[-1,1]),s=P(s,[1,-1]),[fe(r,Ur([1,a],r.dtype)),fe(Ur([o,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VM(t,e){let n=S(t,"a","minimum"),r=S(e,"b","minimum");[n,r]=Ae(n,r),n.dtype==="bool"&&(n=ke(n,"int32"),r=ke(r,"int32")),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(Xy,s)}const Zx=N({minimum_:VM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MM(t,e,n){$(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=S(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");$(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let i=0;i<r.rank;i++)$(e[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$(e[i][0]>=0&&e[i][0]<=r.shape[i]-s&&e[i][1]>=0&&e[i][1]<=r.shape[i]-s,()=>`Padding in dimension ${i} cannot be greater than or equal to ${r.shape[i]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:n},a={x:r};return E.runKernel(Yy,a,o)}const yN=N({mirrorPad_:MM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zM(t,e){let n=S(t,"a","mod"),r=S(e,"b","mod");[n,r]=Ae(n,r);const s={a:n,b:r};return E.runKernel(Qy,s)}const xN=N({mod_:zM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(t,e=null,n=!1){t=S(t,"x","moments");const r=Ue(e,t.shape),s=Zi(t,r,n);let o=s.shape;n||(o=Xt(s.shape,r));const a=hn(se(ke(t,"float32"),P(s,o))),i=Zi(a,r,n);return{mean:s,variance:i}}const vN=N({moments_:UM});function WM(t,e,n,r){const s=S(e,"data","multiRNNCell"),o=Ki(n,"c","multiRNNCell"),a=Ki(r,"h","multiRNNCell");let i=s;const l=[];for(let d=0;d<t.length;d++){const p=t[d](i,o[d],a[d]);l.push(p[0]),l.push(p[1]),i=p[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const wN=N({multiRNNCell_:WM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GM(t,e,n,r=!1){const s=S(t,"logits","multinomial"),o=s.size,a=s.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);n=n||Math.random();const l={logits:a===1?P(s,[1,-1]):s},u={numSamples:e,seed:n,normalized:r},c=E.runKernel(Zy,l,u);return a===1?P(c,[c.size]):c}const bN=N({multinomial_:GM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jM(t,e){let n=S(t,"a","notEqual","string_or_numeric"),r=S(e,"b","notEqual","string_or_numeric");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r};return E.runKernel(t0,s)}const Jx=N({notEqual_:jM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HM(t){const n={x:S(t,"x","onesLike")};return E.runKernel(o0,n)}const SN=N({onesLike_:HM});function KM(t,e){const n=S(t,"v1","outerProduct"),r=S(e,"v2","outerProduct");$(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=P(n,[-1,1]),o=P(r,[1,-1]);return fe(s,o)}const CN=N({outerProduct_:KM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qM(t,e,n=0){const r=S(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},o={x:r};return E.runKernel(l0,o,s)}const $a=N({pad_:qM});function XM(t,e,n=0){return $(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),$a(t,[e],n)}const $N=N({pad1d_:XM});function YM(t,e,n=0){return $(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t,e,n)}const TN=N({pad2d_:YM});function QM(t,e,n=0){return $(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t,e,n)}const kN=N({pad3d_:QM});function ZM(t,e,n=0){return $(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t,e,n)}const NN=N({pad4d_:ZM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(t,e,n){const r=S(t,"x","spaceToBatchND");$(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),$(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),$(r.shape.reduce((a,i,l)=>l>0&&l<=e.length?a&&(i+n[l-1][0]+n[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:n};return E.runKernel(B0,s,o)}const e1=N({spaceToBatchND_:JM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(t,e,n,r,s,o,a){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const i=S(t,"x","maxPool");let l=i,u=!1;i.rank===3&&(u=!0,l=P(i,[1,i.shape[0],i.shape[1],i.shape[2]])),$(Vt(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const c=co(l.shape,e,o,s,r),d=[c.dilationHeight,c.dilationWidth];let p;r==="same"?p=nz([c.filterHeight,c.filterWidth],d):p=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[h,g]=tz([c.inHeight,c.inWidth],d,p),y=f?r:"valid",m=f?l:e1(l,d,h),v=(n==="avg"?()=>Ox(m,e,o,y,a):()=>Yx(m,e,o,y,a))(),b=f?v:Dx(v,d,g);return u?P(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function tz(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),o=t.concat(r,s),a=e.map((c,d)=>(c-o[d]%c)%c),i=s.map((c,d)=>c+a[d]),l=e.map((c,d)=>[r[d],i[d]]),u=e.map((c,d)=>[0,a[d]]);return[l,u]}function nz(t,e){const r=t.map((a,i)=>a+(a-1)*(e[i]-1)).map(a=>a-1),s=r.map(a=>Math.floor(a/2)),o=r.map((a,i)=>a-s[i]);return r.map((a,i)=>[s[i],o[i]])}const EN=N({pool_:ez});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(t,e){const n=S(t,"x","prelu"),r=S(e,"alpha","prelu"),s={x:n,alpha:r};return E.runKernel(c0,s)}const t1=N({prelu_:rz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t,e=null,n=!1){let r=S(t,"x","prod");r.dtype==="bool"&&(r=ke(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return E.runKernel(d0,s,o)}const IN=N({prod_:sz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oz(t,e,n,r){const s=t.map((c,d)=>S(c,`tensors${d}`,"raggedGather","int32")),o=S(e,"paramsDenseValues","raggedGather"),a=S(n,"indices","raggedGather","int32"),i={paramsNestedSplits:s,paramsDenseValues:o,indices:a},l={outputRaggedRank:r},u=E.runKernel(p0,i,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const RN=N({raggedGather_:oz});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(t,e,n){const r=S(t,"starts","raggedRange"),s=S(e,"limits","raggedRange",r.dtype),o=S(n,"deltas","raggedRange",r.dtype),a={starts:r,limits:s,deltas:o},i=E.runKernel(f0,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}const _N=N({raggedRange_:az});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(t,e,n,r,s){const o=S(t,"shape","raggedTensorToTensor","int32"),a=S(e,"values","raggedTensorToTensor"),i=S(n,"defaultValue","raggedTensorToTensor",a.dtype),l=r.map((d,p)=>S(d,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:o,values:a,defaultValue:i,rowPartitionTensors:l},c={rowPartitionTypes:s};return E.runKernel(h0,u,c)}const AN=N({raggedTensorToTensor_:iz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(t,e,n){const r=M(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<r;o++)s[o]=e();return E.makeTensor(s,t,n)}const ON=N({rand_:lz});var DN={exports:{}};(function(t){(function(e,n,r){function s(l){var u=this,c=i();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var c=new s(l),d=u&&u.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&o(d,c),p.state=function(){return o(c,{})}),p}function i(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(no,t,!1)})(DN);var PN={exports:{}};(function(t){(function(e,n,r){function s(i){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},i===(i|0)?l.x=i:u+=i;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l}function a(i,l){var u=new s(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(no,t,!1)})(PN);var FN={exports:{}};(function(t){(function(e,n,r){function s(i){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,i===(i|0)?l.x=i:u+=i;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l.v=i.v,l.d=i.d,l}function a(i,l){var u=new s(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(no,t,!1)})(FN);var LN={exports:{}};(function(t){(function(e,n,r){function s(i){var l=this;l.next=function(){var c=l.x,d=l.i,p,f;return p=c[d],p^=p>>>7,f=p^p<<24,p=c[d+1&7],f^=p^p>>>10,p=c[d+3&7],f^=p^p>>>3,p=c[d+4&7],f^=p^p<<7,p=c[d+7&7],p=p^p<<13,f^=p^p<<9,c[d]=f,l.i=d+1&7,f};function u(c,d){var p,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,p=0;p<d.length;++p)f[p&7]=f[p&7]<<15^d.charCodeAt(p)+f[p+1&7]<<13;for(;f.length<8;)f.push(0);for(p=0;p<8&&f[p]===0;++p);for(p==8?f[7]=-1:f[p],c.x=f,c.i=0,p=256;p>0;--p)c.next()}u(l,i)}function o(i,l){return l.x=i.x.slice(),l.i=i.i,l}function a(i,l){i==null&&(i=+new Date);var u=new s(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(no,t,!1)})(LN);var BN={exports:{}};(function(t){(function(e,n,r){function s(i){var l=this;l.next=function(){var c=l.w,d=l.X,p=l.i,f,h;return l.w=c=c+1640531527|0,h=d[p+34&127],f=d[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,h=d[p]=h^f,l.i=p,h+(c^c>>>16)|0};function u(c,d){var p,f,h,g,y,m=[],x=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,x=Math.max(x,d.length)),h=0,g=-32;g<x;++g)d&&(f^=d.charCodeAt((g+32)%d.length)),g===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(y=y+1640531527|0,p=m[g&127]^=f+y,h=p==0?h+1:0);for(h>=128&&(m[(d&&d.length||0)&127]=-1),h=127,g=4*128;g>0;--g)f=m[h+34&127],p=m[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,m[h]=f^p;c.w=y,c.X=m,c.i=h}u(l,i)}function o(i,l){return l.i=i.i,l.w=i.w,l.X=i.X.slice(),l}function a(i,l){i==null&&(i=+new Date);var u=new s(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(no,t,!1)})(BN);var VN={exports:{}};(function(t){(function(e,n,r){function s(i){var l=this,u="";l.next=function(){var d=l.b,p=l.c,f=l.d,h=l.a;return d=d<<25^d>>>7^p,p=p-f|0,f=f<<24^f>>>8^h,h=h-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-f|0,l.d=f<<16^p>>>16^h,l.a=h-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,i===Math.floor(i)?(l.a=i/4294967296|0,l.b=i|0):u+=i;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(i,l){return l.a=i.a,l.b=i.b,l.c=i.c,l.d=i.d,l}function a(i,l){var u=new s(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,h=(p+f)/(1<<21);while(h===0);return h},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(no,t,!1)})(VN);var MN={exports:{}};const uz={},cz=Object.freeze(Object.defineProperty({__proto__:null,default:uz},Symbol.toStringTag,{value:"Module"})),dz=BR(cz);(function(t){(function(e,n,r){var s=256,o=6,a=52,i="random",l=r.pow(s,o),u=r.pow(2,a),c=u*2,d=s-1,p;function f(b,C,k){var I=[];C=C==!0?{entropy:!0}:C||{};var R=m(y(C.entropy?[b,v(n)]:b==null?x():b,3),I),D=new h(I),O=function(){for(var V=D.g(o),j=l,Z=0;V<u;)V=(V+Z)*s,j*=s,Z=D.g(1);for(;V>=c;)V/=2,j/=2,Z>>>=1;return(V+Z)/j};return O.int32=function(){return D.g(4)|0},O.quick=function(){return D.g(4)/4294967296},O.double=O,m(v(D.S),n),(C.pass||k||function(V,j,Z,J){return J&&(J.S&&g(J,D),V.state=function(){return g(D,{})}),Z?(r[i]=V,j):V})(O,R,"global"in C?C.global:this==r,C.state)}function h(b){var C,k=b.length,I=this,R=0,D=I.i=I.j=0,O=I.S=[];for(k||(b=[k++]);R<s;)O[R]=R++;for(R=0;R<s;R++)O[R]=O[D=d&D+b[R%k]+(C=O[R])],O[D]=C;(I.g=function(V){for(var j,Z=0,J=I.i,re=I.j,ne=I.S;V--;)j=ne[J=d&J+1],Z=Z*s+ne[d&(ne[J]=ne[re=d&re+j])+(ne[re]=j)];return I.i=J,I.j=re,Z})(s)}function g(b,C){return C.i=b.i,C.j=b.j,C.S=b.S.slice(),C}function y(b,C){var k=[],I=typeof b,R;if(C&&I=="object")for(R in b)try{k.push(y(b[R],C-1))}catch{}return k.length?k:I=="string"?b:b+"\0"}function m(b,C){for(var k=b+"",I,R=0;R<k.length;)C[d&R]=d&(I^=C[d&R]*19)+k.charCodeAt(R++);return v(C)}function x(){try{var b;return p&&(b=p.randomBytes)?b=b(s):(b=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(b)),v(b)}catch{var C=e.navigator,k=C&&C.plugins;return[+new Date,e,k,e.screen,v(n)]}}function v(b){return String.fromCharCode.apply(0,b)}if(m(r.random(),n),t.exports){t.exports=f;try{p=dz}catch{}}else r["seed"+i]=f})(typeof self<"u"?self:no,[],Math)})(MN);var pz=DN.exports,fz=PN.exports,hz=FN.exports,mz=LN.exports,gz=BN.exports,yz=VN.exports,po=MN.exports;po.alea=pz;po.xor128=fz;po.xorwow=hz;po.xorshift7=mz;po.xor4096=gz;po.tychei=yz;var n1=po;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r1{constructor(e,n,r,s,o){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=o||Math.random();this.random=n1.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,o,a;do s=2*this.random()-1,o=2*this.random()-1,a=s*s+o*o;while(a>=1||a===0);const i=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*s*i,n=this.mean+this.stdDev*o*i,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class xz{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const o=s||Math.random();this.randu=n1.alea(o.toString()),this.randn=new r1(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,o,a;for(;;){do s=this.randn.nextValue(),a=1+this.c*s;while(a<=0);if(a*=a*a,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-a+Math.log(a)),o=this.randu(),o<n||Math.log(o)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class vz{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=n1.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(t,e,n=1,r="float32",s){if(n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const o=new xz(e,n,r,s),a=Ee(t,r);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const zN=N({randomGamma_:wz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(t,e=0,n=1,r,s){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new r1(e,n,r,!1,s),a=Ee(t,r);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const s1=N({randomNormal_:bz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sz(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return s1(t,0,1,e,n)}const UN=N({randomStandardNormal_:Sz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cz(t,e=0,n=1,r="float32",s){const o=Ee(t,r),a=new vz(e,n,null,s);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const o1=N({randomUniform_:Cz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ha(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return E.runKernel(m0,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $z(t){const n={x:S(t,"x","reciprocal")};return E.runKernel(y0,n)}const WN=N({reciprocal_:$z});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tz(t){const n={x:S(t,"x","relu")};return E.runKernel(x0,n)}const Nl=N({relu_:Tz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kz(t){const n={x:S(t,"x","relu6")};return E.runKernel(S0,n)}const a1=N({relu6_:kz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(t,e){const r={x:S(t,"x","reverse")},s={dims:e};return E.runKernel(C0,r,s)}const os=N({reverse_:Nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(t){const e=S(t,"x","reverse");return $(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),os(e,0)}const GN=N({reverse1d_:Ez});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iz(t,e){const n=S(t,"x","reverse");return $(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),os(n,e)}const jN=N({reverse2d_:Iz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rz(t,e){const n=S(t,"x","reverse");return $(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),os(n,e)}const HN=N({reverse3d_:Rz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _z(t,e){const n=S(t,"x","reverse");return $(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),os(n,e)}const KN=N({reverse4d_:_z});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Az(t){const n={x:S(t,"x","round")};return E.runKernel($0,n)}const i1=N({round_:Az});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(t){const n={x:S(t,"x","rsqrt","float32")};return E.runKernel(T0,n)}const qN=N({rsqrt_:Oz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(t){const n={x:S(t,"x","selu")};return E.runKernel(I0,n)}const XN=N({selu_:Dz});function Pz(t,e,n,r,s,o=[1,1],a="NHWC"){const i=S(t,"x","separableConv2d"),l=S(e,"depthwiseFilter","separableConv2d"),u=S(n,"pointwiseFilter","separableConv2d");let c=i,d=!1;if(i.rank===3&&(d=!0,c=P(i,[1,i.shape[0],i.shape[1],i.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");$(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),$(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),$(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),$(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),$(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],f=l.shape[3];$(u.shape[2]===p*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${u.shape[2]}.`);const h=Ed(c,l,r,s,a,o),y=$l(h,u,1,"valid",a);return d?P(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const YN=N({separableConv2d_:Pz});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Fz(t,e){const n=S(t,"x","setdiff1d"),r=S(e,"y","setdiff1d");$(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),$(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),$(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),o=await r.data(),a=new Set(o);let i=0;for(let c=0;c<s.length;c++)a.has(s[c])||i++;const l=new ua([i],n.dtype),u=new ua([i],"int32");for(let c=0,d=0;c<s.length;c++)a.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const QN=Fz;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(t){const n={x:S(t,"x","sign")};return E.runKernel(O0,n)}const ZN=N({sign_:Lz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(t){const n={x:S(t,"x","sin","float32")};return E.runKernel(_0,n)}const JN=N({sin_:Bz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vz(t){const n={x:S(t,"x","sinh")};return E.runKernel(A0,n)}const eE=N({sinh_:Vz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(t,e,n){const r=S(t,"x","slice1d");return $(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),he(r,[e],[n])}const tE=N({slice1d_:Mz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(t,e,n){const r=S(t,"x","slice2d");return $(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),he(r,e,n)}const nE=N({slice2d_:zz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t,e,n){const r=S(t,"x","slice3d");return $(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),he(r,e,n)}const rE=N({slice3d_:Uz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(t,e,n){const r=S(t,"x","slice4d");return $(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),he(r,e,n)}const sE=N({slice4d_:Wz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(t,e=-1){const n=S(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return E.runKernel(M0,r,s)}const l1=N({softmax_:Gz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(t){$(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return E.runKernel(yy,e)}const Ad=N({fft_:jz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(t){$(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return E.runKernel(Ny,e)}const Ji=N({ifft_:Hz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=P(t,[n,e]);r=Ji(s)}else{const s=[n,2*(e-1)],o=P(da(t),[n,e]),a=P(wl(t),[n,e]),i=os(he(o,[0,1],[n,e-2]),1),l=W(os(he(a,[0,1],[n,e-2]),1),oe(-1)),u=st([o,i],1),c=st([a,l],1),d=P(wr(u,c),[s[0],s[1]]);r=Ji(d)}if(r=da(r),t.rank===3&&t.shape[0]!==0){const s=r,o=t.shape[0];r=P(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const u1=N({irfft_:Kz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qz(t,e,n=0){const s={x:S(t,"x","split")},o={numOrSizeSplits:e,axis:n};return E.runKernel(V0,s,o)}const ma=N({split_:qz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t,e){$(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const h=t.shape.map(y=>0),g=t.shape.map(y=>y);g[t.shape.length-1]=e,s=he(t,h,g),n=e}else if(e!=null&&e>n){const h=t.shape.map(g=>g);h[t.shape.length-1]=e-n,s=st([t,br(h)],t.shape.length-1),n=e}else s=t;const o=Pt(s),a=P(wr(s,o),[r,n]),i=Ad(a),l=Math.floor(n/2)+1,u=da(i),c=wl(i),d=ma(u,[l,n-l],u.shape.length-1),p=ma(c,[l,n-l],c.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,P(wr(d[0],p[0]),f)}const Od=N({rfft_:Xz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(t,e){let n=S(t,"a","squaredDifference"),r=S(e,"b","squaredDifference");[n,r]=Ae(n,r),le(n.shape,r.shape);const s={a:n,b:r},o={};return E.runKernel(H0,s,o)}const c1=N({squaredDifference_:Yz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(t,e){const n=S(t,"x","squeeze","string_or_numeric");return P(n,Cr(n.shape,e).newShape)}const El=N({squeeze_:Qz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(t,e=0){const n=Ki(t,"tensors","stack","string_or_numeric");$(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&$(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return E.runKernel(i0,r,s)}const Qn=N({stack_:Zz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(t,e=0){const r={x:S(t,"x","step")},s={alpha:e};return E.runKernel(ax,r,s)}const d1=N({step_:Jz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(t,e,n,r,s=0,o=0,a=0,i=0,l=0){const c={x:S(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};return E.runKernel(K0,c,d)}const oE=N({stridedSlice_:eU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t){const n={x:S(t,"x","tan","float32")};return E.runKernel(Z0,n)}const aE=N({tan_:tU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cn(t,e){io(t);const n=qn(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return us(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zo(t,e,n){if(io(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=qn(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return us(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iE(t,e,n){if(io(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=qn(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return us(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lE(t,e,n){if(io(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=qn(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return us(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uE(t,e,n){if(io(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=qn(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,us(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(t,e=1,n=!0){const r=S(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},a={k:e,sorted:n},[i,l]=E.runKernel(ex,o,a);return{values:i,indices:l}}const cE=N({topk_:nU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(t,e=0,n=1,r,s){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new r1(e,n,r,!0,s),a=Ee(t,r);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const dE=N({truncatedNormal_:rU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(t,e=0){const n=S(t,"x","unique","string_or_numeric");$(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[o,a]=E.runKernel(nx,r,s);return{values:o,indices:a}}const pE=N({unique_:sU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e,n){const r=S(t,"x","unsortedSegmentSum"),s=S(e,"segmentIds","unsortedSegmentSum","int32");$(Ks(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},a={numSegments:n};return E.runKernel(sx,o,a)}const fE=N({unsortedSegmentSum_:oU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(t,e=0){const n=S(t,"x","unstack","string_or_numeric");$(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return E.runKernel(rx,r,s)}const ds=N({unstack_:aU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hE(t,e){return _d(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mE(t,e=!0,n,r){return E.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=Ee(t,"int32"),s=Ee([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const a=r.indexToLoc(n[o]),i=o*t.length;s.values.set(a,i)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function iU(t){const e=S(t,"condition","whereAsync","bool"),n=await e.data(),r=p1(e.shape,n);return t!==e&&e.dispose(),r}const f1=iU;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function lU(t,e,n){const r=S(t,"tensor","boolMask"),s=S(e,"mask","boolMask","bool"),o=n==null?0:n,a=s.rank,i=r.shape;$(a>0,()=>"mask cannot be scalar"),at(i.slice(o,o+a),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=o;g<o+a;g++)l*=i[g];const u=i.slice(0,o).concat([l],i.slice(o+a)),c=P(r,u),d=P(s,[-1]),p=await f1(d),f=El(p,[1]),h=Ux(c,f,o);return t!==r&&r.dispose(),e!==s&&s.dispose(),f.dispose(),c.dispose(),d.dispose(),p.dispose(),h}const gE=lU;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e,n,r,s=!0){const o=S(t,"v","movingAverage"),a=S(e,"x","movingAverage"),i=S(n,"decay","movingAverage");kT(o,a),$(Ne(o.shape,a.shape),()=>"Shape mismatch in v and x");const l=oe(1),u=se(l,i);let c=W(se(a,o),u);if(s){$(r!=null,()=>"When using zeroDebias: true, step is required.");const d=S(r,"step","movingAverage");c=xe(c,se(l,pa(i,d)))}return ee(o,c)}const yE=N({movingAverage_:uU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(t,e,n){const r=S(t,"indices","scatterND","int32"),s=S(e,"updates","scatterND");kx(s,r,n);const o={indices:r,updates:s},a={shape:n};return E.runKernel(k0,o,a)}const xE=N({scatterND_:cU});function dU(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const a=e.size;if(!(e.rank===0||e.rank===1&&a===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(t,e,n,r=0){const s=S(t,"sparseIndices","sparseToDense","int32"),o=S(e,"sparseValues","sparseToDense","string_or_numeric"),a=S(r,"defaultValue","sparseToDense",o.dtype);dU(s,o,n,a);const i={sparseIndices:s,sparseValues:o,defaultValue:a},l={outputShape:n};return E.runKernel(j0,i,l)}const vE=N({sparseToDense_:pU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(t,e){const n=S(e,"indices","gatherND","int32"),s={params:S(t,"x","gatherND","string_or_numeric"),indices:n};return E.runKernel($y,s)}const wE=N({gatherND_:fU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hU(t,e){if(e==null)return t.shape.slice();if(Ne(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(t,e,n,r){const s=S(t,"x","dropout");if($(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),$(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof _e?s.clone():s;const o=hU(s,n),a=1-e,i=xe(zx(ee(o1(o,0,1,"float32",r),a)),a);return W(s,i)}const bE=N({dropout_:mU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Dd(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let o=0;o<t;++o){const a=2*Math.PI*o/(t+r-1);s[o]=e-n*Math.cos(a)}return cn(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gU(t,e,n=1){const r=S(t,"predictions","inTopK"),s=S(e,"targets","inTopK");$(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),$(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),at(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];$(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);const a=await r.data(),i=await s.data(),[l,u]=[a.length/o,o],c=Kn("bool",l);for(let d=0;d<l;d++){const p=d*u,f=a.subarray(p,p+u),h=[];for(let g=0;g<f.length;g++)h.push({value:f[g],index:g});h.sort((g,y)=>y.value-g.value),c[d]=0;for(let g=0;g<n;g++)if(h[g].index===i[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),_n(c,s.shape,"bool")}const SE=gU;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(t,e,n,r,s,o="NHWC",a){let i=t;t.rank===3&&(i=P(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=P(e,[1,e.shape[0],e.shape[1],e.shape[2]])),$(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),$(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),$(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?i.shape[3]:i.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];$(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),$(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),yn("conv2dDerFilter",s,a);const d={x:i,dy:l},p={strides:r,pad:s,dataFormat:o,dimRoundingMode:a,filterShape:n};return E.runKernel(Kg,d,p)}const xU=N({conv2DBackpropFilter_:yU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pd(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return W(t,d1(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Fd(t,e){let n=e;const r=Sx(t.shape,e.shape);return r.length>0&&(n=ye(n,r)),P(n,t.shape)}function Ld(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Nl(t);if(e==="elu")return Lx(t);if(e==="relu6")return a1(t);if(e==="prelu")return t1(t,n);if(e==="leakyrelu")return Gx(t,r);if(e==="sigmoid")return Vs(t);throw new Error(`Unknown fused activation ${e}.`)}const Bd=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",Bd(E.state.gradientDepth,l)===!1){$(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=$l(t,e,n,r,s,o,a);return i!=null&&(k=ee(k,i)),Ld(k,l,u,c)}const d=S(t,"x","conv2d","float32"),p=S(e,"filter","conv2d","float32");let f=d,h=!1;d.rank===3&&(h=!0,f=P(d,[1,d.shape[0],d.shape[1],d.shape[2]])),$(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),$(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),yn("fused conv2d",r,a);const g=s==="NHWC"?f.shape[3]:f.shape[1];$(p.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${p.shape[2]}.`),$(Vt(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=qt(f.shape,p.shape,n,o,r,a);let m;i!=null&&(m=S(i,"bias","fused conv2d"),[m]=Ae(m,d),s==="NHWC"?le(y.outShape,m.shape):($(m.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${m.shape.length}.`),$(m.shape.length===0||m.shape[0]===y.outChannels||m.shape[0]===1,()=>`Error in fused conv2d: bias shape (${m.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let x;if(u!=null){const k=u.shape;if($(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)$(k[0]===1||k[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${y.outChannels}).`);else if(k.length===3)try{le(k,y.outShape)}catch{const R=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(R)}x=S(u,"prelu weights","fused conv2d")}const v=(k,I)=>{$(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[R,D,O,V]=I,j=Pd(k,O,l);$(Yi(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const Z=Lk(D.shape,j,R,n,r),J=xU(D,j,R.shape,n,r),re=[Z,J];if(V!=null){const ne=Fd(V,j);re.push(ne)}return re},b={x:f,filter:p,bias:m,preluActivationWeights:x},C={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return i==null?Yn((I,R,D)=>{let O=E.runKernel(Ec,b,C);return D([R,I,O]),h&&(O=P(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:v}})(f,p):Yn((I,R,D,O)=>{let V=E.runKernel(Ec,b,C);return O([R,I,V,D]),h&&(V=P(V,[V.shape[1],V.shape[2],V.shape[3]])),{value:V,gradFunc:v}})(f,p,m)}const wU=N({fusedConv2d_:vU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t,e,n,r,s,o=[1,1],a){let i=t;t.rank===3&&(i=P(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=P(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:i,dy:l},c={strides:r,pad:s,dimRoundingMode:a,dilations:o,filterShape:n};return E.runKernel(oy,u,c)}const SU=N({depthwiseConv2dNativeBackpropFilter_:bU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t,e,n,r,s,o=[1,1],a){let i=e,l=!1;e.rank===3&&(l=!0,i=P(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:i,filter:n},c={strides:r,pad:s,dimRoundingMode:a,dilations:o,inputShape:t},d=E.runKernel(ay,u,c);return l?P(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const $U=N({depthwiseConv2dNativeBackpropInput_:CU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(Bd(E.state.gradientDepth,l)===!1){let C=Ed(t,e,n,r,s,o,a);return i!=null&&(C=ee(C,i)),Ld(C,l,u,c)}const d=S(t,"x","depthwiseConv2d","float32"),p=S(e,"filter","depthwiseConv2d","float32");let f=d,h=!1;d.rank===3&&(h=!0,f=P(d,[1,d.shape[0],d.shape[1],d.shape[2]])),$(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),$(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),$(f.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),o==null&&(o=[1,1]),$(Vt(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),yn("fused depthwiseConv2d",r,a);const g=qt(f.shape,p.shape,n,o,r,a,!0);let y;i!=null&&(y=S(i,"bias","fused conv2d"),[y]=Ae(y,d),le(g.outShape,y.shape));let m;u!=null&&(m=S(u,"prelu weights","fused depthwiseConv2d"));const x=(C,k)=>{$(Yi(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[I,R,D,O]=k,V=Pd(C,D,l),j=$U(R.shape,V,I,n,r,o,a),Z=SU(R,V,I.shape,n,r,o,a);if(O!=null){const J=Fd(y,V);return[j,Z,J]}return[j,Z]},v={x:f,filter:p,bias:y,preluActivationWeights:m},b={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return i==null?Yn((k,I,R)=>{let D=E.runKernel(Ic,v,b);return R([I,k,D]),h&&(D=P(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:x}})(f,p):Yn((k,I,R,D)=>{let O=E.runKernel(Ic,v,b);return D([I,k,O,R]),h&&(O=P(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:x}})(f,p,y)}const kU=N({fusedDepthwiseConv2d_:TU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:i=.2}){if(Bd(E.state.gradientDepth,o)===!1){let V=fe(t,e,n,r);return s!=null&&(V=ee(V,s)),Ld(V,o,a,i)}let l=S(t,"a","fused matMul"),u=S(e,"b","fused matMul");[l,u]=Ae(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],h=l.shape.slice(0,-2),g=u.shape.slice(0,-2),y=M(h),m=M(g);$(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const v=le(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,f]),b=n?P(l,[y,c,p]):P(l,[y,p,c]),C=r?P(u,[m,f,d]):P(u,[m,d,f]);let k;s!=null&&(k=S(s,"bias","fused matMul"),[k]=Ae(k,l),le(v,k.shape));let I;a!=null&&(I=S(a,"prelu weights","fused matMul"));const R=(V,j)=>{const[Z,J,re,ne]=j,ce=Pd(P(V,re.shape),re,o);let L,Y;if(!n&&!r?(L=fe(ce,J,!1,!0),Y=fe(Z,ce,!0,!1)):!n&&r?(L=fe(ce,J,!1,!1),Y=fe(ce,Z,!0,!1)):n&&!r?(L=fe(J,ce,!1,!0),Y=fe(Z,ce,!1,!1)):(L=fe(J,ce,!0,!0),Y=fe(ce,Z,!0,!0)),s!=null){const z=Fd(ne,ce);return[L,Y,z]}else return[L,Y]},D={a:b,b:C,bias:k,preluActivationWeights:I},O={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:i};return s==null?Yn((j,Z,J)=>{const re=E.runKernel(Nc,D,O);return J([j,Z,re]),{value:P(re,v),gradFunc:R}})(b,C):Yn((j,Z,J,re)=>{const ne=E.runKernel(Nc,D,O);return re([j,Z,ne,J]),{value:P(ne,v),gradFunc:R}})(b,C,k)}const EU=N({fusedMatMul_:NU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CE=Object.freeze(Object.defineProperty({__proto__:null,conv2d:wU,depthwiseConv2d:kU,matMul:EU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t){return Dd(t,.54,.46)}const RU=N({hammingWindow_:IU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(t){return Dd(t,.5,.5)}const $E=N({hannWindow_:_U});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(t,e,n,r=!1,s=0){let o=0;const a=[];for(;o+e<=t.size;)a.push(he(t,o,e)),o+=n;if(r)for(;o<t.size;){const i=o+e-t.size,l=st([he(t,o,e-i),Ca([i],s)]);a.push(l),o+=n}return a.length===0?Zo([],[0,e]):P(st(a),[a.length,e])}const TE=N({frame_:AU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OU(t,e,n,r,s=$E){r==null&&(r=h1(e));const o=TE(t,e,n),a=W(o,s(e));return Od(a,r)}const DU=N({stft_:OU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(t,e,n,r,s="bilinear",o=0){const a=S(t,"image","cropAndResize"),i=S(e,"boxes","cropAndResize","float32"),l=S(n,"boxInd","cropAndResize","int32"),u=i.shape[0];$(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),$(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${i.shape}.`),$(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${i.shape}.`),$(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),$(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),$(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:a,boxes:i,boxInd:l},d={method:s,extrapolationValue:o,cropSize:r};return E.runKernel(ty,c,d)}const FU=N({cropAndResize_:PU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(t){const e=S(t,"image","flipLeftRight","float32");$(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return E.runKernel(vy,n,{})}const BU=N({flipLeftRight_:LU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t){const e=S(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];$(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),$(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Qo(e,s)}const MU=N({grayscaleToRGB_:VU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(t,e,n=0,r=.5){const s=S(t,"image","rotateWithOffset","float32");$(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},a={radians:e,fillValue:n,center:r};return E.runKernel(ix,o,a)}const UU=N({rotateWithOffset_:zU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ta(t,e,n,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const a=t.shape[0];return n=Math.min(n,a),$(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),$(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),$(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),$(e.rank===1,()=>"scores must be a 1D tensor"),$(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),$(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WU(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=S(t,"boxes","nonMaxSuppression","float32"),a=S(e,"scores","nonMaxSuppression","float32"),i=Ta(o,a,n,r,s);n=i.maxOutputSize,r=i.iouThreshold,s=i.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return E.runKernel(n0,{boxes:o,scores:a},l)}const GU=N({nonMaxSuppression_:WU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(t,e,n){const r=HU(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function HU(t,e,n){return qU(t,e,n||KU)}function KU(t,e){return t>e?1:t<e?-1:0}function qU(t,e,n){let r=0,s=t.length,o=0,a=!1;for(;r<s;){o=r+(s-r>>>1);const i=n(e,t[o]);i>0?r=o+1:(s=o,a=!i)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1(t,e,n,r,s){return x1(t,e,n,r,s,0)}function g1(t,e,n,r,s,o){return x1(t,e,n,r,s,0,!1,o,!0)}function y1(t,e,n,r,s,o){return x1(t,e,n,r,s,o,!0)}function x1(t,e,n,r,s,o,a=!1,i=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>s&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(cb);const c=o>0?-.5/o:0,d=[],p=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:m,boxIndex:x,suppressBeginIndex:v}=y;if(m<s)break;let b=!1;for(let C=d.length-1;C>=v;--C){const k=XU(t,x,d[C]);if(k>=r){b=!0;break}if(y.score=y.score*YU(r,c,k),y.score<=s)break}y.suppressBeginIndex=d.length,b||(y.score===m?(d.push(x),p.push(y.score)):y.score>s&&jU(u,y,cb))}const f=d.length,h=n-f;i&&h>0&&(d.push(...new Array(h).fill(0)),p.push(...new Array(h).fill(0)));const g={selectedIndices:d};return a&&(g.selectedScores=p),l&&(g.validOutputs=f),g}function XU(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),i=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),p=Math.max(s[1],s[3]),f=(i-o)*(l-a),h=(d-u)*(p-c);if(f<=0||h<=0)return 0;const g=Math.max(o,u),y=Math.max(a,c),m=Math.min(i,d),x=Math.min(l,p),v=Math.max(m-g,0)*Math.max(x-y,0);return v/(f+h-v)}function YU(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function cb(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function QU(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=S(t,"boxes","nonMaxSuppressionAsync"),a=S(e,"scores","nonMaxSuppressionAsync"),i=Ta(o,a,n,r,s);n=i.maxOutputSize,r=i.iouThreshold,s=i.scoreThreshold;const l=await Promise.all([o.data(),a.data()]),u=l[0],c=l[1],{selectedIndices:d}=m1(u,c,n,r,s);return o!==t&&o.dispose(),a!==e&&a.dispose(),cn(d,"int32")}const ZU=QU;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const a=S(t,"boxes","nonMaxSuppression"),i=S(e,"scores","nonMaxSuppression"),l=Ta(a,i,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:a,scores:i},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},d=E.runKernel(s0,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const eW=N({nonMaxSuppressionWithScore_:JU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function tW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const a=S(t,"boxes","nonMaxSuppressionAsync"),i=S(e,"scores","nonMaxSuppressionAsync"),l=Ta(a,i,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([a.data(),i.data()]),c=u[0],d=u[1],{selectedIndices:p,selectedScores:f}=y1(c,d,n,r,s,o);return a!==t&&a.dispose(),i!==e&&i.dispose(),{selectedIndices:cn(p,"int32"),selectedScores:cn(f)}}const nW=tW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const a=S(t,"boxes","nonMaxSuppression"),i=S(e,"scores","nonMaxSuppression"),l=Ta(a,i,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,p={boxes:a,scores:i},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},h=E.runKernel(r0,p,f);return{selectedIndices:h[0],validOutputs:h[1]}}const sW=N({nonMaxSuppressionPadded_:rW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oW(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const a=S(t,"boxes","nonMaxSuppressionAsync"),i=S(e,"scores","nonMaxSuppressionAsync"),l=Ta(a,i,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[p,f]=await Promise.all([a.data(),i.data()]),{selectedIndices:h,validOutputs:g}=g1(p,f,u,c,d,o);return a!==t&&a.dispose(),i!==e&&i.dispose(),{selectedIndices:cn(h,"int32"),validOutputs:oe(g,"int32")}}const aW=oW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iW(t,e,n=!1,r=!1){const s=S(t,"images","resizeBilinear");$(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),$(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),$(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,a=!1;s.rank===3&&(a=!0,o=P(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=E.runKernel(b0,i,l);return a?P(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const lW=N({resizeBilinear_:iW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(t,e,n=!1,r=!1){const s=S(t,"images","resizeNearestNeighbor");$(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),$(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),$(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),$(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,a=!1;s.rank===3&&(a=!0,o=P(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const i={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=E.runKernel(w0,i,l);return a?P(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const cW=N({resizeNearestNeighbor_:uW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dW(t,e="binary",n=!1,r=.5){const s=S(t,"image","threshold"),o=.2989,a=.587,i=.114,l=s.shape[0]*s.shape[1];let u=W(cn([r]),255),c,d,p,f;if($(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),$(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),$(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),$(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,p]=ma(s,[1,1,1],-1);const y=W(c,o),m=W(d,a),x=W(p,i);f=ee(ee(y,m),x)}else f=t;if(e==="otsu"){const y=Px(ke(i1(f),"int32"),_n([]),256);u=pW(y,l)}const h=n?Id(f,u):kl(f,u);return ke(W(h,255),"int32")}function pW(t,e){let n=cn([-1]),r=cn([0]),s=cn([0]),o,a,i,l,u,c;for(let d=0;d<t.size-1;d++){o=he(t,0,d+1),a=he(t,d+1),u=xe(ye(o),e),c=xe(ye(a),e);const p=ye(W(o,ha(0,o.size)));i=xe(p,ye(o));const f=Ca(a.shape,o.size),h=ee(ha(0,a.size),f),g=W(a,h);l=xe(ye(g),ye(a));const y=se(i,l),m=se(i,l),x=W(u,c);s=W(W(x,y),m);const v=kl(s,r);r=Js(v,s,r),n=Js(v,cn([d]),n)}return n}const fW=N({threshold_:dW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hW(t,e,n="nearest",r="constant",s=0,o){const a=S(t,"image","transform","float32"),i=S(e,"transforms","transform","float32");$(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),$(i.rank===2&&(i.shape[0]===a.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),$(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:a,transforms:i},u={interpolation:n,fillMode:r,fillValue:s,outputShape:o};return E.runKernel(tx,l,u)}const mW=N({transform_:hW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e,n){$(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),$(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=S(t,"a","bandPart");$(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,a]=r.shape.slice(-2);if(!(e<=o))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`);if(!(n<=a))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`);e<0&&(e=o),n<0&&(n=a);const i=P(ha(0,o,1,"int32"),[-1,1]),l=ha(0,a,1,"int32"),u=se(i,l),c=Qi(Id(u,oe(+e,"int32")),Wx(u,oe(-n,"int32"))),d=br([o,a],r.dtype);return P(Qn(ds(P(r,[-1,o,a])).map(p=>Js(c,p,d))),s)}const yW=N({bandPart_:gW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t){let e;if(Array.isArray(t)){e=!1,$(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let o=1;o<t.length;++o)$(t[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${s})`)}else e=!0,t=ma(t,t.shape[0],0).map(s=>El(s,[0]));$(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(E.tidy(()=>{let o=r[s];if(s>0)for(let a=0;a<s;++a){const i=W(ye(W(n[a],o)),n[a]);o=se(o,i)}return xe(o,Tl(o,"euclidean"))}));return e?Qn(n,0):n}const vW=N({gramSchmidt_:xW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(t,e=!1){if($(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return db(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=ds(P(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],o=[];r.forEach(l=>{const[u,c]=db(l,e);s.push(u),o.push(c)});const a=P(Qn(s,0),t.shape),i=P(Qn(o,0),t.shape);return[a,i]}}function db(t,e=!1){return E.tidy(()=>{$(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=Mx(n),o=pr(t);const a=Zo([[1]],[1,1]);let i=pr(a);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=o,d=i,p=s;[i,o,s]=E.tidy(()=>{const f=he(o,[u,u],[n-u,1]),h=Tl(f),g=he(o,[u,u],[1,1]),y=Js(kl(g,0),Zo([[-1]]),Zo([[1]])),m=se(g,W(y,h)),x=xe(f,m);x.shape[0]===1?i=pr(a):i=st([a,he(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const v=Hn(xe(fe(y,m),h)),b=he(o,[u,0],[n-u,r]),C=W(v,i),k=qi(i);if(u===0)o=se(b,fe(C,fe(k,b)));else{const D=se(b,fe(C,fe(k,b)));o=st([he(o,[0,0],[u,r]),D],0)}const I=qi(C),R=he(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=se(R,fe(fe(R,i),I));else{const D=se(R,fe(fe(R,i),I));s=st([he(s,[0,0],[n,u]),D],1)}return[i,o,s]}),gt([c,d,p])}return!e&&n>r&&(s=he(s,[0,0],[n,r]),o=he(o,[0,0],[r,r])),[s,o]})}const bW=N({qr_:wW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ft;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ft||(ft={}));function SW(t,e,n=ft.SUM_BY_NONZERO_WEIGHTS){const r=S(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=S(e,"weights","computeWeightedLoss"));const o=s==null?r:W(r,s);if(n===ft.NONE)return o;if(n===ft.SUM)return ye(o);if(n===ft.MEAN){if(s==null)return Zi(o);{const a=r.size/s.size,i=xe(ye(o),ye(s));return a>1?xe(i,oe(a)):i}}if(n===ft.SUM_BY_NONZERO_WEIGHTS){if(s==null)return xe(ye(o),oe(r.size));{const a=W(s,Ur(r.shape)),i=ke(ye(Jx(a,oe(0))),"float32");return xe(ye(o),i)}}throw Error(`Unknown reduction: ${n}`)}const $r=N({computeWeightedLoss_:SW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(t,e,n,r=ft.SUM_BY_NONZERO_WEIGHTS){const s=S(t,"labels","absoluteDifference"),o=S(e,"predictions","absoluteDifference");let a=null;n!=null&&(a=S(n,"weights","absoluteDifference")),at(s.shape,o.shape,"Error in absoluteDifference: ");const i=Et(se(s,o));return $r(i,a,r)}const $W=N({absoluteDifference_:CW});function TW(t,e,n,r,s=ft.SUM_BY_NONZERO_WEIGHTS){const o=S(t,"labels","cosineDistance"),a=S(e,"predictions","cosineDistance");let i=null;r!=null&&(i=S(r,"weights","cosineDistance")),at(o.shape,a.shape,"Error in cosineDistance: ");const l=oe(1),u=se(l,ye(W(o,a),n,!0));return $r(u,i,s)}const kW=N({cosineDistance_:TW});function NW(t,e,n,r=ft.SUM_BY_NONZERO_WEIGHTS){let s=S(t,"labels","hingeLoss");const o=S(e,"predictions","hingeLoss");let a=null;n!=null&&(a=S(n,"weights","hingeLoss")),at(s.shape,o.shape,"Error in hingeLoss: ");const i=oe(1);s=se(W(oe(2),s),i);const l=Nl(se(i,W(s,o)));return $r(l,a,r)}const EW=N({hingeLoss_:NW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t,e,n,r=1,s=ft.SUM_BY_NONZERO_WEIGHTS){const o=S(t,"labels","huberLoss"),a=S(e,"predictions","huberLoss");let i=null;n!=null&&(i=S(n,"weights","huberLoss")),at(o.shape,a.shape,"Error in huberLoss: ");const l=oe(r),u=Et(se(a,o)),c=Zx(u,l),d=se(u,c),p=ee(W(oe(.5),hn(c)),W(l,d));return $r(p,i,s)}const RW=N({huberLoss_:IW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t,e,n,r=1e-7,s=ft.SUM_BY_NONZERO_WEIGHTS){const o=S(t,"labels","logLoss"),a=S(e,"predictions","logLoss");let i=null;n!=null&&(i=S(n,"weights","logLoss")),at(o.shape,a.shape,"Error in logLoss: ");const l=oe(1),u=oe(r),c=Hn(W(o,fa(ee(a,u)))),d=W(se(l,o),fa(ee(se(l,a),u))),p=se(c,d);return $r(p,i,s)}const AW=N({logLoss_:_W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(t,e,n,r=ft.SUM_BY_NONZERO_WEIGHTS){const s=S(t,"labels","meanSquaredError"),o=S(e,"predictions","meanSquaredError");let a=null;n!=null&&(a=S(n,"weights","meanSquaredError")),at(s.shape,o.shape,"Error in meanSquaredError: ");const i=c1(s,o);return $r(i,a,r)}const DW=N({meanSquaredError_:OW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(t,e){const n=S(t,"labels","sigmoidCrossEntropyWithLogits"),r=S(e,"logits","sigmoidCrossEntropyWithLogits");at(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Nl(r),o=W(r,n),a=jx(ss(Hn(Et(r))));return ee(se(s,o),a)}function FW(t,e,n,r=0,s=ft.SUM_BY_NONZERO_WEIGHTS){let o=S(t,"multiClassLabels","sigmoidCrossEntropy");const a=S(e,"logits","sigmoidCrossEntropy");let i=null;if(n!=null&&(i=S(n,"weights","sigmoidCrossEntropy")),at(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=oe(r),c=oe(1),d=oe(.5);o=ee(W(o,se(c,u)),W(d,u))}const l=PW(o,a);return $r(l,i,s)}const LW=N({sigmoidCrossEntropy_:FW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Yn((s,o,a)=>{const l=Kx(o,[n],!0),u=se(ke(o,"float32"),l);a([s,u]);const c=Hn(W(u,s));return{value:ye(c,[n]),gradFunc:(f,h)=>{const[g,y]=h,m=Xt(f.shape,[n]);return[W(P(f,m),se(ke(g,"float32"),ss(y))),W(P(f,m),se(ss(y),ke(g,"float32")))]}}})(t,e)}function VW(t,e,n,r=0,s=ft.SUM_BY_NONZERO_WEIGHTS){let o=S(t,"onehotLabels","softmaxCrossEntropy");const a=S(e,"logits","softmaxCrossEntropy");let i=null;if(n!=null&&(i=S(n,"weights","softmaxCrossEntropy")),at(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const u=oe(r),c=oe(1),d=oe(o.shape[1]);o=ee(W(o,se(c,u)),xe(u,d))}const l=BW(o,a);return $r(l,i,s)}const MW=N({softmaxCrossEntropy_:VW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t,e,n,r){const s=S(t,"indices","sparseFillEmptyRows","int32"),o=S(e,"values","sparseFillEmptyRows"),a=S(n,"denseShape","sparseFillEmptyRows","int32"),i=S(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const l={indices:s,values:o,denseShape:a,defaultValue:i},u=E.runKernel(z0,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const UW=N({sparseFillEmptyRows_:zW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(t,e,n){const r=S(t,"inputIndices","sparseReshape","int32"),s=S(e,"inputShape","sparseReshape","int32"),o=S(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const a={inputIndices:r,inputShape:s,newShape:o},i=E.runKernel(U0,a);return{outputIndices:i[0],outputShape:i[1]}}const GW=N({sparseReshape_:WW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(t,e,n){const r=S(t,"data","sparseSegmentMean"),s=S(e,"indices","sparseSegmentMean","int32"),o=S(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const a={data:r,indices:s,segmentIds:o};return E.runKernel(W0,a)}const HW=N({sparseSegmentMean_:jW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t,e,n){const r=S(t,"data","sparseSegmentSum"),s=S(e,"indices","sparseSegmentSum","int32"),o=S(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const a={data:r,indices:s,segmentIds:o};return E.runKernel(G0,a)}const qW=N({sparseSegmentSum_:KW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t,e,n,r,s,o,a,i){const l=S(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=S(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:o,padWidth:a,preserveShortSequences:i},d={data:l,dataSplits:u},p=E.runKernel(q0,d,c);return{nGrams:p[0],nGramsSplits:p[1]}}const YW=N({stringNGrams_:XW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(t,e,n=!0){const r=S(t,"input","stringSplit","string"),s=S(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:n},a={input:r,delimiter:s},i=E.runKernel(X0,a,o);return{indices:i[0],values:i[1],shape:i[2]}}const ZW=N({stringSplit_:QW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(t,e){const n=S(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return E.runKernel(Y0,s,r)}const e6=N({stringToHashBucketFast_:JW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kE={fft:Ad,ifft:Ji,rfft:Od,irfft:u1},NE={hammingWindow:RU,hannWindow:$E,frame:TE,stft:DU},v1={flipLeftRight:BU,grayscaleToRGB:MU,resizeNearestNeighbor:cW,resizeBilinear:lW,rotateWithOffset:UU,cropAndResize:FU,nonMaxSuppression:GU,nonMaxSuppressionAsync:ZU,nonMaxSuppressionWithScore:eW,nonMaxSuppressionWithScoreAsync:nW,nonMaxSuppressionPadded:sW,nonMaxSuppressionPaddedAsync:aW,threshold:fW,transform:mW},EE={bandPart:yW,gramSchmidt:vW,qr:bW},IE={absoluteDifference:$W,computeWeightedLoss:$r,cosineDistance:kW,hingeLoss:EW,huberLoss:RW,logLoss:AW,meanSquaredError:DW,sigmoidCrossEntropy:LW,softmaxCrossEntropy:MW},RE={sparseFillEmptyRows:UW,sparseReshape:GW,sparseSegmentMean:HW,sparseSegmentSum:qW},_E={stringNGrams:YW,stringSplit:ZW,stringToHashBucketFast:e6};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ps extends lk{minimize(e,n=!1,r){const{value:s,grads:o}=this.computeGradients(e,r);if(r!=null){const a=r.map(i=>({name:i.name,tensor:o[i.name]}));this.applyGradients(a)}else this.applyGradients(o);return gt(o),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return uN(e,n)}dispose(){this.iterations_!=null&&gt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:oe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ps,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vd extends ps{constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=E.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=E.registeredVariables[r],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:ie(()=>Pt(o).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:ie(()=>Pt(o).variable(a))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;ie(()=>{const c=ee(W(l,this.rho),W(hn(i),1-this.rho)),d=W(xe(Xn(ee(u,this.epsilon)),Xn(ee(l,this.epsilon))),i),p=ee(W(u,this.rho),W(hn(d),1-this.rho));l.assign(c),u.assign(p);const f=ee(W(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(gt(this.accumulatedGrads.map(e=>e.variable)),gt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}Vd.className="Adadelta";cs(Vd);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Md extends ps{constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=E.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:ie(()=>Ca(o.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const i=this.accumulatedGrads[s].variable;ie(()=>{const l=ee(i,hn(a));i.assign(l);const u=ee(W(xe(a,Xn(ee(l,E.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&gt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}Md.className="Adagrad";cs(Md);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zd extends ps{constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ie(()=>{this.accBeta1=oe(n).variable(),this.accBeta2=oe(r).variable()}),s==null&&(this.epsilon=E.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ie(()=>{const r=se(1,this.accBeta1),s=se(1,this.accBeta2);n.forEach((o,a)=>{const i=E.registeredVariables[o],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:ie(()=>Pt(i).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${o}/v`,variable:ie(()=>Pt(i).variable(l))});const u=Array.isArray(e)?e[a].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[a].variable,d=this.accumulatedSecondMoment[a].variable,p=ee(W(c,this.beta1),W(u,1-this.beta1)),f=ee(W(d,this.beta2),W(hn(u),1-this.beta2)),h=xe(p,r),g=xe(f,s);c.assign(p),d.assign(f);const y=ee(W(xe(h,ee(Xn(g),this.epsilon)),-this.learningRate),i);i.assign(y)}),this.accBeta1.assign(W(this.accBeta1,this.beta1)),this.accBeta2.assign(W(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&gt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&gt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),ie(()=>{this.accBeta1.assign(pa(this.beta1,this.iterations_+1)),this.accBeta2.assign(pa(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}zd.className="Adam";cs(zd);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ud extends ps{constructor(e,n,r,s=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ie(()=>{this.iteration=oe(0).variable(),this.accBeta1=oe(n).variable()}),s==null&&(this.epsilon=E.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ie(()=>{const r=se(1,this.accBeta1),s=xe(-this.learningRate,ee(W(this.iteration,this.decay),1));n.forEach((o,a)=>{const i=E.registeredVariables[o],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:Pt(i).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${o}/v`,variable:Pt(i).variable(l)});const u=Array.isArray(e)?e[a].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[a].variable,d=this.accumulatedWeightedInfNorm[a].variable,p=ee(W(c,this.beta1),W(u,1-this.beta1)),f=W(d,this.beta2),h=Et(u),g=Qx(f,h);c.assign(p),d.assign(g);const y=ee(W(xe(s,r),xe(p,ee(g,this.epsilon))),i);i.assign(y)}),this.iteration.assign(ee(this.iteration,1)),this.accBeta1.assign(W(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&gt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&gt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}Ud.className="Adamax";cs(Ud);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Il extends ps{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=E.registeredVariables[r];ie(()=>{const i=ee(W(this.c,o),a);a.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Un(oe(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}Il.className="SGD";cs(Il);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wd extends Il{constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=oe(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=E.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:ie(()=>Pt(o).variable(!1))});const a=this.accumulations[s].variable,i=Array.isArray(e)?e[s].tensor:e[r];i!=null&&ie(()=>{let l;const u=ee(W(this.m,a),i);this.useNesterov?l=ee(W(this.c,ee(i,W(u,this.m))),o):l=ee(W(this.c,u),o),a.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&gt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}Wd.className="Momentum";cs(Wd);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gd extends ps{constructor(e,n=.9,r=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=E.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=E.registeredVariables[r],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:ie(()=>Pt(o).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:ie(()=>Pt(o).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:ie(()=>Pt(o).variable(a))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;ie(()=>{const c=ee(W(l,this.decay),W(hn(i),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,p=ee(W(d,this.decay),W(i,1-this.decay)),f=xe(W(i,this.learningRate),Xn(se(c,ee(hn(p),this.epsilon)))),h=ee(W(u,this.momentum),f);l.assign(c),d.assign(p),u.assign(h);const g=se(o,h);o.assign(g)}else{const d=ee(W(l,this.decay),W(hn(i),1-this.decay)),p=ee(W(u,this.momentum),xe(W(i,this.learningRate),Xn(ee(d,this.epsilon))));l.assign(d),u.assign(p);const f=se(o,p);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&gt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&gt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&gt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}Gd.className="RMSProp";cs(Gd);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ir{static sgd(e){return new Il(e)}static momentum(e,n,r=!1){return new Wd(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,o=!1){return new Gd(e,n,r,s,o)}static adam(e=.001,n=.9,r=.999,s=null){return new zd(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new Vd(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,o=0){return new Ud(e,n,r,s,o)}static adagrad(e,n=.1){return new Md(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6={sgd:Ir.sgd,momentum:Ir.momentum,adadelta:Ir.adadelta,adagrad:Ir.adagrad,rmsprop:Ir.rmsprop,adamax:Ir.adamax,adam:Ir.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n6=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function AE(){return new Promise(t=>n6(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OE(t,e){const n=t[0].length;t.forEach((s,o)=>{$(s.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),$(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,o)=>{for(let a=0;a<n;a++)$(a===e||s[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function eo(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Nn;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Nn||(Nn={}));function DE(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const o=n[s],a=r[r.length-n.length+s],i=r[a];if(o>=0)if(i>=0){if(i!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${o} but shape[${s+t}] = ${i}`)}else r[a]=o}return r}function PE(t){const e={FIRST_DIM_SIZE:Nn.FIRST_DIM_SIZE,VALUE_ROWIDS:Nn.VALUE_ROWIDS,ROW_LENGTHS:Nn.ROW_LENGTHS,ROW_SPLITS:Nn.ROW_SPLITS,ROW_LIMITS:Nn.ROW_LIMITS,ROW_STARTS:Nn.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function FE(t){return t.length===0?0:t[0]===Nn.FIRST_DIM_SIZE?t.length-1:t.length}function LE(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const o=t[s],a=e[s+1];if(o>=0&&a>=0&&o!==1&&o!==a)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${o} but ragged tensor input.flatValues.shape[${s-t.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1=30;function jd(t){return t<=w1?t:$c(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BE(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const o=e.length;for(let a=0;a<o;++a)s=s.concat([t[a+1]/e[a],e[a]]);s=s.concat(t.slice(o+1))}return s}function S1(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let a=1;a<t;++a)a>=e*2+1||a%2===1?o.push(a):s.push(a);r.push(...s),r.push(0),r.push(...o)}return r}function C1(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?s.push(e[o-1]*t[o]):s.push(t[o]/e[o-1]):s.push(t[o]);return s}function VE(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function ME(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zE=1.7580993408473768,UE=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WE=.3275911,GE=.254829592,jE=-.284496736,HE=1.421413741,KE=-1.453152027,qE=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function r6(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function s6(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function o6(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function a6(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function i6(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function l6(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const o=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:n,imag:r}}function u6(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Up="->",c6=/->/g,pb=",",fb="...";function XE(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(c6,"").length)/Up.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Up}").`);const[r,s]=t.split(Up);$(r.indexOf(fb)===-1,()=>`The ellipsis notation ("${fb}") is not supported yet.`);const o=r.split(pb),a=o.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let p=0;p<s.length;++p){const f=s[p];if(!o.some(h=>h.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);i.indexOf(f)===-1&&i.push(f)}for(let p=0;p<r.length;++p){const f=r[p];i.indexOf(f)===-1&&f!==pb&&i.push(f)}const l=new Array(o.length);for(let p=0;p<a;++p){if(new Set(o[p].split("")).size!==o[p].length)throw new Error(`Found duplicate axes in input component ${o[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let f=0;f<o[p].length;++f)l[p].push(i.indexOf(o[p][f]))}const u=i.length,c=s.length,d=[];for(let p=c;p<u;++p)d.push(p);return{allDims:i,summedDims:d,idDims:l}}function YE(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function QE(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const o=n[s].shape;for(let a=0;a<e[s].length;++a)r[e[s][a]]===void 0?r[e[s][a]]=o[a]:$(r[e[s][a]]===o[a],()=>`Expected dimension ${r[e[s][a]]} at axis ${a} of input shaped ${JSON.stringify(o)}, but got dimension ${o[a]}`)}}function ZE(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let a=0;a<s;++a)r.push([]);const o=[];for(let a=0;a<n.length;++a){const i=n[a],l=d6(e,i);for(const u of l)o.indexOf(u)===-1&&(r[a].push(u),o.push(u))}return{path:n,steps:r}}function JE(t){return t.every((e,n)=>e===n)}function d6(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function eI(t,e,n=0){let r=[];if(typeof e=="number")$(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((a,i)=>(i===-1&&(a+=1),a),0);$(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const a=e.reduce((i,l)=>l>0?i+l:i);e[o]=t.shape[n]-a}$(t.shape[n]===e.reduce((a,i)=>a+i),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tI(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function nI(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function rI(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sI(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function oI(t,e){return`size ${t} must be non-negative, not ${e}`}function aI(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function iI(t,e){const n=M(t),r=M(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function lI(t,e){const n=M(t),r=M(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _h(){return"segment ids must be >= 0"}function uI(){return"segment ids are not increasing"}function cI(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function dI(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pI(t,e){let n=!1,r;for(t<=w1?(r=t,n=!0):r=$c(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=$c(t,r+1);return r}function fI(t,e,n){const r=[],s=t.length;for(let o=0;o<s;o++)o!==e?r.push(t[o]):r.push(n);return r}function hI(t,e,n,r){const s=e.shape.length,o=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const a=t.shape[n],i=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)i.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)i.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)i.push(e.shape[d]);for(let d=n+1;d<o;d++)i.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:a,outputShape:i}}const p6=Object.freeze(Object.defineProperty({__proto__:null,segOpComputeOptimalWindowSize:pI,computeOutShape:fI,collectGatherOpShapeInfo:hI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function el(t){try{return t.map(e=>Xs(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function mI(t){return t.map(e=>dr(e))}const gI=Object.freeze(Object.defineProperty({__proto__:null,slice_util:ik,segment_util:p6,fromUint8ToStringArray:el,fromStringArrayToUint8:mI,upcastType:On,axesAreInnerMostDims:Bx,combineLocations:Jk,computeOutAndReduceShapes:Zn,expandShapeToKeepDim:Xt,assertAxesAreInnerMostDims:Fn,getAxesPermutation:xn,getUndoAxesPermutation:Vx,getInnerMostAxes:vn,getBroadcastDims:Xi,getReductionAxes:Sx,assertAndGetBroadcastShape:le,assertParamsConsistent:OE,computeOutShape:eo,computeDilation2DInfo:Ck,computePool2DInfo:co,computePool3DInfo:bl,computeConv2DInfo:qt,computeConv3DInfo:Sl,computeDefaultPad:Ax,tupleValuesAreOne:Yi,eitherStridesOrDilationsAreOne:Vt,convertConv2DDataFormat:Sa,checkPadOnDimRoundingMode:yn,getFusedDyActivation:Pd,getFusedBiasGradient:Fd,applyActivation:Ld,shouldFuse:Bd,get RowPartitionType(){return Nn},combineRaggedTensorToTensorShapes:DE,getRowPartitionTypesHelper:PE,getRaggedRank:FE,validateDefaultValueShape:LE,PARALLELIZE_THRESHOLD:w1,computeOptimalWindowSize:jd,getImageCenter:BE,getReshaped:b1,getPermuted:S1,getReshapedPermuted:C1,getSliceBeginCoords:VE,getSliceSize:ME,prepareAndValidate:$x,validateUpdateShape:Tx,validateInput:kx,calculateShapes:Nd,SELU_SCALEALPHA:zE,SELU_SCALE:UE,ERF_P:WE,ERF_A1:GE,ERF_A2:jE,ERF_A3:HE,ERF_A4:KE,ERF_A5:qE,warn:sn,log:iL,mergeRealAndImagArrays:Rh,splitRealAndImagArrays:r6,complexWithEvenIndex:s6,complexWithOddIndex:o6,getComplexWithIndex:a6,assignToTypedArray:i6,exponents:l6,exponent:u6,decodeEinsumEquation:XE,getEinsumPermutation:YE,checkEinsumDimSizes:QE,getEinsumComputePath:ZE,isIdentityPermutation:JE,prepareSplitSize:eI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:tI,getSparseFillEmptyRowsNegativeIndexErrorMessage:nI,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:rI,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:sI,getSparseReshapeNegativeOutputDimErrorMessage:oI,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:aI,getSparseReshapeInputOutputMultipleErrorMessage:iI,getSparseReshapeInputOutputMismatchErrorMessage:lI,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:_h,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:uI,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:cI,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:dI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f6=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:m1,nonMaxSuppressionV4Impl:g1,nonMaxSuppressionV5Impl:y1,whereImpl:p1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h6=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:Vd,AdagradOptimizer:Md,AdamOptimizer:zd,AdamaxOptimizer:Ud,MomentumOptimizer:Wd,Optimizer:ps,OptimizerConstructors:Ir,RMSPropOptimizer:Gd,SGDOptimizer:Il,Tensor:_e,TensorBuffer:ua,Variable:Hi,get Rank(){return gh},sumOutType:kd,upcastType:On,get Reduction(){return ft},customGrad:Yn,grad:wM,grads:bM,valueAndGrad:SM,valueAndGrads:CM,variableGrads:uN,Environment:aT,env:_,get ENV(){return wg},nextFrame:AE,KernelBackend:yg,DataStorage:X$,abs:Et,acos:dk,acosh:pk,add:ee,addN:fk,all:hk,any:mk,argMax:gk,argMin:yk,asin:xk,asinh:vk,atan:wk,atan2:bk,atanh:Sk,avgPool:Ox,avgPool3d:$k,basicLSTMCell:Tk,batchToSpaceND:Dx,batchNorm:Cl,batchNorm2d:kk,batchNorm3d:Nk,batchNorm4d:Ek,bincount:Px,broadcastArgs:Ik,broadcastTo:Yo,buffer:Ee,cast:ke,ceil:Rk,clipByValue:_k,clone:pr,complex:wr,concat:st,concat1d:Ak,concat2d:Ok,concat3d:Dk,concat4d:Pk,conv1d:Fk,conv2d:$l,conv2dTranspose:Bk,conv3d:Vk,conv3dTranspose:Mk,cos:zk,cosh:Uk,cumprod:Wk,cumsum:Gk,denseBincount:jk,depthToSpace:Hk,depthwiseConv2d:Ed,diag:Kk,dilation2d:qk,div:xe,divNoNan:Xk,dot:Yk,einsum:Qk,elu:Lx,equal:Fx,erf:Zk,euclideanNorm:tN,exp:ss,expandDims:Or,expm1:nN,eye:Mx,fill:Ca,floor:zx,floorDiv:_x,gather:Ux,greater:kl,greaterEqual:Wx,imag:wl,isFinite:rN,isInf:sN,isNaN:oN,leakyRelu:Gx,less:aN,lessEqual:Id,linspace:iN,localResponseNormalization:lN,log:fa,log1p:jx,logSigmoid:cN,logSoftmax:dN,logSumExp:Kx,logicalAnd:Qi,logicalNot:qx,logicalOr:Xx,logicalXor:pN,lowerBound:fN,matMul:fe,max:Ms,maxPool:Yx,maxPool3d:hN,maxPoolWithArgmax:mN,maximum:Qx,mean:Zi,meshgrid:gN,min:Lc,minimum:Zx,mirrorPad:yN,mod:xN,moments:vN,mul:W,multiRNNCell:wN,multinomial:bN,neg:Hn,notEqual:Jx,oneHot:Dc,ones:Ur,onesLike:SN,outerProduct:CN,pad:$a,pad1d:$N,pad2d:TN,pad3d:kN,pad4d:NN,pool:EN,pow:pa,prelu:t1,print:xx,prod:IN,raggedGather:RN,raggedRange:_N,raggedTensorToTensor:AN,rand:ON,randomGamma:zN,randomNormal:s1,randomStandardNormal:UN,randomUniform:o1,range:ha,real:da,reciprocal:WN,relu:Nl,relu6:a1,reshape:P,reverse:os,reverse1d:GN,reverse2d:jN,reverse3d:HN,reverse4d:KN,round:i1,rsqrt:qN,scalar:oe,selu:XN,separableConv2d:YN,setdiff1dAsync:QN,sigmoid:Vs,sign:ZN,sin:JN,sinh:eE,slice:he,slice1d:tE,slice2d:nE,slice3d:rE,slice4d:sE,softmax:l1,softplus:Hx,spaceToBatchND:e1,fft:Ad,ifft:Ji,irfft:u1,rfft:Od,split:ma,sqrt:Xn,square:hn,squaredDifference:c1,squeeze:El,stack:Qn,step:d1,stridedSlice:oE,sub:se,sum:ye,tan:aE,tanh:Fc,tensor:_n,tensor1d:cn,tensor2d:Zo,tensor3d:Cx,tensor4d:iE,tensor5d:lE,tensor6d:uE,tile:Qo,topk:cE,truncatedNormal:dE,unique:pE,unsortedSegmentSum:fE,unstack:ds,upperBound:hE,variable:mE,where:Js,whereAsync:f1,zeros:br,zerosLike:Pt,op:N,OP_SCOPE_SUFFIX:hx,booleanMaskAsync:gE,transpose:qi,norm:Tl,movingAverage:yE,scatterND:xE,searchSorted:_d,sparseToDense:vE,gatherND:wE,dropout:bE,enclosingPowerOfTwo:h1,cosineWindow:Dd,inTopKAsync:SE,image:v1,linalg:EE,losses:IE,spectral:kE,fused:CE,signal:NE,sparse:RE,string:_E,train:t6,enableProdMode:B4,enableDebugMode:V4,disableDeprecationWarnings:M4,deprecationWarn:z4,disposeVariables:U4,engine:er,memory:W4,profile:G4,tidy:ie,dispose:gt,keep:Un,time:j4,setBackend:H4,ready:K4,getBackend:q4,removeBackend:X4,findBackend:Y4,findBackendFactory:Q4,registerBackend:HT,backend:Z4,setPlatform:J4,getKernel:Rc,getGradient:ph,getKernelsForBackend:_c,registerKernel:lx,registerGradient:lL,unregisterKernel:uL,unregisterGradient:cL,copyRegisteredKernels:dL,Abs:Sg,Acos:Cg,Acosh:$g,Add:Sd,AddN:Tg,All:kg,Any:Ng,ArgMax:Eg,ArgMin:Ig,Asin:Rg,Asinh:_g,Atan:Ag,Atanh:Og,Atan2:Dg,AvgPool:Pg,AvgPoolGrad:lT,AvgPool3D:Fg,AvgPool3DGrad:uT,BatchMatMul:Lg,BatchToSpaceND:Bg,Bincount:Vg,BroadcastTo:J3,BroadcastArgs:Mg,Cast:Cd,Ceil:zg,ClipByValue:Ug,Complex:Wg,ComplexAbs:Gg,Concat:jg,Conv2D:Hg,Conv2DBackpropFilter:Kg,Conv2DBackpropInput:qg,Conv3D:Xg,Conv3DBackpropFilterV2:cT,Conv3DBackpropInputV2:Yg,Cos:Qg,Cosh:Zg,Cumprod:Jg,Cumsum:ey,CropAndResize:ty,DenseBincount:ny,DepthToSpace:ry,DepthwiseConv2dNative:sy,DepthwiseConv2dNativeBackpropFilter:oy,DepthwiseConv2dNativeBackpropInput:ay,Diag:iy,Dilation2D:ly,Dilation2DBackpropInput:eL,Dilation2DBackpropFilter:tL,RealDiv:uy,Einsum:cy,Elu:dy,EluGrad:dT,Erf:py,Equal:fy,Exp:hy,ExpandDims:my,Expm1:gy,FFT:yy,Fill:xy,FlipLeftRight:vy,Floor:wy,FloorDiv:by,FusedBatchNorm:Sy,GatherV2:Cy,GatherNd:$y,Greater:Ty,GreaterEqual:ky,Identity:$d,IFFT:Ny,Imag:Ey,IsFinite:Iy,IsInf:Ry,IsNan:_y,LeakyRelu:Ay,Less:Oy,LessEqual:Dy,LinSpace:Py,Log:Fy,Log1p:Ly,LogicalAnd:By,LogicalNot:Vy,LogicalOr:My,LogicalXor:nL,LogSoftmax:rL,LowerBound:sL,LRN:zy,LRNGrad:pT,Max:Uy,Maximum:Wy,MaxPool:Gy,MaxPoolGrad:fT,MaxPool3D:jy,MaxPool3DGrad:hT,MaxPoolWithArgmax:Hy,Mean:Ky,Min:qy,Minimum:Xy,MirrorPad:Yy,Mod:Qy,Multinomial:Zy,Multiply:Jy,Neg:e0,NotEqual:t0,NonMaxSuppressionV3:n0,NonMaxSuppressionV4:r0,NonMaxSuppressionV5:s0,OnesLike:o0,OneHot:a0,Pack:i0,PadV2:l0,Pool:oL,Pow:u0,Prelu:c0,Prod:d0,RaggedGather:p0,RaggedRange:f0,RaggedTensorToTensor:h0,Range:m0,Real:g0,Reciprocal:y0,Relu:x0,Reshape:v0,ResizeNearestNeighbor:w0,ResizeNearestNeighborGrad:mT,ResizeBilinear:b0,ResizeBilinearGrad:gT,Relu6:S0,Reverse:C0,Round:$0,Rsqrt:T0,ScatterNd:k0,SearchSorted:N0,Select:E0,Selu:I0,Slice:R0,Sin:_0,Sinh:A0,Sign:O0,Sigmoid:D0,Softplus:P0,Sqrt:F0,Sum:L0,SpaceToBatchND:B0,SplitV:V0,Softmax:M0,SparseFillEmptyRows:z0,SparseReshape:U0,SparseSegmentMean:W0,SparseSegmentSum:G0,SparseToDense:j0,SquaredDifference:H0,Square:yT,StridedSlice:K0,StringNGrams:q0,StringSplit:X0,StringToHashBucketFast:Y0,Sub:Q0,Tan:Z0,Tanh:J0,Tile:Td,TopK:ex,Transform:tx,Transpose:wi,Unique:nx,Unpack:rx,UnsortedSegmentSum:sx,UpperBound:aL,ZerosLike:ox,Step:ax,FromPixels:kc,RotateWithOffset:ix,_FusedMatMul:Nc,FusedConv2D:Ec,FusedDepthwiseConv2D:Ic,version_core:AB,browser:hB,io:bx,math:aB,serialization:bB,test_util:_B,util:wL,backend_util:gI,broadcast_util:iB,tensor_util:DL,slice_util:ik,gather_util:mB,scatter_util:gB,device_util:VL,kernel_impls:f6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ks={},du={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function m6(t,e){ks[t]=e}function Dn(t,e){if(!(t in ks)||e!=null){const r=y6(t,e);if(r!==null)ks[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=ks[t];return n==null||n.isContextLost()?(delete ks[t],Dn(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ks[t])}function g6(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function y6(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e==null?g6(t):e;return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete ks[t]},!1),_().getBool("SOFTWARE_WEBGL_ENABLED")&&(du.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",du)||n.getContext("experimental-webgl",du):n.getContext("webgl2",du)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tl;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(tl||(tl={}));var Ut;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Ut||(Ut={}));var qe;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(qe||(qe={}));function Rl(t,e){return[e,t]}function x6(t,e){return t*e}function pu(t){const e=M(t),n=Math.ceil(e/4);return Sc(n)}function ka(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function v6(t,e){const[n,r]=ka(t,e);return n*r*4}function $1(t,e){const n=t;let r,s,o,a,i,l,u,c,d,p;return _().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,o=n.RGBA16F,a=n.RGBA32F,i=n.RED,u=4,c=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,o=t.RGBA,a=n.RGBA,i=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:i,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q(t,e){const n=e();return _().getBool("DEBUG")&&w6(t),n}function w6(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+$6(t,e))}const b6=596e-10,S6=65504;function C6(t){return!!(_().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||b6<Math.abs(t)&&Math.abs(t)<S6)}function $6(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function fu(t,e){return Tr(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function T6(t,e){const n=Tr(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(q(t,()=>t.shaderSource(n,e)),q(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function k6(t,e){const n=Tr(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(q(t,()=>t.shaderSource(n,e)),q(t,()=>t.compileShader(n)),_().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw yI(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const N6=/ERROR: [0-9]+:([0-9]+):/g;function yI(t,e){const n=N6.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),o=s.length.toString().length+2,a=s.map((d,p)=>Fs((p+1).toString(),o)+d);let i=0;for(let d=0;d<a.length;d++)i=Math.max(a[d].length,i);const l=a.slice(0,r-1),u=a.slice(r-1,r),c=a.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Fs(u[0],i)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function E6(t){return Tr(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function I6(t,e){if(q(t,()=>t.linkProgram(e)),!_().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Wp(t,e){if(q(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function R6(t,e){const n=Tr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return q(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),q(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function _6(t,e){const n=Tr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return q(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),q(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function A6(t){return Tr(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function O6(t,e){const n=_().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function D6(t){return Tr(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function hb(t,e,n,r,s,o,a){const i=t.getAttribLocation(e,n);return i===-1?!1:(q(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),q(t,()=>t.vertexAttribPointer(i,s,t.FLOAT,!1,o,a)),q(t,()=>t.enableVertexAttribArray(i)),!0)}function P6(t,e,n){M6(t,n),q(t,()=>t.activeTexture(t.TEXTURE0+n)),q(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function F6(t,e,n){return Tr(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function L6(t,e,n){return t.getUniformLocation(e,n)}function B6(t,e,n,r){q(t,()=>P6(t,e,r)),q(t,()=>t.uniform1i(n,r))}function Gp(t,e,n){q(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),q(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function mb(t,e){q(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),q(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function hu(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+V6(t,e))}function V6(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Tr(t,e,n){const r=q(t,()=>e());if(r==null)throw new Error(n);return r}function M6(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function ga(t,e=2){return M(t.slice(0,t.length-e))}function ya(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function mu(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[ga(t),...ya(t)]),e}function z6(t,e=!1){let n=_().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=_().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&_().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((i,l)=>l>=t.length-2?wd(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Cr(t).newShape);let s=M(t),o=null;t.length<=1&&s<=n?o=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const a=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||a)if(e){const i=ga(t);let l=2,u=2;t.length&&([l,u]=ya(t)),s=i*(l/2)*(u/2),o=Sc(s).map(c=>c*2)}else o=Sc(s);return o}function gu(t){return t%2===0}function Bc(t,e){if(t=t.slice(-2),e=e.slice(-2),Ne(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||gu(n)&&gu(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&gu(t[0])&&gu(e[0])}let jp,Hp;function U6(t){if(jp==null){const e=Dn(t);jp=e.getParameter(e.MAX_TEXTURE_SIZE)}return jp}function W6(t){if(Hp==null){const e=Dn(t);Hp=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Hp)}function G6(t){if(t===0)return 0;let e;const n=Dn(t);return dn(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:dn(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function dn(t,e){return t.getExtension(e)!=null}function gb(t){try{if(Dn(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function j6(t){if(t===0)return!1;const e=Dn(t);if(t===1){if(!dn(e,"OES_texture_float"))return!1}else if(!dn(e,"EXT_color_buffer_float"))return!1;return Ah(e)}function H6(t){if(t===0)return!1;const e=Dn(t);if(t===1){if(!dn(e,"OES_texture_float")||!dn(e,"WEBGL_color_buffer_float"))return!1}else{if(dn(e,"EXT_color_buffer_float"))return Ah(e);const r="EXT_color_buffer_half_float";if(dn(e,r)){const s=e.getExtension(r);return K6(e,s)}return!1}return Ah(e)}function Ah(t){const e=$1(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,s=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),a}function K6(t,e){const n=$1(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const s=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,s,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(a),i}function q6(t){return t!==2?!1:Dn(t).fenceSync!=null}function _l(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&$(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q=_();Q.registerFlag("HAS_WEBGL",()=>Q.getNumber("WEBGL_VERSION")>0);Q.registerFlag("WEBGL_VERSION",()=>gb(2)?2:gb(1)?1:0);Q.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Q.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Q.get("WEBGL_VERSION")===2);Q.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Q.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Q.registerFlag("WEBGL_PACK",()=>Q.getBool("HAS_WEBGL"));Q.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_CLIP",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_PACK_REDUCE",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_LAZILY_UNPACK",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_CONV_IM2COL",()=>Q.getBool("WEBGL_PACK"));Q.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>U6(Q.getNumber("WEBGL_VERSION")));Q.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>W6(Q.getNumber("WEBGL_VERSION")));Q.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Q.getNumber("WEBGL_VERSION");return t===0?0:G6(t)});Q.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Q.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!px());Q.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>j6(Q.getNumber("WEBGL_VERSION")));Q.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Q.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Q.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Q.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>H6(Q.getNumber("WEBGL_VERSION")));Q.registerFlag("WEBGL_FENCE_API_ENABLED",()=>q6(Q.getNumber("WEBGL_VERSION")));Q.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Q.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Q.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Q.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>px()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Q.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Q.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Q.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Q.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Q.registerFlag("WEBGL_EXP_CONV",()=>!1);Q.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Q.getBool("IS_TEST"));Q.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Q.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Q.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vt(){let t,e,n,r,s,o,a,i,l,u;return _().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",o="outputColor",a="out vec4 outputColor;",i=_().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",o="gl_FragColor",a="",i=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:o,defineOutput:a,defineSpecialNaN:i,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fo(t,e,n="index"){const r=He(e);return r.map((s,o)=>{const a=`int ${t[o]} = ${n} / ${s}`,i=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s}`:`index -= ${t[o]} * ${s}`;return`${a}; ${i};`}).join("")}function Hd(t,e,n="index"){const r=He(e);return r.map((s,o)=>{const a=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,i=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${a}; ${i};`}).join("")}function X6(t,e){const n=t.length,r=t.map(o=>`${e}[${o}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function Y6(t,e,n="index"){const r=t.map((o,a)=>a),s=X6(r,e);return s.map((o,a)=>{const i=`int ${t[a]} = ${n} / ${s[a]}`,l=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${s[a]}`:`index -= ${t[a]} * ${s[a]}`;return`${i}; ${l};`}).join("")}function T1(t){const e=He(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function k1(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const xI=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:vI}=gI;function Q6(t,e,n){const r=[];if(t.forEach(f=>{const h=M(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${h>1?`[${h}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=N1(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),o=t.map(f=>Z6(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),a=e.texShape,i=vt(),l=t5(i);let u,c,d=s5(i);return e.isPacked?(u=J6(e.logicalShape,a,n.enableShapeUniforms),c=r5(i)):(u=e5(e.logicalShape,a,n.enableShapeUniforms),c=n5(i)),n.packedInputs&&(d+=l5),[d,l,c,s,u,o,n.userCode].join(`
`)}function Na(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return w5(t,e);case 1:return S5(t,e);case 2:return $5(t,e);case 3:return k5(t,e);case 4:return E5(t,e);case 5:return I5(t);case 6:return R5(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function wI(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return v5(t);case 1:return b5(t,e);case 2:return C5(t,e);case 3:return T5(t,e);default:return N5(t,e)}}function Z6(t,e,n=!1,r){let s="";n?s+=wI(t,r):s+=Na(t,r);const o=t.shapeInfo.logicalShape,a=e.logicalShape;return o.length<=a.length&&(n?s+=_5(t,e):s+=A5(t,e)),s}function J6(t,e,n){switch(t.length){case 0:return bI();case 1:return u5(t,e,n);case 2:return y5(t,e,n);case 3:return d5(t,e,n);default:return f5(t,e,n)}}function e5(t,e,n){switch(t.length){case 0:return bI();case 1:return c5(t,e,n);case 2:return x5(t,e,n);case 3:return p5(t,e,n);case 4:return h5(t,e,n);case 5:return m5(t,e);case 6:return g5(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function t5(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function n5(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function r5(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function s5(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${o5}
    ${a5}
    ${i5}
  `}const o5=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,a5=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,i5=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,l5=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function bI(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function u5(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function c5(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function d5(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),o=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function p5(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Hd(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=fo(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function f5(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),o=s*Math.ceil(t[t.length-2]/2);let a=o,i="",l="b, r, c";for(let u=2;u<t.length-1;u++)a*=t[t.length-u-1],i=`
      int b${u} = index / ${a};
      index -= b${u} * ${a};
    `+i,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${i}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function h5(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Hd(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=fo(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function m5(t,e){const n=fo(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function g5(t,e){const n=fo(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function y5(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Ne(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function x5(t,e,n){return Ne(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function ho(t){return`offset${t}`}function v5(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=vt();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function w5(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,o]=t.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=ho(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${a});
      return sampleTexture(${n}, uv);
    }
  `;const[i,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${i}, ${l}, ${a});
      return sampleTexture(${n}, uv);
    }
  `}function b5(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=vt();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function S5(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Ea(t)}
      }
    `;const s=t.shapeInfo.texShape,o=s[0],a=s[1];if(a===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=ho(n);return a===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${i});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${a}, index + ${i});
      return sampleTexture(${n}, uv);
    }
  `}function C5(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=o[0],i=o[1],l=vt();if(o!=null&&Ne(n,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}.0, ${a}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function $5(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(o!=null&&Ne(n,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=o[0],f=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:a,keptDims:i}=Cr(n),l=a;if(l.length<n.length){const p=Ia(t,l),f=["row","col"];return`
      ${Na(p,e)}
      float ${s}(int row, int col) {
        return ${s}(${Ra(f,i)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Ea(t)}
      }
    `;const u=o[0],c=o[1],d=ho(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function T5(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const p=n.slice(1),f=[1,2],h=Ia(t,p),g=["b","row","col"];return`
        ${wI(h,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Ra(g,f)});
        }
      `}const i=vt();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${i.texture2D}(${r}, uv);
    }
  `;const l=a[0],u=a[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${i.texture2D}(${r}, uv);
    }
  `}function k5(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],a=n[2],{newShape:i,keptDims:l}=Cr(n),u=i;if(u.length<n.length){const g=Ia(t,u),y=["row","col","depth"];return`
        ${Na(g,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Ra(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${a}, 1)));
        ${Ea(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],p=c[1],f=t.shapeInfo.flatOffset;if(p===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===a&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const h=ho(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${h};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${a} + depth + ${h};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function N5(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=vt();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,a=o.length,i=t.shapeInfo.texShape,l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[a-1]/2);let p=d*Math.ceil(o[a-2]/2),f="int b, int row, int col",h=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<a-1;g++)f=`int b${g}, `+f,p*=o[a-g-1],h=`b${g} * ${p} + `+h;return`
    vec4 ${r}(${f}) {
      int index = ${h};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function E5(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],a=n[2]*o,i=n[1]*a,{newShape:l,keptDims:u}=Cr(n);if(l.length<n.length){const x=Ia(t,l),v=["row","col","depth","depth2"];return`
      ${Na(x,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Ra(v,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${i}, ${a}, ${o}, 1)));
        ${Ea(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1],h=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(f===i&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${h}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===o&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const m=ho(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${h}
      ${g}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${m});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${a} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${p}, ${f}, index + ${m});
      return sampleTexture(${r}, uv);
    }
  `}function I5(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,a=e[2]*o,i=e[1]*a,{newShape:l,keptDims:u}=Cr(e);if(l.length<e.length){const g=Ia(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${Na(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Ra(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${i}, ${a}, ${o}, ${s})) +
          depth3;
        ${Ea(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const h=ho(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${a} + depth * ${o} +
          depth2 * ${s} + depth3 + ${h};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function R5(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=Cr(e);if(s.length<e.length){const y=Ia(t,s),m=["row","col","depth","depth2","depth3","depth4"];return`
      ${Na(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Ra(m,o)});
      }
    `}const a=e[5],i=e[4]*a,l=e[3]*i,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${i})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${Ea(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],h=p[1];if(h===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${i}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===a&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=ho(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${i} + depth3 * ${a} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ea(t){const e=t.name,n=M(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function _5(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length,i=vI(t.shapeInfo.logicalShape,e.logicalShape),l=ve(a),u=a-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":a<2&&i.length>=1?c="coords = 0;":c=i.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let p="";a<2&&o>0?p="coords":p=t.shapeInfo.logicalShape.map((x,v)=>`coords.${d[v+u]}`).join(", ");let f="return outputValue;";const g=M(t.shapeInfo.logicalShape)===1,m=M(e.logicalShape)===1;if(o===1&&!g&&!m)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!m)a===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(i.length){const x=o-2,v=o-1;i.indexOf(x)>-1&&i.indexOf(v)>-1?f="return vec4(outputValue.x);":i.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":i.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${p});
      ${f}
    }
  `}function A5(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,a=t.shapeInfo.texShape,i=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&i===l&&t.shapeInfo.flatOffset==null&&Ne(a,o))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=ve(l),c=vI(t.shapeInfo.logicalShape,e.logicalShape),d=l-i;let p;const f=["x","y","z","w","u","v"];i===0?p="":l<2&&c.length>=1?p="coords = 0;":p=c.map(g=>`coords.${f[g+d]} = 0;`).join(`
`);let h="";return l<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((g,y)=>`coords.${f[y+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${r}(${h});
    }
  `}function ve(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function N1(t,e,n){const{newShape:r,keptDims:s}=Cr(e),o=e.length,a=t&&o===3&&e[0]===1,i=a?e.slice(1):r,l=!t&&o>1&&!Ne(e,n)&&r.length<o||a;return{useSqueezeShape:l,uniformShape:l?i:e,keptDims:s}}function Ia(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Ra(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O5(t,e,n,r){const s=n.map((c,d)=>{const p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),o=s.map(c=>c.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},i=Q6(s,a,e),l=k6(t.gl,i),u=t.createProgram(l);return _().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:o,outShapeInfo:a,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:o,outShapeInfo:a},SI(t,e,u))}function SI(t,e,n){const r={},s={},o={},a=[];let i,l,u,c=null,d=null;d=t.getUniformLocation(n,"NAN",!1),_().getNumber("WEBGL_VERSION")===1&&(c=t.getUniformLocation(n,"INFINITY",!1));const p=!1;for(let f=0;f<e.variableNames.length;f++){const h=e.variableNames[f];r[h]=t.getUniformLocation(n,h,p),r[`offset${h}`]=t.getUniformLocation(n,`offset${h}`,p),e.enableShapeUniforms&&(s[`${h}Shape`]=t.getUniformLocation(n,`${h}Shape`,p),o[`${h}TexShape`]=t.getUniformLocation(n,`${h}TexShape`,p))}return e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",p),u=t.getUniformLocation(n,"outShapeStrides",p),l=t.getUniformLocation(n,"outTexShape",p)),e.customUniforms&&e.customUniforms.forEach((f,h)=>{a[h]=t.getUniformLocation(n,f.name,p)}),{uniformLocations:r,customUniformLocations:a,infLoc:c,nanLoc:d,inShapesLocations:s,inTexShapesLocations:o,outShapeLocation:i,outShapeStridesLocation:u,outTexShapeLocation:l}}function yb(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,o=e[r],a=o.shape;if(!Ne(s,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${a} must match`);if(n.isUniform&&o.isUniform)return;const i=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Ne(i,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${i} and ${l} must match`)})}function D5(t,e,n,r,s){e.program.enableShapeUniforms||(yb(e.inShapeInfos,n),yb([e.outShapeInfo],[r]));const o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,a[0],a[1]):t.setOutputMatrixTexture(o.texture,a[0],a[1]),t.setProgram(e.webGLProgram),_().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((l,u)=>{const c=e.program.variableNames[u],d=e.uniformLocations[c],p=e.uniformLocations[`offset${c}`],f=e.inShapesLocations[`${c}Shape`],h=e.inTexShapesLocations[`${c}TexShape`];if(f){const{uniformShape:g}=N1(e.program.packedInputs,l.shape,l.texData.texShape);switch(g.length){case 1:t.gl.uniform1iv(f,new Int32Array(g));break;case 2:t.gl.uniform2iv(f,new Int32Array(g));break;case 3:t.gl.uniform3iv(f,new Int32Array(g));break;case 4:t.gl.uniform4iv(f,new Int32Array(g));break}}if(h&&t.gl.uniform2i(h,l.texData.texShape[0],l.texData.texShape[1]),d!=null){if(l.isUniform){if(M(l.shape)<2)t.gl.uniform1f(d,l.uniformValues[0]);else{let g=l.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),t.gl.uniform1fv(d,g)}return}l.texData.slice!=null&&p!=null&&t.gl.uniform1i(p,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,d,u)}});const i=e.outShapeLocation;if(i)switch(r.shape.length){case 1:t.gl.uniform1iv(i,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(i,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(i,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(i,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=He(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s&&e.program.customUniforms.forEach((l,u)=>{const c=e.customUniformLocations[u],d=s[u];if(l.type==="float")t.gl.uniform1fv(c,d);else if(l.type==="vec2")t.gl.uniform2fv(c,d);else if(l.type==="vec3")t.gl.uniform3fv(c,d);else if(l.type==="vec4")t.gl.uniform4fv(c,d);else if(l.type==="int")t.gl.uniform1iv(c,d);else if(l.type==="ivec2")t.gl.uniform2iv(c,d);else if(l.type==="ivec3")t.gl.uniform3iv(c,d);else if(l.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}),t.executeProgram()}function P5(t,e,n){let r="";e.concat(n).forEach(a=>{const i=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=N1(t.packedInputs,a.shape,l);let p="",f="",h="";if(c.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!t.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const C=He(c);h=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const g=a.shape.length,y=c.length===2&&Ne(a.shape,l),m=M(a.shape)===1,x=Xi(a.shape,n.shape),v=!t.packedInputs&&g===n.shape.length&&Ne(l,n.texData.texShape),b=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${v}_${u?d:""}_${c.length}_${m}_${x}_${y}_${p}_${f}_${h}_${b}_${i}`}else{const l=a.isUniform?"uniform":a.texData.texShape;r+=`${a.shape}_${l}_${i}`}});const s=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+s+`${_().getNumber("WEBGL_VERSION")}`,o}function wt(t){return _().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F5{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=tl.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=vt();this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Hd(["r","c","d"],e):fo(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L5{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=tl.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=vt();this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Hd(["r","c","d"],e):fo(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B5{constructor(e){this.variableNames=["A"],this.outTexUsage=Ut.DOWNLOAD;const n=vt();this.outputShape=e,this.userCode=`
      ${xI}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V5{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ut.DOWNLOAD;const n=vt();this.outputShape=e,this.userCode=`
      ${xI}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M5={R:0,G:1,B:2,A:3};class xb{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=vt();this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let a="";for(let i=0;i<r.length;i++){const l=r[i];a+=`
          if(offset == ${i}) {
            result = values[${M5[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?k1():T1(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${a}
        }
        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z5{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=vt();this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length);let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let i=0;i<=1;i++){const l=a*2+i;s+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?k1():T1(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U5(t){const e=vt(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return T6(t,n)}function W5(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return R6(t,e)}function G5(t){const e=new Uint16Array([0,1,2,2,1,3]);return _6(t,e)}function Al(t,e,n,r,s,o){O6(e,n);const a=A6(t),i=t.TEXTURE_2D;return q(t,()=>t.bindTexture(i,a)),q(t,()=>t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),q(t,()=>t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),q(t,()=>t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST)),q(t,()=>t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST)),_().getNumber("WEBGL_VERSION")===1?q(t,()=>t.texImage2D(i,0,r,e,n,0,s,o,null)):q(t,()=>t.texStorage2D(i,1,r,e,n)),q(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:a,texShape:[n,e]}}function CI(t){return t.internalFormatFloat}function j5(t,e,n,r){const[s,o]=Rl(e,n);return Al(t,s,o,CI(r),r.textureFormatFloat,t.FLOAT)}function $I(t){return t.internalFormatHalfFloat}function H5(t,e,n,r){const[s,o]=Rl(e,n);return Al(t,s,o,$I(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function TI(t){return t.downloadTextureFormat}function K5(t,e,n,r){const[s,o]=Rl(e,n);return Al(t,s,o,TI(r),t.RGBA,t.UNSIGNED_BYTE)}function kI(t){return t.internalFormatPackedFloat}function q5(t,e,n,r){const[s,o]=ka(e,n);return Al(t,s,o,kI(r),t.RGBA,t.FLOAT)}function NI(t){return t.internalFormatPackedHalfFloat}function X5(t,e,n,r){const[s,o]=ka(e,n);return Al(t,s,o,NI(r),t.RGBA,r.textureTypeHalfFloat)}function Y5(t,e,n){return q(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),hb(t,e,"clipSpacePos",n,3,20,0)&&hb(t,e,"uv",n,2,20,12)}function Q5(t,e,n,r,s,o){q(t,()=>t.bindTexture(t.TEXTURE_2D,e));let a,i,l;s instanceof Uint8Array?(a=new Uint8Array(n*r*4),i=t.UNSIGNED_BYTE,l=t.RGBA):(a=new Float32Array(n*r*4),i=t.FLOAT,l=o.internalFormatPackedFloat),a.set(s),_().getNumber("WEBGL_VERSION")===2?q(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,i,a)):q(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,i,a)),q(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Z5(t,e,n){q(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?_().getNumber("WEBGL_VERSION")===2?q(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):q(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):_().getNumber("WEBGL_VERSION")===2?q(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):q(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),q(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function J5(t,e,n,r){const s=t.createBuffer();q(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const i=4*4*e*n;return q(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)),q(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),q(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function eG(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function tG(t,e,n,r){const[s,o]=Rl(e,n),a=4,i=new Uint8Array(x6(e*n,a));return q(t,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}function nG(t,e,n,r,s,o,a,i){const l=t,u=new Float32Array(v6(o,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function rG(t,e,n){const r=new Float32Array(e*n*4);return q(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kp{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=_().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,m6(n,e)):this.gl=Dn(n);let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),_().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=fu(this.gl,o),dn(this.gl,a))this.textureHalfFloatExtension=fu(this.gl,a);else if(_().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),dn(this.gl,s))this.colorBufferHalfFloatExtension=fu(this.gl,s);else if(_().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",dn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(dn(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=W5(this.gl),this.indexBuffer=G5(this.gl),this.framebuffer=D6(this.gl),this.textureConfig=$1(this.gl,this.textureHalfFloatExtension)}get debug(){return _().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;q(e,()=>e.finish()),q(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),q(e,()=>e.deleteFramebuffer(this.framebuffer)),q(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),q(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),q(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),j5(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),H5(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),K5(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Z5(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Q5(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),X5(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),q5(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(mb(this.gl,this.framebuffer),this.outputTexture=null),q(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>tG(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,o,a){return nG(this.gl,e,n,r,s,o,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return eG(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=J5(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(_().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const a=s.clientWaitSync(o,0,0);return a===s.ALREADY_SIGNALED||a===s.CONDITION_SATISFIED},n=o}else _().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>rG(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=U5(n));const r=E6(n);return q(n,()=>n.attachShader(r,this.vertexShader)),q(n,()=>n.attachShader(r,e)),I6(n,r),this.debug&&Wp(n,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=Y5(n,this.program,this.vertexBuffer)),r}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&q(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Wp(this.gl,this.program),q(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?F6(this.gl,e,n):L6(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),q(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),B6(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,o]=ka(n,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Wp(this.gl,this.program),hu(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),q(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),q(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fu(this.gl,_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await dh(()=>this.disposed||this.isQueryAvailable(e,_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=sG(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in _().platform&&(r=_().platform.setTimeoutCustom.bind(_().platform)),dh(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Gp(this.gl,e,this.framebuffer),this.debug&&hu(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Gp(this.gl,this.outputTexture,this.framebuffer),this.debug&&hu(this.gl)):mb(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;Gp(s,e,this.framebuffer),this.debug&&hu(s),this.outputTexture=e,q(s,()=>s.viewport(0,0,n,r)),q(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),q(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function sG(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yt(t){return(e,n,r,s,o)=>{const a=le(e,n),i=a.length,l=He(a),u=M(a),c=Kn(o,u),d=e.length,p=n.length,f=He(e),h=He(n),g=Xi(e,a),y=Xi(n,a);if(g.length+y.length===0)for(let m=0;m<c.length;++m)c[m]=t(r[m%r.length],s[m%s.length]);else for(let m=0;m<c.length;++m){const x=bd(m,i,l),v=x.slice(-d);g.forEach(I=>v[I]=0);const b=Tc(v,d,f),C=x.slice(-p);y.forEach(I=>C[I]=0);const k=Tc(C,p,h);c[m]=t(r[b],s[k])}return[c,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=xl([0],n),[o,a]=Yt((i,l)=>i!==l?1:0)(e,[],t,s,"bool");return[a,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iG=Yt((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(t,e,n,r,s){const o=M(r),a=vr(s,n);for(let i=0;i<t.length;i++){const l=t[i];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?a[l]+=e[i]:a[l]+=1)}return a}function uG(t,e,n,r=!1){const s=t.shape[0],o=t.shape[1],a=Ee([s,n],e.dtype);for(let i=0;i<s;i++)for(let l=0;l<o;l++){const u=t.get(i,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?a.set(1,i,u):e.size>0?a.set(a.get(i,u)+e.get(i,l),i,u):a.set(a.get(i,u)+1,i,u))}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(t){return(e,n,r)=>{const s=Kn(n,e.length);for(let o=0;o<e.length;++o)s[o]=t(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cG=fs(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(t,e,n,r){const s=Xe(n,M(e));if(r&&n!=="string"){let o=0;t.forEach(a=>{const i=M(a.shape);s.set(a.vals,o),o+=i})}else{let o=0;t.forEach(a=>{const i=n==="string"?el(a.vals):a.vals;let l=0;for(let u=0;u<a.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<a.shape[1];++d)s[c+d]=i[l++]}o+=a.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pG=Yt((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fG=fs(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hG=fs(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mG=fs(t=>Math.floor(t));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(t,e,n,r,s,o,a,i,l){const u=Ee([r,o],n);for(let c=0;c<r;c++){const d=[];let p=0;for(let f=0;f<s;f++){const h=t[c*s+f];p+=h*a[f],d.push(h)}if(p<0||p>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${i}`);for(let f=0;f<o;f++)u.values[c*o+f]=e.get(...e.indexToLoc(p*o+f))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(t,e,n){const r=Ee(n,t.dtype);for(let s=0;s<r.size;++s){const a=r.indexToLoc(s).slice(),i=a[0],l=a[2],u=e.locToIndex([i,l]);a[2]=e.values[u];const c=t.locToIndex(a);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xG=Yt((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vG=Yt((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wG=Yt((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bG=Yt((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(t,e,n){const r=(e-t)/(n-1),s=vr(n,"float32");s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CG=fs(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t,e,n,r){const s=Kn(r,M(n));for(let o=0;o<s.length;++o){const a=o*e;let i=t[a];for(let l=0;l<e;++l){const u=t[a+l];(Number.isNaN(u)||u>i)&&(i=u)}s[o]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TG=Yt((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kG=Yt((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EI=Yt((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(t,e,n){const r=uo(-1,n);return EI([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=Yt((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(t,e,n,r,s){const o=e.length,a=M(e),i=He(e),l=He(s),u=Kn(n,M(s));for(let c=0;c<a;++c){const d=bd(c,o,i),p=new Array(d.length);for(let h=0;h<p.length;h++)p[h]=d[r[h]];const f=Tc(p,o,l);u[f]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t,e,n,r){const[s,o]=Zn(t,r),a=On(e,"int32"),i=vr(M(s),a),l=M(o);for(let u=0;u<i.length;++u){const c=u*l;let d=1;for(let p=0;p<l;++p)d*=n[c+p];i[u]=d}return{outVals:i,outShape:s,outDtype:a}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _G(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const o=bd(s,e.length,He(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function AG(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function OG(t,e,n,r){const s=[];let o=0;const a=e.length-1+n.length,i=new Array(a).fill(null).map(()=>[0]);AG(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)i[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let p=0;p<n.length;++p){const f=n[p],h=p+e.length-1;if(h>=0){const g=i[h],y=g[g.length-1]-f[c];for(let m=c;m<d;++m)i[h].push(f[m+1]+y)}c=f[c],d=f[d]}d!==c&&(s.push([c,d]),o+=d-c)}return{outSplits:i,valueSlices:s,numValues:o}}function DG(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=Xe("int32",r);e.push(s),t[n].forEach((o,a)=>s[a]=o)}return e}function vb(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function PG(t,e,n,r,s,o){const a=vb(e,2)[1],i=vb(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*i+d]=t[c*a+d];++l}}function FG(t,e,n,r,s){const o=e.slice();o[0]=s;const a=Xe(n,M(o)),i=t.length,l=i===0?0:i/e[0];return PG(t,e,r,l,a,o),[a,o]}function LG(t,e,n,r,s,o,a,i){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(_G(o,a,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:p}=OG(o,a,t,u),f=DG(c),h=FG(n,r,s,d,p);return[f,h[0],h[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wb=2147483647;function BG(t,e,n,r,s,o,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const i=e.length===0,l=s.length===0,u=a.length===0,c=[];i||c.push(e[0]),l||c.push(s[0]),u||c.push(a[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],p=Xe("int32",d+1);p[0]=0;for(let y=0;y<d;++y){const m=i?t[0]:t[y],x=l?r[0]:r[y],v=u?o[0]:o[y];if(v===0)throw new Error("Requires delta != 0");let b;if(v>0&&x<m||v<0&&x>m)b=0;else if(b=Math.ceil(Math.abs((x-m)/v)),b>wb)throw new Error(`Requires ((limit - start) / delta) <= ${wb}`);p[y+1]=p[y]+b}const f=p[d],h=Xe(n,f);let g=0;for(let y=0;y<d;++y){const m=p[y+1]-p[y];let x=i?t[0]:t[y];const v=u?o[0]:o[y];for(let b=0;b<m;++b)h[g++]=x,x+=v}return[p,h]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Zt=Nn;class Vc{constructor(e,n,r,s,o,a,i,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=a,this.defaultValueShape=i,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=PE(c),this.raggedRank=FE(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Zt.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Zt.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Zt.VALUE_ROWIDS:return Vc.getMaxWidthValueRowID(n);case Zt.ROW_SPLITS:return Vc.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Zt[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],o=0;for(let a=1;a<n;++a){const i=e[a];i!==s&&(s=i,o=Math.max(a-r,o),r=a)}return Math.max(n-r,o)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Sb(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;LE(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=DE(this.raggedRank,s,n);a[0]<0&&(a[0]=e);for(let i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),o=[];let a=0;for(let i=0;i<s;++i,a+=n)o.push(a);for(let i=s;i<e;++i)o.push(-1);return $(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,r,s){const o=e.length,a=[];for(let i=0;i<o-1;++i){const l=e[i+1]-e[i];let u=Math.min(s,l),c=n[i];c===-1&&(u=0);for(let d=0;d<u;++d)a.push(c),c+=r;for(let d=0;d<l-u;++d)a.push(-1)}if(o>0&&a.length!==e[o-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,n,r,s){const o=e.length,a=[];if(o===0)return[];let i=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];a.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++i,i<s?u+=r:u=-1);else{if(i=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}a.push(u)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,n,r,s){const o=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case Zt.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,s);case Zt.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,s);default:throw new Error(`Unsupported partition type: ${Zt[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Zt.FIRST_DIM_SIZE:return e[0];case Zt.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Zt.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Zt[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const o=Sb(r,!1),a=Xe(this.valuesDType,M(o));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,a,o)}return[o,a]}setOutput(e,n,r,s){if(r.length===0)return;const o=this.values,a=r;let i=s.slice();i=i.slice(e+1);const l=M(i),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const h=this.defaultValueShape;ie(()=>{const g=P(c,h);c=Yo(g,i).dataSync()})}let d=0,p=0,f=0;for(let h=0;h<=u;++h){let g=h<u?n[h]:-1;if(g===f){++f;continue}if(p<f){const y=o.subarray(d*l),m=a.subarray(p*l),x=(f-p)*l;bb(m,y,x)}if(h>=u){const y=r.length;g=Math.floor(y/l)}if(g>f)if(this.defaultValue.length===1)a.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const y=a.slice(f*l);bb(y,c,l),++f}g<0?(d=h+1,p=f):(d=h,p=f,f=p+1)}}}function bb(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function Sb(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function VG(t,e,n,r,s,o,a,i,l,u){return new Vc(t,e,n,r,s,o,a,i,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(t,e,n,r){const s=t===e,o=t<e&&n<0,a=e<t&&n>1;if(s||o||a)return vr(0,r);const i=Math.abs(Math.ceil((e-t)/n)),l=vr(i,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zG=fs(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(t,e,n,r,s,o,a,i,l,u){const c=[r/s,s],d=t.values,p=e.values;if(r===0)return Ee(n,e.dtype);const f=Ee(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let h=0;h<o;h++){const g=[];let y=0;for(let m=0;m<a;m++){const x=d[h*a+m];g.push(x),y+=x*i[m]}if(y<0||y>=r/s)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let m=0;m<s;m++)u?f.values[y*s+m]+=p[h*s+m]:f.values[y*s+m]=e.rank===0?p[0]:p[h*s+m]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WG=fs(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(t,e,n,r,s){const o=Nx(r,e,n),a=M(n),i=He(r);if(o){const d=Ex(e,i);return s==="string"?t.slice(d,d+a):t.subarray(d,d+a)}const l=s==="string"?el(t):t,u=Ee(r,s,l),c=Ee(n,s);for(let d=0;d<c.size;++d){const p=c.indexToLoc(d),f=p.map((h,g)=>h+e[g]);c.set(u.get(...f),...p)}return s==="string"?mI(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(t,e,n,r,s,o,a){const i=e[0],l=o[0],u=new Array(l),c=new Array(i),d=e[1];if(l===0){if(i!==0)throw new Error(tI(i));const y=Xe(n,0),m=Xe(s,0);return[y,[0,d],m,u,c]}let p=!0,f=0;const h=new Array(l).fill(0);for(let y=0;y<i;++y){const m=t[y*d];if(m<0)throw new Error(nI(y,m));if(m>=l)throw new Error(rI(y,m,l));++h[m],p=p&&m>=f,f=m}let g=!0;for(let y=0;y<l;++y){const m=h[y]===0;u[y]=m,g=g&&!m,h[y]=Math.max(h[y],1),y>0&&(h[y]+=h[y-1])}if(g&&p){const y=t,m=r;for(let x=0;x<i;++x)c[x]=x;return[y,[i,d],m,u,c]}else{const y=h[l-1],m=Xe(n,y*d),x=Xe(s,y),v=new Array(l).fill(0);for(let b=0;b<i;++b){const C=t[b*d],k=v[C],I=(C===0?0:h[C-1])+k;v[C]++;for(let R=0;R<d;++R)m[I*d+R]=t[b*d+R];x[I]=r[b],c[b]=I}for(let b=0;b<l;++b)if(v[b]===0){const k=b===0?0:h[b-1];m[k*d+0]=b;for(let I=1;I<d;++I)m[k*d+I]=0;x[k]=a}return[m,[y,d],x,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(t,e,n,r,s){const o=M(r),a=e[0],i=s.length,l=[];let u=1,c=-1;for(let y=0;y<i;++y){const m=s[y];if(m===-1){if(c!==-1)throw new Error(sI(c,y));c=y,l.push(1)}else{if(m<0)throw new Error(oI(y,m));u*=m,l.push(m)}}if(c!==-1){if(u<=0)throw new Error(aI());const y=Math.trunc(o/u);if(u*y!==o)throw new Error(iI(r,l));l[c]=y}if(M(l)!==o)throw new Error(lI(r,l));const p=r.length,f=[];if(p>0){f[p-1]=1;for(let y=p-2;y>=0;--y)f[y]=f[y+1]*r[y+1]}const h=[];if(i>0){h[i-1]=1;for(let y=i-2;y>=0;--y)h[y]=h[y+1]*l[y+1]}const g=Xe(n,a*i);for(let y=0;y<a;++y){let m=0;for(let x=0;x<p;++x)m+=t[y*p+x]*f[x];for(let x=0;x<i;++x)g[y*i+x]=Math.trunc(m/h[x]),m%=h[x]}return[g,[a,i],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(t,e,n,r,s,o=!1,a=0){const i=r.length,l=[e[0],t.length/e[0]],u=l[1],d=i>0?s[i-1]+1:0;if(d<0)throw new Error(_h());const p=e.slice();p[0]=d;const f=p.reduce((v,b)=>v*b,1),h=Xe(n,f);if(i===0)return d>0&&h.fill(a),[h,p];if(d<=0)throw new Error(_h());let g=0,y=1,m=0,x=s[g];for(;;){let v=0;if(y<i){if(v=s[y],x===v){++y;continue}if(x>=v)throw new Error(uI())}if(x<0||x>=d)throw new Error(cI(x,d));x>m&&h.fill(a,m*u,x*u);for(let b=g;b<y;++b){const C=r[b];if(C<0||C>=l[0])throw new Error(dI(b,r[b],l[0]));for(let k=0;k<u;k++)h[x*u+k]+=t[C*u+k]}if(o)for(let b=0;b<u;b++)h[x*u+b]/=y-g;if(g=y,++y,m=x+1,x=v,y>i)break}return m<d&&h.fill(a,m*u,d*u),[h,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qG=fs(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XG=Yt((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(t,e,n,r){const s=Ee(t,e.dtype);for(let o=0;o<s.size;o++){const a=s.indexToLoc(o),i=new Array(a.length);for(let l=0;l<i.length;l++)i[l]=a[l]*n[l]+r[l];s.set(e.get(...i),...a)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QG{constructor(e,n,r,s,o,a){this.separator=dr(e),this.nGramWidths=n,this.leftPad=dr(r),this.rightPad=dr(s),this.padWidth=o,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,o,a){for(let i=0;i<o;++i){const l=this.getPadWidth(a),u=Math.max(0,l-i),c=Math.max(0,l-(o-(i+1))),d=a-(u+c),p=n+(u>0?0:i-l);let f=0;f+=u*this.leftPad.length;for(let x=0;x<d;++x)f+=e[p+x].length;f+=c*this.rightPad.length;const h=u+c+d-1;f+=h*this.separator.length,r[s+i]=new Uint8Array(f);const g=r[s+i];let y=0;const m=x=>x.forEach(v=>g[y++]=v);for(let x=0;x<u;++x)m(this.leftPad),m(this.separator);for(let x=0;x<d-1;++x)m(e[p+x]),m(this.separator);if(d>0){m(e[p+d-1]);for(let x=0;x<c;++x)m(this.separator),m(this.rightPad)}else{for(let x=0;x<c-1;++x)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const o=s-1,a=Xe("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=o;++u)a[u]=0;return[l,a]}a[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),a[l]=a[l-1]+c}const i=new Array(a[o]);for(let l=0;l<o;++l){const u=n[l];let c=a[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],f=this.getNumNGrams(p,d);this.createNGrams(e,u,i,c,f,d),c+=f}),this.preserveShort&&c===a[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth,f=1;this.createNGrams(e,u,i,c,f,p)}}return[i,a]}}function ZG(t,e,n,r,s,o,a,i){return new QG(n,r,s,o,a,i).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(t,e,n,r){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)r.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let a=t.indexOf(o);for(;a!==-1;){const i=t.subarray(0,a);(!n||i.length!==0)&&r.push(i),t=t.subarray(a+1),a=t.indexOf(o)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const a=t.subarray(s,o);(!n||a.length!==0)&&r.push(a),s=o+1}}function e8(t,e,n){const r=t.length,s=[];let o=0,a=0;const i=new Array(r);for(let p=0;p<r;++p){const f=s.length;JG(t[p],e,n,s);const h=s.length-f;i[p]=h,o+=h,a=Math.max(a,h)}const l=Xe("int32",o*2),u=new Array(o),c=[r,a];let d=0;for(let p=0;p<r;++p)for(let f=0;f<i[p];++f)l[d*2]=p,l[d*2+1]=f,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(t,e){const n=Xe("int32",t.length);for(let r=0;r<t.length;++r)n[r]=$T(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8=Yt((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=Ee(n,t.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),a=new Array(t.rank);for(let l=0;l<a.length;l++)a[l]=o[l]%t.shape[l];const i=t.locToIndex(a);r.values[s]=t.values[i]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ti=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function II(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const i=r-n+1,l=e-n+1,u=Math.log(i),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(i-c)/i)*Math.sign(l-i/2),p=Math.max(n,Math.floor(e-l*c/i+d)),f=Math.min(r,Math.floor(e+(i-l)*c/i+d));II(t,e,p,f)}const s=t[e];let o=n,a=r;for(sr(t,n,e),ti(t[r],s)>0&&sr(t,n,r);o<a;){for(sr(t,o,a),o++,a--;ti(t[o],s)<0;)o=o+1;for(;ti(t[a],s)>0;)a=a-1}ti(t[n],s)===0?sr(t,n,a):(a=a+1,sr(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function s8(t,e,n,r,s){const o=e[e.length-1],[a,i]=[t.length/o,o],l=Kn(n,a*r),u=Kn("int32",a*r);for(let d=0;d<a;d++){const p=d*i,f=t.subarray(p,p+i);let h=new Array(f.length);f.forEach((x,v)=>h[v]={value:x,index:v}),r<h.length&&(II(h,r),h=h.slice(0,r)),s&&h.sort(ti);const g=d*r,y=l.subarray(g,g+r),m=u.subarray(g,g+r);for(let x=0;x<r;x++)y[x]=h[x].value,m[x]=h[x].index}const c=e.slice();return c[c.length-1]=r,[Ee(c,n,l),Ee(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e,n,r){const s=Ue(e,n)[0],o=[1,n[0],1];for(let h=0;h<s;h++)o[0]*=n[h];o[1]=n[s];for(let h=s+1;h<n.length;h++)o[2]*=n[h];const a={},i=new Int32Array(n[s]),l=new ua(o,r,t),u=[],c=o[0]===1&&o[2]===1;for(let h=0;h<n[s];h++){let g;if(c)g=t[h].toString();else{const y=[];for(let m=0;m<o[0];m++)for(let x=0;x<o[2];x++)y.push(l.get(m,h,x));g=y.join(",")}if(a[g]!==void 0)i[h]=a[g];else{const y=Object.keys(a).length;a[g]=y,i[h]=y,u.push(h)}}const d=o.slice();d[1]=Object.keys(a).length;const p=new ua(d,r);u.forEach((h,g)=>{for(let y=0;y<o[0];y++)for(let m=0;m<o[2];m++)p.set(l.get(y,h,m),y,g,m)});const f=n.slice();return f[s]=d[1],{outputValues:p.values,outputShape:f,indices:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a8=Object.freeze(Object.defineProperty({__proto__:null,simpleAbsImpl:oG,addImpl:iG,bincountImpl:lG,bincountReduceImpl:uG,castImpl:aG,ceilImpl:cG,concatImpl:dG,equalImpl:pG,expImpl:fG,expm1Impl:hG,floorImpl:mG,gatherNdImpl:gG,gatherV2Impl:yG,greaterImpl:xG,greaterEqualImpl:vG,lessImpl:wG,lessEqualImpl:bG,linSpaceImpl:SG,logImpl:CG,maxImpl:$G,maximumImpl:TG,minimumImpl:kG,multiplyImpl:EI,negImpl:NG,notEqualImpl:EG,prodImpl:RG,raggedGatherImpl:LG,raggedRangeImpl:BG,raggedTensorToTensorImpl:VG,rangeImpl:MG,rsqrtImpl:zG,scatterImpl:UG,sigmoidImpl:WG,sliceImpl:GG,sparseFillEmptyRowsImpl:jG,sparseReshapeImpl:HG,sparseSegmentReductionImpl:KG,sqrtImpl:qG,squaredDifferenceImpl:XG,stridedSliceImpl:YG,stringNGramsImpl:ZG,stringSplitImpl:e8,stringToHashBucketFastImpl:t8,subImpl:n8,tileImpl:r8,topKImpl:s8,transposeImpl:IG,uniqueImpl:o8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:i8,bincountImpl:RI,bincountReduceImpl:l8,castImpl:u8,ceilImpl:c8,concatImpl:d8,equalImpl:p8,expImpl:f8,expm1Impl:h8,floorImpl:m8,gatherNdImpl:g8,gatherV2Impl:y8,greaterImpl:x8,greaterEqualImpl:v8,lessImpl:w8,lessEqualImpl:b8,linSpaceImpl:S8,logImpl:C8,maxImpl:$8,maximumImpl:T8,minimumImpl:k8,multiplyImpl:N8,negImpl:E8,notEqualImpl:I8,prodImpl:R8,raggedGatherImpl:_8,raggedRangeImpl:A8,raggedTensorToTensorImpl:O8,rangeImpl:D8,rsqrtImpl:P8,scatterImpl:F8,sigmoidImpl:L8,simpleAbsImpl:_I,sliceImpl:B8,sparseFillEmptyRowsImpl:V8,sparseReshapeImpl:M8,sparseSegmentReductionImpl:AI,sqrtImpl:z8,stridedSliceImpl:U8,stringNGramsImpl:W8,stringSplitImpl:G8,stringToHashBucketFastImpl:j8,subImpl:H8,tileImpl:K8,topKImpl:q8,transposeImpl:E1,uniqueImpl:X8}=a8;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OI(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ht(t,e){return e===1?[t]:OI(t,e)}function Y8(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q8{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=wt(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ht("rc",this.rank),r=ve(this.rank),s=this.getOutOfBoundsCondition(n),o=this.getSetup(n),a=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)o=`${e[e.length-1-a]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DI{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Z8(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?k1():T1(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Z8(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Y6(["r","c","d"],"inputShape"):fo(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J8{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,n,r){const s=$b(n,r),o=Tb(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const a=Cb(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[o].shift();return this.usedTextures[o].push(l),l}let i;return s===qe.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===qe.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===qe.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===qe.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===qe.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(i),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),i}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const o=$b(r,s),a=Tb(n,o,s);a in this.freeTextures||(this.freeTextures[a]=[]);const i=Cb(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=_().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const u=this.usedTextures[a],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function ej(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Cb(t,e,n,r,s){const o=tj(e,r);let a;if(s){const[l,u]=ka(t[0],t[1]);a=l*u}else{const[l,u]=Rl(t[0],t[1]);a=l*u}const i=ej(n,o);return a*i}function tj(t,e){switch(t){case qe.PACKED_2X2_FLOAT32:return kI(e);case qe.PACKED_2X2_FLOAT16:return NI(e);case qe.UNPACKED_FLOAT32:return CI(e);case qe.UNPACKED_FLOAT16:return $I(e);case qe.PACKED_4X1_UNSIGNED_BYTE:return TI(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function nj(t){return _().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?qe.PACKED_2X2_FLOAT32:qe.UNPACKED_FLOAT32:t?qe.PACKED_2X2_FLOAT16:qe.UNPACKED_FLOAT16}function $b(t,e){if(t===Ut.UPLOAD)return qe.PACKED_2X2_FLOAT32;if(t===Ut.RENDER||t==null)return nj(e);if(t===Ut.DOWNLOAD||t===Ut.PIXELS)return qe.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function Tb(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ur{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const wn="if (isnan(x)) return x;",rj="return x;",kb="return abs(x);",sj="return (x >= 0.0) ? x : (exp(x) - 1.0);",oj=wn+`
  return (x < 0.0) ? 0.0 : x;
`,aj=wn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,xo="return x;",ij="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj="return x;",uj=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,cj=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dj=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pj="return 1.0 / (1.0 + exp(-1.0 * x));";class Os{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fj{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length);const n=e.length,r=ht("rc",n),s=ve(n),o=Y8(n,r),a=r.slice(-2),i=n<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${i}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hj=p1,mj=1e-7,gj=1e-4,yu={};function yj(t){return t in yu||(yu[t]={}),yu[t]}const xj=_().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),vj=600;function wj(){return _().global.screen==null?1024:_().global.screen.height*_().global.screen.width*window.devicePixelRatio*vj/1024/1024}class Kd extends yg{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!_().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Kp)n=e;else{const r=Dn(_().getNumber("WEBGL_VERSION"),e);n=new Kp(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Dn(_().getNumber("WEBGL_VERSION"));n=new Kp(r),this.binaryCache=yj(_().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new J8(this.gpgpu),this.numMBBeforeWarning=wj(),this.texData=new X$(this,er())}nextDataId(){return Kd.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,o,a){const i=this.makeTensorInfo(n,r),l=this.texData.get(i.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,o]},l.texShape=[s,o];const u=mu(n),c=new xb(u,!1,a),d=this.runWebGLProgram(c,[i],r,[[s,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(i),d.dataId}write(e,n,r){if((_().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||_().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:Ut.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,o){if(_().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:Ut.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:a,shape:i,isPacked:l}=n;if(a!=null){let p;l?p=new Os(i,xo):p=new ur(i,xo);const f=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:s}],s),h=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),h}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=tn());let d;if(s==="complex64"){const p=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);d=Rh(p,f)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=tn()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const h=this.pendingRead.get(e);return new Promise(g=>h.push(g))}const n=this.texData.get(e),{values:r,shape:s,slice:o,dtype:a,complexTensorInfos:i,isPacked:l}=n;if(o!=null){let h;l?h=new Os(s,xo):h=new ur(s,xo);const g=this.runWebGLProgram(h,[{dataId:e,shape:s,dtype:a}],a),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(_().getBool("DEBUG")&&!_().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&_().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(a!=="complex64"&&_().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const h=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(h.texture.texture,...pu(s))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(a==="complex64"){const h=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]),g=h[0],y=h[1];d=Rh(g,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const h=M(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,h)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const h=this.gpgpu.gl;q(h,()=>h.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(h=>h(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&er().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:o,slice:a,dtype:i,isPacked:l,texture:u}=r;if(i==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let f;l?f=new Os(o,xo):f=new ur(o,xo);const h=this.runWebGLProgram(f,[{dataId:e,shape:o,dtype:i}],i),g=this.readToGPU(h,n);return this.disposeIntermediateTensorInfo(h),g}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=er().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Xs(s));return Ee(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ee(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!C6(r))throw _().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),o=M(n);if(_().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),f=this.texData.get(p.dataId),h=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...pu(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(p),h}const a=_().getBool("WEBGL_PACK")&&s===!0,i=a?mu(n):n,l=a?new V5(i):new B5(i),u=this.runWebGLProgram(l,[{shape:i,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return _().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=xr(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=xr(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);i.kernelMs=Q$(l),i.getExtraProfileInfo=()=>l.map((u,c)=>({name:a[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return _().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:tn(),endMs:null}}endTimer(e){return _().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=tn(),e)}async getQueryTime(e){if(_().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:o,isPacked:a,slice:i}=this.texData.get(e),l=i&&i.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,o,a)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=xj){return _().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&M(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){sn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return hj(e.shape,n)}packedUnaryOp(e,n,r){const s=new Os(e.shape,n),o=this.compileAndRun(s,[e],r);return er().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=_I(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(_().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,kb,e.dtype);const n=new ur(e.shape,kb),r=this.compileAndRun(n,[e]);return er().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&lr(r[0])){const o=r.map(a=>dr(a));s=this.write(o,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return er().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new fj(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Q8(e.shape),r=!0;return this.runWebGLProgram(n,[e],e.dtype,null,r)}packedReshape(e,n){const r=[ga(e.shape),...ya(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[ga(n),...ya(n)],a=new DI(o,r),i=!0,l=[r],u=this.runWebGLProgram(a,[s],e.dtype,l,i);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:a}=r;if(n!=null){const p=M(o),f=n[0]*n[1]*4;$(p<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const i=mu(o);let l;s?l=new L5(i):l=new F5(i);const u=!0,c=[n!=null?n:pu(i)],d=this.runWebGLProgram(l,[{shape:i,dtype:a,dataId:e}],a,c,u,n);return{dtype:a,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,r,s,o=!1,a){const i=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(i.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===tl.DENSE){const m=a!=null?a:pu(e.outputShape);l.texShape=m.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),M(i.shape)===0)return l.values=Kn(i.dtype,0),i;const u=[],c=n.map(m=>{if(m.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(m.dataId);if(x.texture==null){if(!e.packedInputs&&M(m.shape)<=_().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:m.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=m.shape)}if(this.uploadToGPU(m.dataId),!!x.isPacked!=!!e.packedInputs)m=x.isPacked?this.unpackTensor(m):this.packTensor(m),u.push(m),x=this.texData.get(m.dataId);else if(x.isPacked&&!Bc(x.shape,m.shape)){const v=m,b=m.shape;m.shape=x.shape,m=this.packedReshape(m,b),u.push(m),x=this.texData.get(m.dataId),v.shape=b}return{shape:m.shape,texData:x,isUniform:!1}});this.uploadToGPU(i.dataId);const d={shape:i.shape,texData:l,isUniform:!1},p=P5(e,c,d),f=this.getAndSaveBinary(p,()=>O5(this.gpgpu,e,c,d)),h=this.activeTimers!=null;let g;h&&(g=this.startTimer()),_().get("ENGINE_COMPILE_ONLY")||D5(this.gpgpu,f,c,d,s),u.forEach(m=>this.disposeIntermediateTensorInfo(m)),h&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const y=_().get("WEBGL_FLUSH_THRESHOLD");if(y>0){const m=tn();m-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=m)}if(!_().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const m=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),m}return i}compileAndRun(e,n,r,s,o=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(_().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ie(()=>{if(!_().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=_().getBool("DEBUG");_().set("DEBUG",!1);const n=this.abs(oe(1e-8)).dataSync()[0];if(_().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?mj:gj}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:o,texture:a,usage:i,isPacked:l}=n;if(a!=null)return;const u=this.activeTimers!=null;let c;u&&(c=tn());let d=n.texShape;if(d==null&&(d=z6(r,l),n.texShape=d),o!=null){const p=mu(r);let f,h=d[1],g=d[0];const y=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!y)&&([h,g]=ka(d[0],d[1])),l?f=new z5(p,y):f=new xb(p,y);const m=y?[g,h]:d,x=this.makeTensorInfo(m,s),v=this.texData.get(x.dataId);y?v.usage=Ut.PIXELS:v.usage=Ut.UPLOAD,v.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),h,g,o);const b=[[g,h]],C=!0,k=this.runWebGLProgram(f,[x],s,b,C),I=this.texData.get(k.dataId);n.texShape=I.texShape,n.isPacked=I.isPacked,n.usage=I.usage,_().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=I.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(x),u&&(this.uploadWaitMs+=tn()-c)}else{const p=this.acquireTexture(d,i,s,l);n.texture=p}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return this.releaseGPUData(e),n!=null&&(r.values=bj(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Cc(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await AE(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(yI(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:r,infLoc:s,nanLoc:o,inShapesLocations:a,inTexShapesLocations:i,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:c}=SI(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.inShapesLocations=a,e.inTexShapesLocations=i,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=c}}createTensorFromTexture(e,n,r){const{texture:s,height:o,width:a,channels:i}=e,l=er().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,o,a,i);return er().makeTensorFromDataId(u,n,r,l)}}Kd.nextDataId=0;function bj(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fx()&&HT("webgl",()=>new Kd,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class xa{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=le(n,r),this.enableShapeUniforms=wt(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ol=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Dl{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=le(n,r);const o=this.outputShape.length;this.enableShapeUniforms=wt(o);let a="";if(s)if(o===0||M(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${ve(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ht("coords",o);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Sj={kernelName:$d,backendName:"webgl",kernelFunc:Lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(o.dataId),i=Lt({inputs:{x:r},backend:n}),l=Lt({inputs:{x:s},backend:n});return a.complexTensorInfos={real:i,imag:l},o}const Cj={kernelName:Wg,backendName:"webgl",kernelFunc:hs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PI="return (a < 0.) ? b * a : a;",FI=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function $j(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,a=n.makeTensorInfo([],"float32",uo(o,"float32")),i=_().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Dl(FI,s.shape,a.shape):new xa(PI,s.shape,a.shape),l=n.runWebGLProgram(i,[s,a],"float32");return n.disposeIntermediateTensorInfo(a),l}const Tj={kernelName:Ay,backendName:"webgl",kernelFunc:$j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LI="return (a < 0.) ? b * a : a;",BI=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function kj(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=_().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Dl(BI,r.shape,s.shape):new xa(LI,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],"float32")}const Nj={kernelName:c0,backendName:"webgl",kernelFunc:kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _a="if (isnan(x)) return x;";function ue({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:o})=>{const{x:a}=s,i=o,l=r||a.dtype;if(i.shouldExecuteOnCPU([a])&&n!=null){const d=i.texData.get(a.dataId),p=n(d.values,l);return i.makeTensorInfo(a.shape,l,p)}const u=_().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new Os(a.shape,e):c=new ur(a.shape,t),i.runWebGLProgram(c,[a],l)}}function Ze({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:a,backend:i})=>{const{a:l,b:u}=a,c=i;if(r&&l.dtype==="complex64"){const h=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[y,m]=[[h.complexTensorInfos.real,g.complexTensorInfos.real],[h.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(v=>{const[b,C]=v,k={dataId:b.dataId,dtype:b.dtype,shape:l.shape},I={dataId:C.dataId,dtype:C.dtype,shape:u.shape},R=new xa(t,l.shape,u.shape);return c.runWebGLProgram(R,[k,I],On(b.dtype,C.dtype))}),x=hs({inputs:{real:y,imag:m},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(m),x}const d=o||On(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const h=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,y=l.dtype==="string"?el(h):h,m=l.dtype==="string"?el(g):g,[x,v]=s(l.shape,u.shape,y,m,d),b=c.makeTensorInfo(v,d),C=c.texData.get(b.dataId);return C.values=x,b}const p=_().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return p?f=new Dl(e,l.shape,u.shape,n):f=new xa(t,l.shape,u.shape),c.runWebGLProgram(f,[l,u],d)}}function nl(t,e=!1){if(t==="linear")return e?lj:rj;if(t==="relu")return e?cj:oj;if(t==="elu")return e?uj:sj;if(t==="relu6")return e?dj:aj;if(t==="prelu")return e?BI:LI;if(t==="leakyrelu")return e?FI:PI;if(t==="sigmoid")return e?pj:ij;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VI{constructor(e,n,r,s=!1,o=!1,a=!1,i=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=wt(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),p=s?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",h=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",m="";i&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${i}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${i}
        }`:y=`vec4 activation(vec4 x) {
          ${i}
        }`,m="result = activation(result);");const x=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<n[0]?v=`int(min(float(rc.x), ${e[0]-1}.))`:n[0]<e[0]&&(b=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${d}; i++) {
          int batchA = ${v};
          int batchB = ${b};
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${g[0]});
          result += (${h[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${m}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nb={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Eb{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=le(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ib="return a * b;";function R1(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=On(r.dtype,s.dtype);if(r.dtype==="complex64"){const i=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new Eb(Nb.REAL,r.shape,s.shape),c=new Eb(Nb.IMAG,r.shape,s.shape),d=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:r.shape},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],p=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),h=hs({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),h}if(n.shouldExecuteOnCPU([r,s])){const i=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=N8(r.shape,s.shape,i.values,l.values,o),d=n.makeTensorInfo(c,o),p=n.texData.get(d.dataId);return p.values=u,d}let a;return _().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new Dl(Ib,r.shape,s.shape):a=new xa(Ib,r.shape,s.shape),n.runWebGLProgram(a,[r,s],o)}const Ej={kernelName:Jy,backendName:"webgl",kernelFunc:R1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(t,e,n){const r=[ga(t.shape),...ya(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},o=[ga(e),...ya(e)],a=new DI(o,r),i=!0,l=[r],u=n.runWebGLProgram(a,[s],t.dtype,l,i);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,a=n,i=M(s.shape),l=Z$(o,i),u=M(l);$(i===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`);const c=a.texData.get(s.dataId);return c.isPacked&&!Bc(s.shape,l)&&!(c.texture!==null&&Bc(c.shape,l))?Ij(s,l,a):(a.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const Rj={kernelName:v0,backendName:"webgl",kernelFunc:G};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rb{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:a}=e;this.outputShape=[s,a];const i=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Ks(d)?d.toPrecision(2):d}, ones);`}let c="";o%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${i};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _j{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:a}=e;this.outputShape=[s,a];let i="0.0",l="";n==="prod"?i="1.0":n==="min"?(i="1.0 / 1e-20",l="min"):n==="max"&&(i="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(i="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(i="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let h="";o%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${i};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${i});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aj(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=jd(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function mo(t,e,n,r){const s=Aj(t.shape);let o=t;for(let a=0;a<s.length;a++){const{inSize:i,windowSize:l,outSize:u}=s[a];let c,d;n==="mean"?c=a===0?new Rb({windowSize:l,inSize:i,batchSize:t.shape[0],outSize:u},i):new Rb({windowSize:l,inSize:i,batchSize:t.shape[0],outSize:u}):c=new _j({windowSize:l,inSize:i,batchSize:t.shape[0],outSize:u},n),d=o,o=r.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oj{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[n[a]];this.outputShape=r,this.rank=r.length;const s=ve(this.rank),o=Dj(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function Dj(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pj{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=ve(this.rank),o=OI("rc",this.rank),a=new Array(this.rank);for(let c=0;c<n.length;c++)a[n[c]]=o[c];const i=`vec2(${a.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${i})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(t,e,n){const r=_().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Pj(t.shape,e):new Oj(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fj(t,e,n,r){const s=e,o=t.shape.length,a=Ue(s,t.shape);let i=a;const l=xn(i,o),u=l!=null;let c=t;u&&(c=qd(t,l,r),i=vn(i.length,o)),Fn("sum",i,o);const[d,p]=Zn(c.shape,i);let f=d;n&&(f=Xt(d,a));const h=M(p),y=M(t.shape)/h,m=G({inputs:{x:c},attrs:{shape:[y,h]},backend:r}),x=kd(t.dtype),v=mo(m,x,"sum",r),b=G({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(v),u&&r.disposeIntermediateTensorInfo(c),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xd(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:a}=r;return Fj(s,o,a,n)}const Lj={kernelName:L0,backendName:"webgl",kernelFunc:Xd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,a=n,i=s.shape.length,l=new Array(i);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];let u;if(a.shouldExecuteOnCPU([s])){const d=a.texData.get(s.dataId).values,p=E1(d,s.shape,s.dtype,o,l);u=a.makeTensorInfo(l,s.dtype);const f=a.texData.get(u.dataId);f.values=p}else u=qd(s,o,a);return u}const Bj={kernelName:wi,backendName:"webgl",kernelFunc:xt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MI=1e3;function Mc({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],p=r?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],h=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),m=M(g),x=M(y),b=le(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,h]);$(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const C=n?[m,d,f]:[m,f,d],k=r?[x,h,p]:[x,p,h],I=G({inputs:{x:t},backend:s,attrs:{shape:C}}),R=G({inputs:{x:e},backend:s,attrs:{shape:k}}),D=[I,R],O=Math.max(m,x),V=n?I.shape[1]:I.shape[2],j=o!=null,Z=a!=null,J=l==="leakyrelu",re=l!=null?nl(l,!0):null,ne=j||Z||J||re!=null;let ce;if((f===1||h===1)&&V>MI&&ne===!1){let Y=I,z=R;n&&(Y=xt({inputs:{x:I},backend:s,attrs:{perm:[0,2,1]}}),D.push(Y)),r&&(z=xt({inputs:{x:R},backend:s,attrs:{perm:[0,2,1]}}),D.push(z));const F=h!==1,H=h===1;let de=Y;F&&(de=G({inputs:{x:Y},backend:s,attrs:{shape:[O,V,1]}}),D.push(de));const Ve=h===1?2:1;let Me=z;H&&(Me=G({inputs:{x:z},backend:s,attrs:{shape:[O,1,V]}}),D.push(Me));const Qt=R1({inputs:{a:de,b:Me},backend:s});ce=Xd({inputs:{x:Qt},backend:s,attrs:{axis:Ve,keepDims:!0}}),D.push(Qt)}else{const Y=On(t.dtype,e.dtype),z=new VI(C,k,[O,f,h],n,r,j,re,Z,J),F=[I,R];if(o!=null&&F.push(o),Z&&F.push(a),J){const H=s.makeTensorInfo([],"float32",uo(i,"float32"));F.push(H),D.push(H)}ce=s.runWebGLProgram(z,F,Y)}const L=G({inputs:{x:ce},backend:s,attrs:{shape:b}});D.push(ce);for(const Y of D)s.disposeIntermediateTensorInfo(Y);return L}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vj(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:a,preluActivationWeights:i}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return Mc({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:a,preluActivationWeights:i,leakyreluAlpha:d,activation:c})}const Mj={kernelName:Nc,backendName:"webgl",kernelFunc:Vj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _b="return abs(x);";function zj(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=n.texData.get(r.dataId),a=_I(o.values);return n.makeTensorInfo(r.shape,r.dtype,a)}let s;return _().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Os(r.shape,_b):s=new ur(r.shape,_b),n.runWebGLProgram(s,[r],r.dtype)}const Uj={kernelName:Sg,backendName:"webgl",kernelFunc:zj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wj=wn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Gj=ue({opSnippet:Wj}),jj={kernelName:Cg,backendName:"webgl",kernelFunc:Gj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hj=wn+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Kj=ue({opSnippet:Hj}),qj={kernelName:$g,backendName:"webgl",kernelFunc:Kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ab="return a + b;",Xj=Ze({opSnippet:Ab,packedOpSnippet:Ab,supportsComplex:!0,cpuKernelImpl:i8}),Yj={kernelName:Sd,backendName:"webgl",kernelFunc:Xj};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qj{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,a)=>`T${a}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zj{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,a)=>`T${a}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lu(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Lt({inputs:{x:r[0]},backend:n});if(r.length>_().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Lu({inputs:r.slice(0,l),backend:n}),c=Lu({inputs:r.slice(l),backend:n});return Lu({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>On(l,u)),o=r.map(l=>l.shape),i=_().getBool("WEBGL_PACK")?new Zj(r[0].shape,o):new Qj(r[0].shape,o);return n.runWebGLProgram(i,r,s)}const Jj={kernelName:Tg,backendName:"webgl",kernelFunc:Lu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:a}=r,i=s.shape.length,l=Ue(o,s.shape);let u=l;const c=xn(u,i);let d=s;c!=null&&(d=xt({inputs:{x:s},backend:n,attrs:{perm:c}}),u=vn(u.length,i)),Fn("all",u,i);const[p,f]=Zn(d.shape,u),h=M(f),g=G({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}}),y=mo(g,g.dtype,"all",n);let m;if(a){const x=Xt(p,l);m=G({inputs:{x:y},backend:n,attrs:{shape:x}})}else m=G({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const tH={kernelName:kg,backendName:"webgl",kernelFunc:eH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:a}=r,i=s.shape.length,l=Ue(o,s.shape);let u=l;const c=xn(u,i);let d=s;c!=null&&(d=xt({inputs:{x:s},backend:n,attrs:{perm:c}}),u=vn(u.length,i)),Fn("any",u,i);const[p,f]=Zn(d.shape,u),h=M(f),g=G({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}}),y=mo(g,g.dtype,"any",n);let m;if(a){const x=Xt(p,l);m=G({inputs:{x:y},backend:n,attrs:{shape:x}})}else m=G({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const rH={kernelName:Ng,backendName:"webgl",kernelFunc:nH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sH{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:a}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];const i=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${i} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oH{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,$(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],a=Math.ceil(o/n);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),s||this.variableNames.push("bestIndicesA");const i=this.outputShape,l=i.length,u=ve(l),c=ht("coords",l);let d,p;if(a===1){p=l+1;const R=ve(p);d=`
        ${R} sourceLocR = ${R}(${c.join()}, 0);
        ++${c[l-1]};
        ${R} sourceLocG = ${R}(${c.join()}, 0);
        ++${c[l-2]};
        ${R} sourceLocA = ${R}(${c.join()}, 0);
        --${c[l-1]};
        ${R} sourceLocB = ${R}(${c.join()}, 0);
        --${c[l-2]};`}else p=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,p),h="."+f[p-1],g=f.map(R=>"int "+R),y=ht("sourceLocR",p-1).concat("inIdx.r"),m=ht("sourceLocG",p-1).concat("inIdx.g"),x=ht("sourceLocB",p-1).concat("inIdx.b"),v=ht("sourceLocA",p-1).concat("inIdx.a"),b=r==="max"?"greaterThan":"lessThan",C=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,k=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${m.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,I=s?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${I}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${i[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${i[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zI(t,e,n,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const a=jd(o),i={windowSize:a,inSize:o,batchSize:s,outSize:Math.ceil(o/a)},l=new sH(i,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=zI(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function UI(t,e,n,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],a=jd(o),i=new oH(s,a,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(i,l,"int32");if(u.shape.length===e.shape.length){const c=UI(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function WI(t,e,n,r){const s=[n];if(Fn("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!_().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],a=t.texData.get(e.dataId),i=a!==null&&a.isPacked;let l=e;i&&(l=t.unpackTensor(e),o.push(l));const[u,c]=Zn(l.shape,s),d=M(c),p=G({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(p);const f=zI(t,p,r);o.push(f);const h=G({inputs:{x:f},backend:t,attrs:{shape:u}});return o.forEach(g=>t.disposeIntermediateTensorInfo(g)),h}return UI(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let a=Ue(o,s.shape);const i=xn(a,s.shape.length);let l=s;const u=[];i!=null&&(l=xt({inputs:{x:s},backend:n,attrs:{perm:i}}),u.push(l),a=vn(a.length,l.shape.length)),Fn("argMax",[a[0]],l.shape.length);const c=WI(n,l,a[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const iH={kernelName:Eg,backendName:"webgl",kernelFunc:aH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let a=Ue(o,s.shape);const i=xn(a,s.shape.length);let l=s;const u=[];i!=null&&(l=xt({inputs:{x:s},backend:n,attrs:{perm:i}}),u.push(l),a=vn(a.length,l.shape.length)),Fn("argMin",[a[0]],l.shape.length);const c=WI(n,l,a[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const uH={kernelName:Ig,backendName:"webgl",kernelFunc:lH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cH=wn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,dH=ue({opSnippet:cH}),pH={kernelName:Rg,backendName:"webgl",kernelFunc:dH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fH=wn+"return log(x + sqrt(x * x + 1.0));",hH=ue({opSnippet:fH}),mH={kernelName:_g,backendName:"webgl",kernelFunc:hH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gH=wn+`
  return atan(x);
`,yH=ue({opSnippet:gH}),xH={kernelName:Ag,backendName:"webgl",kernelFunc:yH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH=I1+`
  return atan(a, b);
`,wH=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ol+`
  return result;
`,bH=Ze({opSnippet:vH,packedOpSnippet:wH}),SH={kernelName:Dg,backendName:"webgl",kernelFunc:bH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CH=wn+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,$H=ue({opSnippet:CH}),TH={kernelName:Og,backendName:"webgl",kernelFunc:$H};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rl{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,m=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(g||(x="-1.0 / 1e-20"),r){const R=">=";this.userCode=`
        const ivec2 strides = ivec2(${i}, ${l});
        const ivec2 pads = ivec2(${f}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${R} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?y:m:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / count");const C=Math.floor(a/4)*4,k=a%4,I=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${l});
      const ivec2 pads = ivec2(${f}, ${h});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${I}
          }

          int xC = xCCorner + ${C};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${I}
          }
        }
        setOutput(${b});
      }
    `}}class _1{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterDepth,h=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=e.padInfo.front,m=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg";let b="0.0";if(v||(b="-1.0 / 1e-20"),r){const O=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${i}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${m}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${O} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${h} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / count");const I=Math.floor(a/4)*4,R=a%4,D=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${i}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${m}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${I}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${D}
            }

            int xC = xCCorner + ${I};
            if (${R===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${R===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${R===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${D}
            }
          }
          setOutput(${k});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;_l(s,"avgPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=r,u=1;$(Vt(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=co(s.shape,o,a,u,i,l);if(c.filterWidth===1&&c.filterHeight===1&&Ne(c.inShape,c.outShape))return Lt({inputs:{x:s},backend:n});const d=new rl(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const NH={kernelName:Pg,backendName:"webgl",kernelFunc:kH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:a,pad:i,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=bl(s.shape,o,a,c,i,l,u),p=new _1(d,"avg",!1);return n.runWebGLProgram(p,[s],"float32")}const IH={kernelName:Fg,backendName:"webgl",kernelFunc:EH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RH{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,p=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${i}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class _H{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=d-1-e.padInfo.front,g=p-1-e.padInfo.top,y=f-1-e.padInfo.left,m=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${g}, ${y});
      const float avgMultiplier = float(${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,a=o,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=bl(a.shape,i,l,d,u,c),f=new _H(p);return n.runWebGLProgram(f,[s],a.dtype)}const OH={kernelName:uT,backendName:"webgl",kernelFunc:AH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DH(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,a=o;_l([s,o],"avgPoolGrad");const{filterSize:i,strides:l,pad:u}=r,c=co(a.shape,i,l,1,u),d=new RH(c);return n.runWebGLProgram(d,[s],a.dtype)}const PH={kernelName:lT,backendName:"webgl",kernelFunc:DH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:a,transposeB:i}=r;return Mc({a:s,b:o,transposeA:a,transposeB:i,backend:n})}const LH={kernelName:Lg,backendName:"webgl",kernelFunc:FH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BH{constructor(e,n,r,s,o,a){this.outputShape=[],this.variableNames=["x","mean","variance"],le(e,n),le(e,r);let i="0.0";s!=null&&(le(e,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let l="1.0";o!=null&&(le(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${i};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VH{constructor(e,n,r,s,o,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],le(e,n),le(e,r);let i="vec4(0.0)";s!=null&&(le(e,s),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(le(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${i};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:o,offset:a,scale:i}=t;$(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),$(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),$(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,o];let c=null;a!=null&&(c=a.shape,u.push(a));let d=null;i!=null&&(d=i.shape,u.push(i));const p=_().getBool("WEBGL_PACK_NORMALIZATION")?new VH(r.shape,s.shape,o.shape,c,d,l):new BH(r.shape,s.shape,o.shape,c,d,l);return e.runWebGLProgram(p,u,u[0].dtype)},zH={kernelName:Sy,backendName:"webgl",kernelFunc:MH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UH{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=ve(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=WH(this.rank);let s;const o=e.map((a,i)=>`sourceLoc.${Oh[i]} = start[${i}] + coords.${Oh[i]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Oh=["x","y","z","w","u","v"];function WH(t){if(t===1)return"sourceLoc";if(t<=6)return Oh.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GH{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=ve(this.rank),r=ht("coords",this.rank),s=ht("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,a=`getChannel(getSource(${s.join()}), ${o})`,i=`
      result.x = ${a};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${a};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${a};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${a};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${i}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(t,e,n,r){const s=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),a=r.texData.get(o.dataId);Object.assign(a,s),a.refCount=1,a.shape=n,a.dtype=t.dtype;let i=Ex(e,He(t.shape));s.slice&&(i+=s.slice.flatOffset),a.slice={flatOffset:i,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,l+1),o}function Aa(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:a}=r,[i,l]=ok(s,o,a);if(XT(s,i,l),M(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),p=B8(d.values,i,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,p)}const{isPacked:u}=n.texData.get(s.dataId),c=Nx(s.shape,i,l);if(u||!c){const d=_().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new GH(l):new UH(l),p=[i];return n.runWebGLProgram(d,[s],s.dtype,p)}return n.uploadToGPU(s.dataId),jH(s,i,l,n)}const HH={kernelName:R0,backendName:"webgl",kernelFunc:Aa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KH=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:a}=r;$(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=o.reduce((x,v)=>x*v),l=b1(s.shape,o,i),u=S1(l.length,o.length),c=C1(s.shape,o,i),d=VE(a,o.length),p=ME(c,a,o.length),f=[],h=G({inputs:{x:s},backend:n,attrs:{shape:l}}),g=xt({inputs:{x:h},backend:n,attrs:{perm:u}}),y=G({inputs:{x:g},backend:n,attrs:{shape:c}}),m=Aa({inputs:{x:y},backend:n,attrs:{begin:d,size:p}});return f.push(h),f.push(g),f.push(y),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),m},qH={kernelName:Bg,backendName:"webgl",kernelFunc:KH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:a}=r,i=n.readSync(s.dataId),l=n.readSync(o.dataId),u=RI(i,l,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,u)}const YH={kernelName:Vg,backendName:"webgl",kernelFunc:XH};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),i=le(Array.from(o),Array.from(a));return n.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const ZH={kernelName:Mg,backendName:"webgl",kernelFunc:QH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JH="return float(a != b);",GI=Ze({opSnippet:JH,cpuKernelImpl:I8,dtype:"bool"}),e7={kernelName:t0,backendName:"webgl",kernelFunc:GI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pl(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Lt({inputs:{x:s.complexTensorInfos.real},backend:n})}const t7={kernelName:g0,backendName:"webgl",kernelFunc:Pl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7="return float(int(x));";function r7(t,e){const n=new ur(t.shape,n7),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dh(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Lt({inputs:{x:s},backend:n});const a=br(s.shape),i=Dh({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=hs({inputs:{real:i,imag:a},backend:n});return a.dispose(),n.disposeIntermediateTensorInfo(i),l}if(s.dtype==="complex64"){const a=Pl({inputs:{input:s},backend:n}),i=Dh({inputs:{x:a},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(a),i}if(!tT(s.dtype,o)){const a=Lt({inputs:{x:s},backend:n});return{dataId:a.dataId,shape:a.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const a=n.texData.get(s.dataId).values,[i,l,u]=u8(a,s.shape,s.dtype,o);return n.makeTensorInfo(i,l,u)}if(o==="int32")return r7(s,n);if(o==="bool"){const a=n.makeTensorInfo([],"bool",Kn("bool",1)),l=GI({inputs:{a:s,b:a},backend:n});return n.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const s7={kernelName:Cd,backendName:"webgl",kernelFunc:Dh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ob="return ceil(x);",o7=ue({opSnippet:Ob,packedOpSnippet:Ob,cpuKernelImpl:c8}),a7={kernelName:zg,backendName:"webgl",kernelFunc:o7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i7{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l7{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:a}=r;let i;_().getBool("WEBGL_PACK_CLIP")?i=new l7(s.shape):i=new i7(s.shape);const l=[[o],[a]];return n.runWebGLProgram(i,[s],s.dtype,l)}const c7={kernelName:Ug,backendName:"webgl",kernelFunc:u7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d7{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Db(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function p7(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),o=new d7(r.shape),a=[Db(r,s.complexTensorInfos.real),Db(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(o,a,a[0].dtype)}const f7={kernelName:Gg,backendName:"webgl",kernelFunc:p7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h7{constructor(e){this.outputShape=[],this.outputShape=eo(e,1),this.variableNames=e.map((a,i)=>`T${i}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let a=1;a<n.length;a++)n[a]=n[a-1]+e[a][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<n.length;a++){const i=n[a-1];r.push(`else if (yC < ${n[a]}) setOutput(getT${a}(yR, yC-${i}));`)}const s=n.length,o=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m7{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=eo(e,n);const r=this.outputShape,s=r.length,o=ve(s),a=ht("coords",s),i=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((g,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const u=i[n],c=i.slice(-2),d=i.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const y=l[g-1];p+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${xu(i,u,y)}),
            vec2(${xu(c,u,y)}));
        }`}const f=l.length,h=l[l.length-1];p+=`
        return getChannel(
          getT${f}(${xu(i,u,h)}),
          vec2(${xu(c,u,h)}));`,this.userCode=`
      float getValue(${i.map(g=>"int "+g)}) {
        ${p}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[s-1]} = ${a[s-1]} + 1;
        if (${a[s-1]} < ${r[s-1]}) {
          result.g = getValue(${a});
        }

        ${a[s-2]} = ${a[s-2]} + 1;
        if (${a[s-2]} < ${r[s-2]}) {
          result.a = getValue(${a});
        }

        ${a[s-1]} = ${a[s-1]} - 1;
        if (${a[s-2]} < ${r[s-2]} &&
            ${a[s-1]} < ${r[s-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function xu(t,e,n){const r=t.indexOf(e);return t.map((o,a)=>a===r?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yd(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Lt({inputs:{x:s.complexTensorInfos.imag},backend:n})}const g7={kernelName:Ey,backendName:"webgl",kernelFunc:Yd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(t,e,n){const r=t[0].dtype;if(r==="complex64"){const d=t.map(y=>Pl({inputs:{input:y},backend:n})),p=t.map(y=>Yd({inputs:{input:y},backend:n})),f=ni(d,e,n),h=ni(p,e,n),g=hs({inputs:{real:f,imag:h},backend:n});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const d=t.map(x=>{const b=[-1,M(x.shape.slice(e))];return G({inputs:{x},backend:n,attrs:{shape:b}})}),p=d.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),f=eo(d.map(x=>x.shape),1),h=d[0].shape[0]===1,g=d8(p,f,r,h),y=eo(t.map(x=>x.shape),e),m=n.makeTensorInfo(y,r,g);return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),m}const o=_().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>o){const d=[];for(let f=0;f<t.length;f+=o){const h=t.slice(f,f+o);d.push(ni(h,e,n))}const p=ni(d,e,n);for(const f of d)n.disposeIntermediateTensorInfo(f);return p}if(_().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const d=new m7(t.map(p=>p.shape),e);return n.runWebGLProgram(d,t,r)}const{tensors2D:a,outShape:i}=y7(t,e,n),l=new h7(a.map(d=>d.shape)),u=n.runWebGLProgram(l,a,r);a.forEach(d=>n.disposeIntermediateTensorInfo(d));const c=G({inputs:{x:u},attrs:{shape:i},backend:n});return n.disposeIntermediateTensorInfo(u),c}function y7(t,e,n){const r=eo(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>G({inputs:{x:o},attrs:{shape:[-1,M(o.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jI(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Ue(s,e[0].shape)[0],a=e.map(u=>u.shape);OE(a,o);const i=eo(e.map(u=>u.shape),o);if(M(i)===0)return n.makeTensorInfo(i,e[0].dtype,[]);const l=e.filter(u=>M(u.shape)>0);return l.length===1?Lt({inputs:{x:l[0]},backend:n}):ni(l,o,n)}const x7={kernelName:jg,backendName:"webgl",kernelFunc:jI};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HI{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,i=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,h=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,y=e.dataFormat==="channelsLast",m=y?1:2,x=y?2:3,v=y?3:1;let b="",C="";r&&(s?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:b=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${a}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${m}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${C}
        setOutput(result);
      }
    `}}class v7{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,f=e.filterWidth,h=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${a}, ${i});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KI{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=wt(this.outputShape.length);const a=e.padInfo.left,i=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)p+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)p+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const m=y*2;if(p+=`
           xC = xCCorner + ${m*l};
           `,i===1){if(m<c&&(a%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }
               `,l===1&&m>0?p+=`
                 xC${m} = vec4(xTexelC${m-2}.zw, xTexelC${m}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${m} = vec4(previous.zw, xTexelC${m}.xy);
                   } else {
                     xC${m} = vec4(0.0, 0.0, xTexelC${m}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xC${m} = xTexelC${m};
                 `,m+1<c)){const x=a%2===0?wd(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                     xTexelC${m+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${m+1}.zw = vec2(0.0);
                     }
                     xTexelC${m+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${m+1} = vec4(previous.zw, xTexelC${m+1}.xy);
                     } else {
                      xC${m+1} = vec4(0.0, 0.0, xTexelC${m+1}.xy);
                     }
                     `:p+=`
                     xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.xy);
                     `):x===1?p+=`
                     xC${m+1} = xTexelC${m};
                     `:p+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                       xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${m+1}.zw = vec2(0.0);
                       }
                       xTexelC${m+1}Ready = 1;
                     }

                     xC${m+1} = xTexelC${m+1};
                     `}}else m<c&&(a%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.0);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
               `,m+1<c&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${m+1} = vec4(xTexelC${m+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(
                   xTexelC${m}.xy, xTexelC${m+1}.xy);
               `,m+1<c&&(p+=`
                   xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
                 `)));m<c&&(p+=`
             wTexel = getW(r, ${m}, d1, d2);
             dotProd += xC${m}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${m}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,m+1<c&&(p+=`
               wTexel = getW(r, ${m+1}, d1, d2);
               dotProd += xC${m+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${m+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let f="",h="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,h="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${h}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w7{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=wt(this.outputShape.length);const{dataFormat:r}=n,s=vt(),o=r==="channelsLast",a=o?1:2,i=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${i}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zc(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function qI({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:i=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,f=n.dataFormat==="channelsLast",h=!1,g=!1;let y;const m=[];if(o!=null){const b=zc(o.shape,f);b!=null&&(o=G({inputs:{x:o},backend:r,attrs:{shape:b}}),m.push(o))}if(s!=null){const b=zc(s.shape,f);b!=null&&(s=G({inputs:{x:s},backend:r,attrs:{shape:b}}),m.push(s))}if(!((d===1||p===1)&&c>MI)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&Ne(u.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},k=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,$(Bc(u.shape,C.shape),()=>`packed reshape ${u.shape} to ${C.shape} isn't free`);const I=G({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});m.push(I);const R=Mc({a:C,b:I,backend:r,transposeA:h,transposeB:g,bias:s,activation:i,preluActivationWeights:o,leakyreluAlpha:a}),D=r.texData.get(R.dataId);$(D.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=k,D.shape=n.outShape,y=Lt({inputs:{x:R},backend:r}),y.shape=n.outShape,m.push(R)}else{const b=n.outHeight*n.outWidth,C=G({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),k=G({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),I=Mc({a:f?C:k,b:f?k:C,transposeA:!f,transposeB:g,backend:r,bias:s,activation:i,preluActivationWeights:o,leakyreluAlpha:a});y=G({inputs:{x:I},backend:r,attrs:{shape:n.outShape}}),m.push(C),m.push(k),m.push(I)}for(const b of m)r.disposeIntermediateTensorInfo(b);return y}function XI({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:i=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:p,dataFormat:f}=n,h=f==="channelsLast",g=l*u*c,y=p*d,m=[n.batchSize,g,y],x=!0,v=!1,b=[];if(o!=null){const L=zc(o.shape,h);L!=null&&(o=G({inputs:{x:o},backend:r,attrs:{shape:L}}),b.push(o))}if(s!=null){const L=zc(s.shape,h);L!=null&&(s=G({inputs:{x:s},backend:r,attrs:{shape:L}}),b.push(s))}const C=G({inputs:{x:e},backend:r,attrs:{shape:[1,g,M(e.shape)/g]}});b.push(C);const k=new w7(m,n),I=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],R=r.runWebGLProgram(k,[t],"float32",I),D=G({inputs:{x:R},backend:r,attrs:{shape:m}});b.push(R),b.push(D);const O=s!=null,V=o!=null,j=i==="leakyrelu",Z=i?nl(i,!0):null,J=new VI(h?D.shape:C.shape,h?C.shape:D.shape,h?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],x,v,O,Z,V,j),re=h?[D,C]:[C,D];if(s&&re.push(s),V&&re.push(o),j){const L=r.makeTensorInfo([],"float32",uo(a,"float32"));re.push(L),b.push(L)}const ne=r.runWebGLProgram(J,re,"float32"),ce=G({inputs:{x:ne},backend:r,attrs:{shape:n.outShape}});b.push(ne);for(const L of b)r.disposeIntermediateTensorInfo(L);return ce}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:a,pad:i,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Sa(l),p=qt(s.shape,o.shape,a,u,i,c,!1,d);let f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=qI({x:s,filter:o,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&_().getBool("WEBGL_EXP_CONV")){const g=new KI(p),y=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=n.runWebGLProgram(g,[s,o],"float32",y)}else if(_().getBool("WEBGL_CONV_IM2COL"))f=XI({x:s,filter:o,convInfo:p,backend:n});else{const g=new HI(p);f=n.runWebGLProgram(g,[s,o],"float32")}const h=G({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),h}const S7={kernelName:Hg,backendName:"webgl",kernelFunc:b7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C7{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${a}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $7{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,a=e.dataFormat==="channelsLast",i=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=a?1:2,c=a?2:3,d=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class T7{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,a=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${i};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class k7{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:a,pad:i,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Sa(l),p=qt(s.shape,c,a,1,i,u,!1,d),f=new C7(p);return n.runWebGLProgram(f,[s,o],"float32")}const E7={kernelName:Kg,backendName:"webgl",kernelFunc:N7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:a,strides:i,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Sa(u),p=qt(a,o.shape,i,1,l,c,!1,d),f=new $7(p);return n.runWebGLProgram(f,[s,o],"float32")}const R7={kernelName:qg,backendName:"webgl",kernelFunc:I7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l}=r,u=Sl(s.shape,o.shape,a,l,i),c=new v7(u);return n.runWebGLProgram(c,[s,o],"float32")}const A7={kernelName:Xg,backendName:"webgl",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:a,pad:i,filterShape:l}=r,u=Sl(s.shape,l,a,1,i),c=new T7(u);return n.runWebGLProgram(c,[s,o],"float32")}const D7={kernelName:cT,backendName:"webgl",kernelFunc:O7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:a,strides:i,inputShape:l}=r,u=Sl(l,o.shape,i,1,a),c=new k7(u);return n.runWebGLProgram(c,[s,o],"float32")}const F7={kernelName:Yg,backendName:"webgl",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7=_a+`
  return cos(x);
`,B7=ue({opSnippet:L7}),V7={kernelName:Qg,backendName:"webgl",kernelFunc:B7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,z7=ue({opSnippet:M7}),U7={kernelName:Zg,backendName:"webgl",kernelFunc:z7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W7{constructor(e,n,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,i,l,u]=e,[c]=n,[d,p]=r;this.outputShape=[c,d,p,u];const f=s==="bilinear"?1:0,[h,g]=[`${i-1}.0`,`${l-1}.0`],[y,m,x]=d>1?[`${(i-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[v,b,C]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G7=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:a}=e,{cropSize:i,method:l,extrapolationValue:u}=r,c=new W7(s.shape,o.shape,i,l,u);return n.runWebGLProgram(c,[s,o,a],"float32")},j7={kernelName:ty,backendName:"webgl",kernelFunc:G7};var sl;(function(t){t.Prod="*",t.Sum="+"})(sl||(sl={}));class Pb{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,a=this.op===sl.Prod?"1.0":"0.0",i=r?a:`getX(${Fb(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${ve(o)} coords = getOutputCoords();
        int end = ${Lb(o,"coords",this.op)};
        float val = ${i};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${Lb(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${Fb(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Fb(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function Lb(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YI(t,e,n,r,s,o){const a=e.shape.length,i=xn([r],a);let l=e;i!=null&&(l=xt({inputs:{x:e},backend:n,attrs:{perm:i}}));const u=vn(1,a)[0];if(u!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Lt({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){const f=new Pb(t,l.shape,!1,o),h=[[p]],g=d;d=n.runWebGLProgram(f,[d],d.dtype,h),n.disposeIntermediateTensorInfo(g)}if(s){const p=new Pb(t,l.shape,s,o),f=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(i!=null){const p=Vx(i),f=xt({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:a,reverse:i}=r;return YI(sl.Prod,s,n,o,a,i)}const K7={kernelName:Jg,backendName:"webgl",kernelFunc:H7};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:a,reverse:i}=r;return YI(sl.Sum,s,n,o,a,i)}const X7={kernelName:ey,backendName:"webgl",kernelFunc:q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:a,binaryOutput:i}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=RI(l,u,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(o),c=l8(l,u,a,i);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Q7={kernelName:ny,backendName:"webgl",kernelFunc:Y7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z7{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J7(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:a}=r,i=s.shape[0],l=a==="NHWC"?s.shape[1]:s.shape[2],u=a==="NHWC"?s.shape[2]:s.shape[3],c=a==="NHWC"?s.shape[3]:s.shape[1],d=l*o,p=u*o,f=c/(o*o),h=a==="NHWC"?[i,d,p,f]:[i,f,d,p],g=new Z7(h,o,a);return n.runWebGLProgram(g,[s],s.dtype)}const e9={kernelName:ry,backendName:"webgl",kernelFunc:J7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QI{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=wt(this.outputShape.length);const a=e.filterHeight,i=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${i}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZI{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=wt(this.outputShape.length);const a=e.outChannels/e.inChannels,i=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,p=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<d;m++)f+=`
          vec4 xTexelC${m*2};
          int xTexelC${m*2}Ready;
          vec4 xTexelC${m*2+1};
          int xTexelC${m*2+1}Ready;
          vec4 xC${m};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let m=0;m<d;m++)f+=`
          xTexelC${m*2} = vec4(0.0);
          xTexelC${m*2}Ready = 0;
          xTexelC${m*2+1} = vec4(0.0);
          xTexelC${m*2+1}Ready = 0;
          xC${m} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let m=0;m<(p+1)/2;m++){const x=m*2;if(f+=`
          xC = xCCorner + ${x*u};
          `,l===1){if(x<d&&(i%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,u===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const v=i%2===0?wd(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(i%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let h="",g="";r&&(s?h=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?h=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:h=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),$(Vt(a,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const d=qt(s.shape,o.shape,a,c,i,u,!0);let p;_().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new ZI(d):p=new QI(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[s,o],"float32",f)}const n9={kernelName:sy,backendName:"webgl",kernelFunc:t9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class s9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,a=n-1-e.padInfo.top,i=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:a,dilations:i,pad:l,dimRoundingMode:u,filterShape:c}=r,d=qt(s.shape,c,a,i,l,u,!0),p=new r9(d);return n.runWebGLProgram(p,[s,o],"float32")}const a9={kernelName:oy,backendName:"webgl",kernelFunc:o9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:a,dilations:i,pad:l,dimRoundingMode:u,inputShape:c}=r,d=qt(c,o.shape,a,i,l,u,!0),p=new s9(d);return n.runWebGLProgram(p,[s,o],"float32")}const l9={kernelName:ay,backendName:"webgl",kernelFunc:i9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u9{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=M(r.shape),a=G({inputs:{x:r},backend:n,attrs:{shape:[o]}}),i=new u9(o),l=n.runWebGLProgram(i,[a],a.dtype),u=G({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const d9={kernelName:iy,backendName:"webgl",kernelFunc:c9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p9{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:o,strideWidth:a,filterHeight:i,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:p}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${a});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${i}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:a,pad:i,dilations:l}=r,u=Ck(s.shape,o.shape,a,i,"NHWC",l);let c;const d=new p9(u);c=n.runWebGLProgram(d,[s,o],"float32");const p=G({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}const h9={kernelName:ly,backendName:"webgl",kernelFunc:f9};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:a,summedDims:i,idDims:l}=XE(s,o.length);QE(a.length,l,o);const{path:u,steps:c}=ZE(i,l),d=c.length;let p=null,f=a.length;const h=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:m,expandDims:x}=YE(f,l[y]);let v;JE(m)?v=o[y]:(v=xt({inputs:{x:o[y]},backend:n,attrs:{perm:m}}),h.push(v));const b=v.shape.slice();for(let C=0;C<x.length;++C)b.splice(x[C],0,1);Ne(v.shape,b)||(v=G({inputs:{x:v},backend:n,attrs:{shape:b}}),h.push(v)),p===null?p=v:(p=R1({inputs:{a:v,b:p},backend:n}),h.push(p))}g<d-1&&(u[g]>=0&&(p=Xd({inputs:{x:p},backend:n,attrs:{axis:u[g]-(a.length-f),keepDims:!1}}),h.push(p)),f--)}for(const g of h)g!==p&&n.disposeIntermediateTensorInfo(g);return p}const g9={kernelName:cy,backendName:"webgl",kernelFunc:m9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9="return (x >= 0.0) ? x : (exp(x) - 1.0);",x9=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,v9=ue({opSnippet:y9,packedOpSnippet:x9}),w9={kernelName:dy,backendName:"webgl",kernelFunc:v9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b9="return (b >= 1.0) ? a : a * (b + 1.0);",S9=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,C9=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=_().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Dl(S9,r.shape,s.shape):new xa(b9,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],r.dtype)},$9={kernelName:dT,backendName:"webgl",kernelFunc:C9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T9=`
  return vec4(equal(a, b));
`,k9="return float(a == b);",N9=Ze({opSnippet:k9,packedOpSnippet:T9,dtype:"bool",cpuKernelImpl:p8}),E9={kernelName:fy,backendName:"webgl",kernelFunc:N9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I9=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${WE};
  float a1 = ${GE};
  float a2 = ${jE};
  float a3 = ${HE};
  float a4 = ${KE};
  float a5 = ${qE};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,R9=ue({opSnippet:I9}),_9={kernelName:py,backendName:"webgl",kernelFunc:R9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9=_a+`
  return exp(x);
`,O9=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,JI=ue({opSnippet:A9,packedOpSnippet:O9,cpuKernelImpl:f8,dtype:"float32"}),D9={kernelName:hy,backendName:"webgl",kernelFunc:JI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ph(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,a=o.shape.length,i=o.shape.slice();let l=s;return s<0&&($(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+s+1),i.splice(l,0,1),G({inputs:{x:o},backend:r,attrs:{shape:i}})}const P9={kernelName:my,backendName:"webgl",kernelFunc:Ph};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bb="return exp(x) - 1.0;",F9=ue({opSnippet:Bb,packedOpSnippet:Bb,cpuKernelImpl:h8}),L9={kernelName:gy,backendName:"webgl",kernelFunc:F9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vb{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=r?`${s}.0`:"1.0";let i;if(e==="real")i="return real * expR - imag * expI;";else if(e==="imag")i="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${i}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eR(t,e,n){const r=n.texData.get(t.dataId),s=M(t.shape),o=t.shape[t.shape.length-1],a=s/o,i=G({inputs:{x:t},backend:n,attrs:{shape:[a,o]}}),l=i.shape,u=new Vb("real",l,e),c=new Vb("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),h=hs({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);const g=G({inputs:{x:h},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(h),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(t){const{inputs:e,backend:n}=t,{input:r}=e;return eR(r,!1,n)}const V9={kernelName:yy,backendName:"webgl",kernelFunc:B9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M9{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fl(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||gl(s),o==="string"){const a=Xe(o,M(r));return a.fill(s),e.makeTensorInfo(r,o,a)}else{const a=new M9(r,s),i=[[s]];return e.runWebGLProgram(a,[],o,i)}}const z9={kernelName:xy,backendName:"webgl",kernelFunc:Fl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U9{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W9={kernelName:vy,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new U9(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mb="return floor(x);",G9=ue({opSnippet:Mb,packedOpSnippet:Mb,cpuKernelImpl:m8}),j9={kernelName:wy,backendName:"webgl",kernelFunc:G9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H9=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,K9=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,q9=Ze({opSnippet:H9,packedOpSnippet:K9,dtype:"int32"}),X9={kernelName:by,backendName:"webgl",kernelFunc:q9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y9{constructor(e){this.variableNames=["A"];const n=vt(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q9{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=vt(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z9={kernelName:kc,backendName:"webgl",kernelFunc:J9};let vo,qp=_().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function J9(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r,a=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,i=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,o];if(i||a){const g=_().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(vo==null||g!==qp)&&(qp=g,vo=document.createElement("canvas").getContext("2d",{willReadFrequently:qp})),vo.canvas.width=l,vo.canvas.height=u,vo.drawImage(s,0,0,l,u),s=vo.canvas}const p=n.makeTensorInfo(c,"int32");n.texData.get(p.dataId).usage=Ut.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),s);const f=_().getBool("WEBGL_PACK")?new Q9(d):new Y9(d),h=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:a,preluActivationWeights:i}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:h}=r,g=Sa(c),y=qt(s.shape,o.shape,l,d,u,p,!1,g);let m;const x=[],v=a!=null,b=i!=null,C=f==="leakyrelu",k=()=>{const R=[s,o],D=(O,V)=>{if(V==="NCHW"&&O.shape.length===1&&O.shape[0]!==1){const j=G({inputs:{x:O},backend:n,attrs:{shape:[O.shape[0],1,1]}});return x.push(j),j}return O};if(v&&R.push(D(a,c)),b&&R.push(D(i,c)),C){const O=n.makeTensorInfo([],"float32",uo(h,"float32"));R.push(O),x.push(O)}return R};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))m=qI({x:s,filter:o,convInfo:y,backend:n,bias:a,activation:f,preluActivationWeights:i,leakyreluAlpha:h});else if(y.strideWidth<=2&&g==="channelsLast"&&_().getBool("WEBGL_EXP_CONV")){const R=f?nl(f,!0):null,D=new KI(y,v,R,b,C),O=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],V=k();m=n.runWebGLProgram(D,V,"float32",O)}else if(_().getBool("WEBGL_CONV_IM2COL"))m=XI({x:s,filter:o,convInfo:y,backend:n,bias:a,activation:f,preluActivationWeights:i,leakyreluAlpha:h});else{const R=f?nl(f,!1):null,D=new HI(y,v,R,b,C),O=k();m=n.runWebGLProgram(D,O,"float32")}const I=G({inputs:{x:m},backend:n,attrs:{shape:y.outShape}});return x.push(m),x.forEach(R=>n.disposeIntermediateTensorInfo(R)),I}const tK={kernelName:Ec,backendName:"webgl",kernelFunc:eK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:a,preluActivationWeights:i}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,h=[];let g=c;g==null&&(g=[1,1]),$(Vt(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=qt(s.shape,o.shape,l,g,u,d,!0),m=_().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,x=p?nl(p,m):null,v=[s,o],b=a!=null,C=i!=null,k=p==="leakyrelu";if(b&&v.push(a),C&&v.push(i),k){const O=n.makeTensorInfo([],"float32",uo(f,"float32"));v.push(O),h.push(O)}let I;m?I=new ZI(y,b,x,C,k):I=new QI(y,b,x,C,k);const R=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],D=n.runWebGLProgram(I,v,"float32",R);return h.forEach(O=>n.disposeIntermediateTensorInfo(O)),D}const rK={kernelName:Ic,backendName:"webgl",kernelFunc:nK};class sK{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=ve(r.length);let a=`
    int index;`;for(let i=0;i<this.sliceDim;i++)a+=`
          index = round(getIndices(coords[0], ${i}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};
          flattenIndex += index * ${this.strides[i]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,a=o[o.length-1],i=M(r.shape),[l,u,c,d]=$x(r,s),p=G({inputs:{x:s},backend:n,attrs:{shape:[u,a]}}),f=G({inputs:{x:r},backend:n,attrs:{shape:[M(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const m=n.readSync(s.dataId),x=n.bufferSync(r),v=g8(m,x,r.dtype,u,a,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,v.values)}const h=new sK(a,d,[u,c],r.shape),g=n.runWebGLProgram(h,[f,p],f.dtype),y=G({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const aK={kernelName:$y,backendName:"webgl",kernelFunc:oK};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iK{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=ve(this.rank),s=lK(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function lK(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tR(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:a,batchDims:i}=r,l=Ue(a,s.shape)[0];if(_().get("DEBUG")){const x=n.readSync(o.dataId),v=s.shape[l];for(let b=0;b<x.length;++b){const C=x[b];$(C<=v-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${v-1}]`)}}const u=hI(s,o,l,i),c=M(o.shape),d=[],p=G({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=G({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(p),d.push(f);const h=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const x=n.bufferSync(f),v=n.bufferSync(p),b=y8(v,x,h);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(u.outputShape,b.dtype,b.values)}const g=new iK(p.shape,h),y=n.runWebGLProgram(g,[p,f],p.dtype);d.push(y);const m=G({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),m}const uK={kernelName:Cy,backendName:"webgl",kernelFunc:tR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cK="return float(a > b);",dK=`
  return vec4(greaterThan(a, b));
`,pK=Ze({opSnippet:cK,packedOpSnippet:dK,cpuKernelImpl:x8,dtype:"bool"}),fK={kernelName:Ty,backendName:"webgl",kernelFunc:pK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hK="return float(a >= b);",mK=`
  return vec4(greaterThanEqual(a, b));
`,gK=Ze({opSnippet:hK,packedOpSnippet:mK,dtype:"bool",cpuKernelImpl:v8}),yK={kernelName:ky,backendName:"webgl",kernelFunc:gK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xK(t){const{inputs:e,backend:n}=t,{input:r}=e;return eR(r,!0,n)}const vK={kernelName:Ny,backendName:"webgl",kernelFunc:xK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wK="return float(!isnan(x) && !isinf(x));",bK=ue({opSnippet:wK,dtype:"bool"}),SK={kernelName:Iy,backendName:"webgl",kernelFunc:bK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK="return float(isinf(x));",$K=ue({opSnippet:CK,dtype:"bool"}),TK={kernelName:Ry,backendName:"webgl",kernelFunc:$K};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK="return float(isnan(x));",NK=ue({opSnippet:kK,dtype:"bool"}),EK={kernelName:_y,backendName:"webgl",kernelFunc:NK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IK="return float(a < b);",RK=`
  return vec4(lessThan(a, b));
`,_K=Ze({opSnippet:IK,packedOpSnippet:RK,cpuKernelImpl:w8,dtype:"bool"}),AK={kernelName:Oy,backendName:"webgl",kernelFunc:_K};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK="return float(a <= b);",DK=`
  return vec4(lessThanEqual(a, b));
`,PK=Ze({opSnippet:OK,packedOpSnippet:DK,cpuKernelImpl:b8,dtype:"bool"}),FK={kernelName:Dy,backendName:"webgl",kernelFunc:PK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LK(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,a=S8(r,s,o);return e.makeTensorInfo([a.length],"float32",a)}const BK={kernelName:Py,backendName:"webgl",kernelFunc:LK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK=_a+`
  return x < 0.0 ? 0./0. : log(x);
`,MK=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,zK=ue({opSnippet:VK,packedOpSnippet:MK,cpuKernelImpl:C8}),UK={kernelName:Fy,backendName:"webgl",kernelFunc:zK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK=_a+`
  return log(1.0 + x);
`,GK=ue({opSnippet:WK}),jK={kernelName:Ly,backendName:"webgl",kernelFunc:GK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HK="return float(a >= 1.0 && b >= 1.0);",KK=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,qK=Ze({opSnippet:HK,packedOpSnippet:KK,dtype:"bool"}),XK={kernelName:By,backendName:"webgl",kernelFunc:qK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK="return float(!(x >= 1.0));",QK=ue({opSnippet:YK}),ZK={kernelName:Vy,backendName:"webgl",kernelFunc:QK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK="return float(a >= 1.0 || b >= 1.0);",eq=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,tq=Ze({opSnippet:JK,packedOpSnippet:eq,dtype:"bool"}),nq={kernelName:My,backendName:"webgl",kernelFunc:tq};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rq{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[];const a=n,i=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${i}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sq{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=n,i=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:a,alpha:i,beta:l}=r,u=_().getBool("WEBGL_PACK_NORMALIZATION")?new sq(s.shape,o,a,i,l):new rq(s.shape,o,a,i,l);return n.runWebGLProgram(u,[s],s.dtype)},aq={kernelName:zy,backendName:"webgl",kernelFunc:oq};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iq{constructor(e,n,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:a}=e,{depthRadius:i,bias:l,alpha:u,beta:c}=r,d=new iq(s.shape,i,l,u,c);return n.runWebGLProgram(d,[s,o,a],s.dtype)},uq={kernelName:pT,backendName:"webgl",kernelFunc:lq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(t,e,n,r){const s=M(e),a=M(t.shape)/s,i=G({inputs:{x:t},attrs:{shape:[a,s]},backend:r}),l=mo(i,t.dtype,"max",r),u=G({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nR(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:a}=r,i=s.shape.length,l=Ue(o,s.shape);let u=l;const c=xn(u,i),d=c!=null,p=n.shouldExecuteOnCPU([s]);let f=s;if(d){if(p){const v=n.texData.get(f.dataId).values,b=new Array(i);for(let I=0;I<b.length;I++)b[I]=s.shape[c[I]];const C=E1(v,s.shape,s.dtype,c,b);f=n.makeTensorInfo(b,s.dtype);const k=n.texData.get(f.dataId);k.values=C}else f=qd(s,c,n);u=vn(u.length,i)}Fn("max",u,i);const[h,g]=Zn(f.shape,u);let y=h;a&&(y=Xt(h,l));let m;if(p){const v=n.texData.get(f.dataId).values,b=$8(v,M(g),y,s.dtype);m=n.makeTensorInfo(y,s.dtype);const C=n.texData.get(m.dataId);C.values=b}else m=cq(f,g,y,n);return d&&n.disposeIntermediateTensorInfo(f),m}const dq={kernelName:Uy,backendName:"webgl",kernelFunc:nR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pq=I1+`
  return max(a, b);
`,fq=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ol+`
  return result;
`,hq=Ze({opSnippet:pq,packedOpSnippet:fq,cpuKernelImpl:T8}),mq={kernelName:Wy,backendName:"webgl",kernelFunc:hq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;_l(s,"maxPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:l}=r,u=1;$(Vt(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=co(s.shape,o,a,u,i,l);if(c.filterWidth===1&&c.filterHeight===1&&Ne(c.inShape,c.outShape))return Lt({inputs:{x:s},backend:n});const d=new rl(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const yq={kernelName:Gy,backendName:"webgl",kernelFunc:gq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:a,pad:i,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=bl(s.shape,o,a,c,i,u,l),p=new _1(d,"max",!1);return n.runWebGLProgram(p,[s],s.dtype)}const vq={kernelName:jy,backendName:"webgl",kernelFunc:xq};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wq{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,a=e.effectiveFilterWidth,i=o-1-e.padInfo.top,l=a-1-e.padInfo.left,u=o*a-1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class bq{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,i=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=u-1-e.padInfo.top,f=c-1-e.padInfo.left,h=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${i}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,a=o,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=bl(a.shape,i,l,d,u,c),f=new _1(p,"max",!0),h=n.runWebGLProgram(f,[a],a.dtype),g=new bq(p),y=n.runWebGLProgram(g,[s,h],a.dtype);return n.disposeIntermediateTensorInfo(h),y}const Cq={kernelName:hT,backendName:"webgl",kernelFunc:Sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:a}=e,i=o;_l([o,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=co(i.shape,l,u,1,c,d),f=!0,h=new rl(p,"max",f),g=n.runWebGLProgram(h,[i],i.dtype),y=new wq(p),m=n.runWebGLProgram(y,[s,g],i.dtype);return n.disposeIntermediateTensorInfo(g),m}const Tq={kernelName:fT,backendName:"webgl",kernelFunc:$q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(t,e,n,r){let s=new rl(n,"max",!1);const o=r.runWebGLProgram(s,[t],"float32");s=new rl(n,"max",!0,!0,e);const a=r.runWebGLProgram(s,[t],"float32");return[o,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq={kernelName:Hy,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:a,includeBatchInIndex:i}=e,l=n;$(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];$(Vt(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=co(r.shape,s,o,u,a),[d,p]=kq(r,i,c,l);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t,e,n,r){const s=M(e),a=M(t.shape)/s,i=G({inputs:{x:t},attrs:{shape:[a,s]},backend:r}),l=mo(i,"float32","mean",r),u=G({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iq={kernelName:Ky,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:o}=e,a=n,i=r.shape.length,l=Ue(o,r.shape);let u=l;const c=xn(u,i),d=c!=null,p=a.shouldExecuteOnCPU([r]),f=[];let h=r;if(d){if(p){const b=a.texData.get(h.dataId).values,C=new Array(i);for(let R=0;R<C.length;R++)C[R]=r.shape[c[R]];const k=E1(b,r.shape,r.dtype,c,C);h=a.makeTensorInfo(C,r.dtype);const I=a.texData.get(h.dataId);I.values=k}else h=qd(r,c,a);f.push(h),u=vn(u.length,i)}Fn("sum",u,i);const[g,y]=Zn(h.shape,u);let m=g;s&&(m=Xt(g,l));const x=Eq(h,y,m,a);for(const v of f)a.disposeIntermediateTensorInfo(v);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:a}=r,i=s.shape.length,l=Ue(o,s.shape);let u=l;const c=xn(u,i);let d=s;c!=null&&(d=xt({inputs:{x:s},backend:n,attrs:{perm:c}}),u=vn(u.length,s.shape.length)),Fn("min",u,i);const[p,f]=Zn(d.shape,u),h=M(f),g=G({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}}),y=mo(g,g.dtype,"min",n);let m;if(a){const x=Xt(p,l);m=G({inputs:{x:y},backend:n,attrs:{shape:x}})}else m=G({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const _q={kernelName:qy,backendName:"webgl",kernelFunc:Rq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq=I1+`
  return min(a, b);
`,Oq=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ol+`
  return result;
`,Dq=Ze({opSnippet:Aq,packedOpSnippet:Oq,cpuKernelImpl:k8}),Pq={kernelName:Xy,backendName:"webgl",kernelFunc:Dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fq{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,o=ve(s),a=n.map(c=>c[0]).join(","),i=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${a};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${a});
      ${o} end = ${o}(${i});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lq{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((h,g)=>h[0]+e[g]+h[1]);const s=e.length,o=ve(s),a=n.map(h=>h[0]).join(","),i=n.map((h,g)=>h[0]+e[g]).join(","),l=ht("rc",s),u=ht("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,p=r==="reflect"?0:1;let f="";if(s===1){const h=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${h}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const h=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${h}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${h}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${h}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${a});
      const ${o} end = ${o}(${i});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bq=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:o}=n,a=_().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lq(r.shape,s,o):new Fq(r.shape,s,o);return e.runWebGLProgram(a,[r],r.dtype)},Vq={kernelName:Yy,backendName:"webgl",kernelFunc:Bq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mq=`if (b == 0.0) return NAN;
  return mod(a, b);`,zq=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Ol+`
  return result;
`,Uq=Ze({opSnippet:Mq,packedOpSnippet:zq}),Wq={kernelName:Qy,backendName:"webgl",kernelFunc:Uq};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gq{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jq=`
if (a == b) {
  return 1.0;
};
return a / b;`,Hq=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,rR=Ze({opSnippet:jq,packedOpSnippet:Hq,checkOutOfBounds:!0}),Kq={kernelName:uy,backendName:"webgl",kernelFunc:rR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zb="return a - b;",sR=Ze({opSnippet:zb,packedOpSnippet:zb,supportsComplex:!0,cpuKernelImpl:H8}),qq={kernelName:Q0,backendName:"webgl",kernelFunc:sR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oR(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,a=Ue([o],s.shape),i=nR({inputs:{x:s},backend:n,attrs:{reductionIndices:a,keepDims:!1}}),l=Xt(i.shape,a),u=G({inputs:{x:i},backend:n,attrs:{shape:l}}),c=sR({inputs:{a:s,b:u},backend:n}),d=JI({inputs:{x:c},backend:n}),p=Xd({inputs:{x:d},backend:n,attrs:{axis:a,keepDims:!1}}),f=G({inputs:{x:p},backend:n,attrs:{shape:l}}),h=rR({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),h}const Xq={kernelName:M0,backendName:"webgl",kernelFunc:oR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:a,normalized:i}=r,l=i?s:oR({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Gq(u,c,o),p=[[a]],f=n.runWebGLProgram(d,[l],"int32",p);return i||n.disposeIntermediateTensorInfo(l),f}const Qq={kernelName:Zy,backendName:"webgl",kernelFunc:Yq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zq=wn+`
  return -x;
`,Jq=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function eX(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId),[a,i]=E8(o.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,a)}let s;return _().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Os(r.shape,Jq):s=new ur(r.shape,Zq),n.runWebGLProgram(s,[r],r.dtype)}const tX={kernelName:e0,backendName:"webgl",kernelFunc:eX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX=m1;function rX(t){sn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=nX(u,c,a,i,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const sX={kernelName:n0,backendName:"webgl",kernelFunc:rX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX=g1;function aX(t){sn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),{selectedIndices:p,validOutputs:f}=oX(c,d,a,i,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const iX={kernelName:r0,backendName:"webgl",kernelFunc:aX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX=y1;function uX(t){sn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),p=a,f=i,h=l,g=u,{selectedIndices:y,selectedScores:m}=lX(c,d,p,f,h,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const cX={kernelName:s0,backendName:"webgl",kernelFunc:uX};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dX{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:a,onValue:i,offValue:l}=r,u=M(s.shape),c=new dX(u,a,i,l),d=G({inputs:{x:s},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const f=[...s.shape,a],h=G({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(p),h},fX={kernelName:a0,backendName:"webgl",kernelFunc:pX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uc(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Pl({inputs:{input:r},backend:n}),o=Uc({inputs:{x:s},backend:n}),a=Yd({inputs:{input:r},backend:n}),i=Uc({inputs:{x:a},backend:n}),l=hs({inputs:{real:o,imag:i},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),l}else return Fl({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const hX={kernelName:ox,backendName:"webgl",kernelFunc:Uc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aR(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Pl({inputs:{input:r},backend:n}),o=aR({inputs:{x:s},backend:n}),a=Yd({inputs:{input:r},backend:n}),i=Uc({inputs:{x:a},backend:n}),l=hs({inputs:{real:o,imag:i},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),l}else return Fl({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const mX={kernelName:o0,backendName:"webgl",kernelFunc:aR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Ph({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,a=e[0].dtype;e.forEach(c=>{at(o,c.shape,"All tensors passed to stack must have matching shapes"),$(a===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],l=e.map(c=>{const d=Ph({inputs:{input:c},backend:n,attrs:{dim:s}});return i.push(d),d}),u=jI({inputs:l,backend:n,attrs:{axis:s}});return i.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const yX={kernelName:i0,backendName:"webgl",kernelFunc:gX};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xX{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,o=ve(s),a=n.map(u=>u[0]).join(","),i=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${a};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${a});
      ${o} end = ${o}(${i});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vX{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const s=e.length,o=ve(s),a=n.map(g=>g[0]).join(","),i=n.map((g,y)=>g[0]+e[y]).join(","),l=ht("rc",s),u=ht("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let h="";for(let g=0,y=s===1?2:4;g<y;g++)h+=`
        ${p[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${d});
        }
      `;h+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${a});
      const ${o} end = ${o}(${i});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iR=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:a}=r;if(M(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return Fl({backend:n,attrs:{shape:u,value:a,dtype:s.dtype}})}const i=_().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vX(s.shape,o,a):new xX(s.shape,o,a),l=[[a]];return n.runWebGLProgram(i,[s],s.dtype,l)},wX={kernelName:l0,backendName:"webgl",kernelFunc:iR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,SX=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Ol+`
  return result;
`,CX=Ze({opSnippet:bX,packedOpSnippet:SX}),$X={kernelName:u0,backendName:"webgl",kernelFunc:CX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:a}=r,i=s.shape.length,l=[],u=Ue(o,s.shape);let c=u;const d=xn(c,i);let p=s;d!=null&&(p=xt({inputs:{x:s},backend:n,attrs:{perm:d}}),c=vn(c.length,i),l.push(p)),Fn("prod",c,i);let f;if(n.shouldExecuteOnCPU([p])){const h=n.texData.get(p.dataId).values,{outVals:g,outShape:y,outDtype:m}=R8(p.shape,p.dtype,h,c);f=n.makeTensorInfo(y,m,g)}else{const[h,g]=Zn(p.shape,c),y=M(g),m=G({inputs:{x:p},backend:n,attrs:{shape:[-1,y]}}),x=kd(s.dtype),v=mo(m,x,"prod",n);f=G({inputs:{x:v},backend:n,attrs:{shape:h}}),l.push(m),l.push(v)}if(a){l.push(f);const h=Xt(f.shape,u);f=G({inputs:{x:f},backend:n,attrs:{shape:h}})}return l.forEach(h=>n.disposeIntermediateTensorInfo(h)),f}const kX={kernelName:d0,backendName:"webgl",kernelFunc:TX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:a}=e,{outputRaggedRank:i}=r,l=s.map(m=>n.readSync(m.dataId)),u=s.map(m=>m.shape),c=n.readSync(o.dataId),d=n.readSync(a.dataId),[p,f,h]=_8(l,u,c,o.shape,o.dtype,d,a.shape,i),g=p.map(m=>n.makeTensorInfo([m.length],"int32",m)),y=n.makeTensorInfo(h,o.dtype,f);return g.concat([y])}const EX={kernelName:p0,backendName:"webgl",kernelFunc:NX};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IX(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,a=n.readSync(r.dataId),i=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=A8(a,r.shape,r.dtype,i,s.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],r.dtype,c);return[d,p]}const RX={kernelName:f0,backendName:"webgl",kernelFunc:IX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _X(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:a,rowPartitionTensors:i}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),d=n.readSync(a.dataId),p=i.map(y=>n.readSync(y.dataId)),f=i.map(y=>y.shape),[h,g]=O8(u,s.shape,c,o.shape,o.dtype,d,a.shape,p,f,l);return n.makeTensorInfo(h,o.dtype,g)}const AX={kernelName:h0,backendName:"webgl",kernelFunc:_X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lR=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:a}=n,i=D8(r,s,o,a);return e.makeTensorInfo([i.length],a,i)},OX={kernelName:m0,backendName:"webgl",kernelFunc:lR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX="return 1.0 / x;",PX=ue({opSnippet:DX}),FX={kernelName:y0,backendName:"webgl",kernelFunc:PX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX=wn+`
  return (x < 0.0) ? 0.0 : x;
`,BX=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,VX=ue({opSnippet:LX,packedOpSnippet:BX}),MX={kernelName:x0,backendName:"webgl",kernelFunc:VX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX=wn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,UX=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,WX=ue({opSnippet:zX,packedOpSnippet:UX}),GX={kernelName:S0,backendName:"webgl",kernelFunc:WX};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jX{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,n,r,u];const c=[s&&n>1?i-1:i,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let p;o?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HX{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,n,r,u];const c=[s&&n>1?i-1:i,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let p;o?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KX(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:a,size:i}=r,[l,u]=i,c=_().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new HX(s.shape,l,u,o,a):new jX(s.shape,l,u,o,a);return n.runWebGLProgram(c,[s],"float32")}const qX={kernelName:b0,backendName:"webgl",kernelFunc:KX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XX{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,a,i]=e,l=[r&&a>1?s-1:s,r&&i>1?o-1:o],u=[r&&a>1?a-1:a,r&&i>1?i-1:i],c=l[0]/u[0],d=l[1]/u[1],p=1/c,f=1/d,h=Math.ceil(p)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YX(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:a}=r,i=new XX(o.shape,s.shape,a);return n.runWebGLProgram(i,[o],o.dtype)}const QX={kernelName:gT,backendName:"webgl",kernelFunc:YX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZX{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,n,r,u];const c=[s&&n>1?i-1:i,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],p=s?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JX{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,l,u]=e;this.outputShape=[a,n,r,u];const c=[s&&n>1?i-1:i,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],p=s?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eY(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:a,size:i}=r,[l,u]=i,c=_().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new JX(s.shape,l,u,o,a):new ZX(s.shape,l,u,o,a);return n.runWebGLProgram(c,[s],s.dtype)}const tY={kernelName:w0,backendName:"webgl",kernelFunc:eY};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nY{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,a,i]=e,l=[r&&a>1?s-1:s,r&&i>1?o-1:o],u=[r&&a>1?a-1:a,r&&i>1?i-1:i],c=l[0]/u[0],d=l[1]/u[1],p=1/c,f=1/d,h=Math.ceil(p)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rY(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:a}=r,i=new nY(o.shape,s.shape,a);return n.runWebGLProgram(i,[o],o.dtype)}const sY={kernelName:mT,backendName:"webgl",kernelFunc:rY};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oY{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=i=>n.indexOf(i)!==-1&&e[i]!==1?`${e[i]} - coords[${i}] - 1`:`coords[${i}]`,o=e.map((i,l)=>s(l)).join(","),a=ve(r);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aY{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=ht("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,a=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,i=ve(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${i} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${u(s.slice())};
          }
          if(${a}) {
            result.b = ${c(s.slice())};
            if(${o}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(h){return p(h)}function u(h){return h[r-1]="("+h[r-1]+" + 1)",p(h)}function c(h){return h[r-2]="("+h[r-2]+" + 1)",p(h)}function d(h){return h[r-1]="("+h[r-1]+" + 1)",h[r-2]="("+h[r-2]+" + 1)",p(h)}function p(h){const g=e.map((x,v)=>f(v,h)),y=g.join(","),m=g.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${m}))`}function f(h,g){return n.indexOf(h)!==-1&&e[h]!==1?`${e[h]} - ${g[h]} - 1`:`${g[h]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iY(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,a=s.shape.length,i=Ue(o,s.shape);if(a===0)return Lt({inputs:{x:s},backend:n});const l=_().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aY(s.shape,i):new oY(s.shape,i);return n.runWebGLProgram(l,[s],s.dtype)}const lY={kernelName:C0,backendName:"webgl",kernelFunc:iY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uY{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY={kernelName:ix,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:a}=e,i=n,l=new uY(r.shape,o),[u,c]=BE(a,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return i.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,pY=ue({opSnippet:dY}),fY={kernelName:$0,backendName:"webgl",kernelFunc:pY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY="return inversesqrt(x);",mY=ue({opSnippet:hY,cpuKernelImpl:P8}),gY={kernelName:T0,backendName:"webgl",kernelFunc:mY};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uR{constructor(e,n,r,s,o,a,i=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const l=ve(o.length),u=ve(a.length);let c="";r===1?c="i":r===2&&(c="i, j");const d=`getIndices(${c})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const f=`getUpdates(${p})`,h=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${h};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:a}=r,{sliceRank:i,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Nd(o,s,a),p=[d/u,u];if(d===0)return n.makeTensorInfo(a,s.dtype);const f=G({inputs:{x:s},backend:n,attrs:{shape:[l,i]}}),h=G({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),y=new uR(l,i,f.shape.length,h.shape.length,c,p),m=n.runWebGLProgram(y,[h,f,g],h.dtype),x=G({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const xY={kernelName:k0,backendName:"webgl",kernelFunc:yY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vY{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,i=_().getNumber("WEBGL_VERSION")===2?o:a,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wY(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:a}=r,i=new vY(s.shape[0],s.shape[1],o.shape[1],a),l=[[s.shape[1]]];return n.runWebGLProgram(i,[s,o],"int32",l)}const bY={kernelName:N0,backendName:"webgl",kernelFunc:wY};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SY{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const i=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${i[c]}`),c<e&&l.push(`${i[c]}`);s=l.join(),o=u.join()}const a=ve(r);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CY(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,a=new SY(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(a,[r,s,o],On(s.dtype,o.dtype))}const $Y={kernelName:E0,backendName:"webgl",kernelFunc:CY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TY=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${zE};
  float scale = ${UE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,kY=ue({opSnippet:TY}),NY={kernelName:I0,backendName:"webgl",kernelFunc:kY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EY=_a+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,IY=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,RY=ue({opSnippet:EY,packedOpSnippet:IY,cpuKernelImpl:L8}),_Y={kernelName:D0,backendName:"webgl",kernelFunc:RY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,OY=ue({opSnippet:AY}),DY={kernelName:O0,backendName:"webgl",kernelFunc:OY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY=_a+`
  return sin(x);
`,FY=ue({opSnippet:PY}),LY={kernelName:_0,backendName:"webgl",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,VY=ue({opSnippet:BY}),MY={kernelName:A0,backendName:"webgl",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,UY=ue({opSnippet:zY}),WY={kernelName:P0,backendName:"webgl",kernelFunc:UY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:a}=r;$(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=o.reduce((m,x)=>m*x),l=[[0,0]];l.push(...a);for(let m=1+o.length;m<s.shape.length;++m)l.push([0,0]);const u=[],c=iR({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=b1(c.shape,o,i,!1),p=S1(d.length,o.length,!1),f=C1(c.shape,o,i,!1),h=G({inputs:{x:c},backend:n,attrs:{shape:d}}),g=xt({inputs:{x:h},backend:n,attrs:{perm:p}}),y=G({inputs:{x:g},backend:n,attrs:{shape:f}});return u.push(c),u.push(h),u.push(g),u.forEach(m=>n.disposeIntermediateTensorInfo(m)),y},jY={kernelName:B0,backendName:"webgl",kernelFunc:GY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HY(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:a}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const i=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=n.readSync(a.dataId)[0],[d,p,f,h,g]=V8(i,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],s.dtype,f),n.makeTensorInfo([h.length],"bool",new Uint8Array(h.map(y=>Number(y)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const KY={kernelName:z0,backendName:"webgl",kernelFunc:HY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const a=Array.from(n.readSync(s.dataId)),i=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=M8(i,r.shape,r.dtype,a,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const XY={kernelName:U0,backendName:"webgl",kernelFunc:qY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YY(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const a=n.readSync(r.dataId),i=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=AI(a,r.shape,r.dtype,i,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const QY={kernelName:W0,backendName:"webgl",kernelFunc:YY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZY(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const a=n.readSync(r.dataId),i=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=AI(a,r.shape,r.dtype,i,l);return n.makeTensorInfo(c,r.dtype,u)}const JY={kernelName:G0,backendName:"webgl",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:a}=e,{outputShape:i}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=Nd(o,s,i),f=!1;if(o.dtype==="string"){const m=n.bufferSync(s),x=n.bufferSync(o),v=Xs(n.readSync(a.dataId)[0]),b=F8(m,x,i,p,c,u,l,d,v,f);return n.makeTensorInfo(i,b.dtype,b.values)}const h=new uR(u,l,s.shape.length,o.shape.length,d,[p,1],f),g=n.runWebGLProgram(h,[o,s,a],o.dtype),y=G({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(g),y}const tQ={kernelName:j0,backendName:"webgl",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:a}=r,i=Ue(a,s.shape)[0],l=eI(s,o,i),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(p=>{const f=[...d];f[i]=p;const h=Aa({inputs:{x:s},backend:n,attrs:{begin:c,size:f}});return c[i]+=p,h})}const rQ={kernelName:V0,backendName:"webgl",kernelFunc:nQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ub="return sqrt(x);",sQ=ue({opSnippet:Ub,packedOpSnippet:Ub,cpuKernelImpl:z8}),oQ={kernelName:F0,backendName:"webgl",kernelFunc:sQ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQ="return x * x;",iQ=ue({opSnippet:aQ}),lQ={kernelName:yT,backendName:"webgl",kernelFunc:iQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wb="return (a - b) * (a - b);",uQ=Ze({opSnippet:Wb,packedOpSnippet:Wb}),cQ={kernelName:H0,backendName:"webgl",kernelFunc:uQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=wn+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new ur(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const pQ={kernelName:ax,backendName:"webgl",kernelFunc:dQ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fQ{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=ve(r.length),a=ve(r.length);let i="";if(s===1)i="coords * strides + begin";else{let l=0;i=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:a,strides:i,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:h,isIdentity:g,sliceDim0:y,isSimpleSlice:m,begin:x,end:v,strides:b}=ak(s.shape,o,a,i,l,u,c,d,p);let C;if(g)C=G({inputs:{x:s},backend:n,attrs:{shape:h}});else if(y||m){$(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const I=YT(x,v,b),R=Aa({inputs:{x:s},backend:n,attrs:{begin:x,size:I}});C=G({inputs:{x:R},backend:n,attrs:{shape:h}}),n.disposeIntermediateTensorInfo(R)}else if(n.shouldExecuteOnCPU([s])){const R=n.readSync(s.dataId),D=Ee(s.shape,s.dtype,R),O=U8(f,D,b,x);C=n.makeTensorInfo(h,s.dtype,O.values)}else{const R=new fQ(x,b,f);C=n.runWebGLProgram(R,[s],s.dtype)}const k=G({inputs:{x:C},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(C),k}const mQ={kernelName:K0,backendName:"webgl",kernelFunc:hQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:a,rightPad:i,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,p=n.readSync(c.dataId),f=n.readSync(d.dataId),[h,g]=W8(p,f,s,o,a,i,l,u);return[n.makeTensorInfo([h.length],"string",h),n.makeTensorInfo(d.shape,"int32",g)]}const yQ={kernelName:q0,backendName:"webgl",kernelFunc:gQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:a}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const i=n.readSync(o.dataId),l=n.readSync(a.dataId)[0],[u,c,d]=G8(i,l,s),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const vQ={kernelName:X0,backendName:"webgl",kernelFunc:xQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wQ(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=n.readSync(o.dataId),i=j8(a,s);return n.makeTensorInfo(o.shape,"int32",i)}const bQ={kernelName:Y0,backendName:"webgl",kernelFunc:wQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ="return tan(x);",CQ=ue({opSnippet:SQ}),$Q={kernelName:Z0,backendName:"webgl",kernelFunc:CQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,kQ=ue({opSnippet:TQ}),NQ={kernelName:J0,backendName:"webgl",kernelFunc:kQ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EQ{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[a]*n[a];this.outputShape=r,this.rank=r.length;const s=ve(this.rank),o=IQ(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function IQ(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cR(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(p=>Xs(p)):l,c=Ee(s.shape,s.dtype,u),d=K8(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const a=new EQ(s.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}const RQ={kernelName:Td,backendName:"webgl",kernelFunc:cR};class _Q{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class AQ{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function Gb(t){let e=1;for(;e<t;)e*=2;return e}function OQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:a}=r,i=_().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=_().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<i||o>l){const O=n.readSync(s.dataId),[V,j]=q8(O,u,s.dtype,o,a);return[n.makeTensorInfo(V.shape,V.dtype,V.values),n.makeTensorInfo(j.shape,j.dtype,j.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,Fl({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),p=d!==null&&d.isPacked,f=p?n.unpackTensor(s):s,g=M(u)/c,y=G({inputs:{x:f},attrs:{shape:[g,c]},backend:n});p&&vs(n,f);const m=Gb(o),x=Gb(c);let v=null;const b=()=>v===null?[y,y]:[y,v],C=(O,V,j)=>{const Z=b(),J=new _Q(j),ne=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[O],[V]],ce=v;v=n.runWebGLProgram(J,Z,"int32",ne),vs(n,ce)};for(let O=1;O<m;O*=2){const V=O*2;for(let j=O;j>=1;j/=2)C(V,j,[g,x])}for(let O=x;O>m;O/=2){const V=b(),j=new AQ([g,O/2]),J=[[c],[v===null?1:0],[m]],re=v;v=n.runWebGLProgram(j,V,"int32",J),vs(n,re);const ne=m/2,ce=ne*2;for(let L=ne;L>=1;L/=2)C(ce,L,v.shape)}let k=v;v=Aa({inputs:{x:v},backend:n,attrs:{begin:0,size:[g,o]}}),vs(n,k);let I=tR({inputs:{x:y,indices:v},backend:n,attrs:{axis:1,batchDims:1}});vs(n,y);const R=u.slice(0,-1);R.push(o),k=v,v=G({inputs:{x:v},attrs:{shape:R},backend:n}),vs(n,k);const D=I;return I=G({inputs:{x:I},attrs:{shape:R},backend:n}),vs(n,D),[I,v]}const DQ={kernelName:ex,backendName:"webgl",kernelFunc:OQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PQ{constructor(e,n,r,s,o,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const i=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${i} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:a,fillMode:i,fillValue:l,outputShape:u}=r,[c,d,p,f]=s.shape,[h,g]=u!=null?u:[d,p],y=[c,h,g,f],m=new PQ(d,p,a,i,l,y);return n.runWebGLProgram(m,[s,o],"float32")}const LQ={kernelName:tx,backendName:"webgl",kernelFunc:FQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;_l(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(o.dataId),{outputValues:i,outputShape:l,indices:u}=X8(a,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,i),r.makeTensorInfo([u.length],"int32",u)]}const VQ={kernelName:nx,backendName:"webgl",kernelFunc:BQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const a=s,i=a.shape.length,l=s.shape[o],u=new Array(i-1);let c=0;for(let g=0;g<i;g++)g!==o&&(u[c++]=a.shape[g]);const d=[],p=new Array(i).fill(0),f=a.shape.slice();f[o]=1;const h=new Array(l);for(let g=0;g<h.length;g++){p[o]=g;const y=Aa({inputs:{x:a},backend:n,attrs:{begin:p,size:f}}),m=G({inputs:{x:y},backend:n,attrs:{shape:u}});h[g]=m,d.push(y)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),h}const zQ={kernelName:rx,backendName:"webgl",kernelFunc:MQ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UQ{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,a=e.numSegments,i=a*Math.ceil(o/r);this.outputShape=[s,i];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let f="";o%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let h="";o%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:a}=r,i=s.shape.length,l=[];let u=0;const c=xn([u],i);let d=s;c!=null&&(d=xt({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=vn(1,i)[0]);const p=fI(d.shape,u,a),f=M([d.shape[u]]),h=G({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(h);const g=kd(s.dtype),y=(b,C,k,I,R)=>{const D=b.shape[0],O=b.shape[1],V=pI(O,R),j={windowSize:V,inSize:O,batchSize:D,numSegments:R},Z=new UQ(j,C),J=n.compileAndRun(Z,[b,k],I);if(l.push(J),J.shape[1]===R)return J;const re=lR({backend:n,attrs:{start:0,stop:R,step:1,dtype:"float32"}}),ne=cR({inputs:{x:re},backend:n,attrs:{reps:[O/V]}});return l.push(re),l.push(ne),y(J,C,ne,I,R)},m=y(h,"unsortedSegmentSum",o,g,a),x=G({inputs:{x:m},backend:n,attrs:{shape:p}});let v=x;if(c!=null){l.push(x);const b=Vx(c);v=xt({inputs:{x:v},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const GQ={kernelName:sx,backendName:"webgl",kernelFunc:WQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ=[Mj,Uj,jj,qj,Yj,Jj,tH,rH,iH,uH,pH,mH,xH,SH,TH,NH,IH,OH,PH,LH,zH,qH,YH,ZH,s7,a7,c7,Cj,f7,x7,S7,E7,R7,A7,D7,F7,V7,U7,j7,K7,X7,Q7,e9,n9,a9,l9,d9,h9,g9,w9,$9,E9,_9,D9,P9,L9,V9,z9,W9,j9,X9,Z9,tK,rK,aK,uK,fK,yK,Sj,vK,g7,SK,TK,EK,Tj,AK,FK,BK,UK,jK,XK,ZK,nq,aq,uq,dq,mq,yq,vq,Cq,Tq,Nq,Iq,_q,Pq,Vq,Wq,Qq,Ej,tX,sX,iX,cX,e7,fX,mX,yX,wX,$X,Nj,kX,EX,RX,AX,OX,t7,Kq,FX,MX,GX,Rj,qX,QX,tY,sY,lY,cY,fY,gY,xY,bY,$Y,NY,_Y,DY,LY,MY,HH,Xq,WY,jY,KY,XY,QY,JY,tQ,rQ,oQ,lQ,cQ,pQ,mQ,yQ,vQ,bQ,qq,Lj,$Q,NQ,RQ,DQ,LQ,Bj,VQ,zQ,GQ,hX];for(const t of jQ)lx(t);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HQ=_();HQ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Jt;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Jt||(Jt={}));var jb;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(jb||(jb={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQ={};function dR(t){return KQ[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w(t,e,n,r,s){const o=e.inputParams[t];if(o&&o.inputIndexStart!==void 0){const i=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?i+1:o.inputIndexEnd;if(o.type==="tensor")return mt(e.inputNames[o.inputIndexStart],n,r,s);if(o.type==="tensors")return e.inputNames.slice(i,l).map(p=>mt(p,n,r,s));const u=mt(e.inputNames.slice(i)[0],n,r,s),c=u.dataSync();return o.type==="number"?c[0]:Ls(u.shape,c)}const a=e.attrParams[t];return a&&a.value}function mt(t,e,n,r){const[s,o]=Nt(t);if(r!=null){const i=r.getHashTableHandleByName(s);if(i!=null)return i}const a=n.currentContextIds.find(i=>!!e[Wc(s,i)]);return a!==void 0?e[Wc(s,a)][o]:void 0}function qQ(t,e,n){return e[Wc(t,n.currentContextId)]}function Mn(t,e){const[n,r,s]=Nt(t);return[Wc(n,e&&e.currentContextId),r,s]}function Wc(t,e){return e?`${t}-${e}`:t}function Nt(t){const e=t.split(":");if(e.length===1)return[t,0,void 0];const n=e[0],r=e.length===3?e[1]:void 0,s=Number(e[e.length-1]);return[n,s,r]}function Bu(t,e,n){let r=w("pad",t,e,n);if(r==="explicit"){r=w("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)s[o][0]=r[o*2],s[o][1]=r[o*2+1];return s}return r}function rr(t){return t.kept?t:pr(t)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XQ=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],YQ=Object.freeze(Object.defineProperty({__proto__:null,json:XQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QQ=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],ZQ=Object.freeze(Object.defineProperty({__proto__:null,json:QQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JQ=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],eZ=Object.freeze(Object.defineProperty({__proto__:null,json:JQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tZ=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],nZ=Object.freeze(Object.defineProperty({__proto__:null,json:tZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rZ=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],sZ=Object.freeze(Object.defineProperty({__proto__:null,json:rZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oZ=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],aZ=Object.freeze(Object.defineProperty({__proto__:null,json:oZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iZ=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],lZ=Object.freeze(Object.defineProperty({__proto__:null,json:iZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uZ=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],cZ=Object.freeze(Object.defineProperty({__proto__:null,json:uZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dZ=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],pZ=Object.freeze(Object.defineProperty({__proto__:null,json:dZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fZ=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],hZ=Object.freeze(Object.defineProperty({__proto__:null,json:fZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mZ=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],gZ=Object.freeze(Object.defineProperty({__proto__:null,json:mZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yZ=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],xZ=Object.freeze(Object.defineProperty({__proto__:null,json:yZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vZ=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],wZ=Object.freeze(Object.defineProperty({__proto__:null,json:vZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bZ=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],SZ=Object.freeze(Object.defineProperty({__proto__:null,json:bZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],$Z=Object.freeze(Object.defineProperty({__proto__:null,json:CZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZ=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],kZ=Object.freeze(Object.defineProperty({__proto__:null,json:TZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NZ=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],EZ=Object.freeze(Object.defineProperty({__proto__:null,json:NZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IZ=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],RZ=Object.freeze(Object.defineProperty({__proto__:null,json:IZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Z=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],AZ=Object.freeze(Object.defineProperty({__proto__:null,json:_Z},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hb{constructor(){const e=[YQ,ZQ,eZ,nZ,sZ,aZ,lZ,cZ,pZ,hZ,gZ,xZ,wZ,SZ,$Z,kZ,EZ,RZ,AZ],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}static get Instance(){return this._instance||(this._instance=new this)}transformGraph(e,n={}){const r=e.node,s=[],o=[],a=[],i=r.reduce((g,y)=>(g[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?s.push(g[y.name]):y.op==="Const"?o.push(g[y.name]):(y.input==null||y.input.length===0)&&a.push(g[y.name]),g),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(i);p.forEach(g=>{const y=i[g];y.inputNames.forEach((m,x)=>{const[v,,b]=Mn(m),C=i[v];if(C.outputs!=null){const k=C.outputs.indexOf(b);if(k!==-1){const I=`${v}:${k}`;y.inputNames[x]=I}}y.inputs.push(C),C.children.push(y)})}),Object.keys(d).length===0?p.forEach(g=>{const y=i[g];y.children.length===0&&u.push(y)}):Object.keys(d).forEach(g=>{const[y]=Mn(g),m=i[y];m!=null&&(m.signatureKey=d[g],u.push(m))}),Object.keys(c).length>0?Object.keys(c).forEach(g=>{const[y]=Mn(g),m=i[y];m&&(m.signatureKey=c[g],l.push(m))}):l=s;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((g,y)=>(g[y.signature.name]=this.mapFunction(y),g),{}));const h={nodes:i,inputs:l,outputs:u,weights:o,placeholders:s,signature:n,functions:f};return a.length>0&&(h.initNodes=a),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=dR(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,o)=>(s[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,o)=>{const a=o.type;let i;switch(o.type){case"string":i=Fh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Fh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":i=Wh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Wh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":i=Bh(e.attr,o.tfName,o.defaultValue||0),i===void 0&&!!o.tfDeprecatedName&&(i=Bh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":i=Uh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Uh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":i=Lh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Lh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":i=jh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=jh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":i=zh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=zh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":i=Gh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Gh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":i=Vh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Vh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":i=Mh(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Mh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":i=Kb(e.attr,o.tfName,o.defaultValue),i===void 0&&!!o.tfDeprecatedName&&(i=Kb(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return s[o.name]={value:i,type:a},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let o={};n!=null&&(o=n.reduce((d,p)=>(d[p.name]=this.mapNode(p),p.op==="Const"&&s.push(d[p.name]),d),{}));const a=[],i=[];e.signature.inputArg.forEach(d=>{const[p]=Mn(d.name),f={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:A1(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,a.push(f),o[p]=f}),Object.keys(o).forEach(d=>{const p=o[d];p.inputNames.forEach((f,h)=>{const[g,,y]=Mn(f),m=o[g];if(m.outputs!=null){const x=m.outputs.indexOf(y);if(x!==-1){const v=`${g}:${x}`;p.inputNames[h]=v}}p.inputs.push(m),m.children.push(p)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[p,f]=Mn(u[d.name]),h=o[p];h!=null&&(h.defaultOutput=f,i.push(h))});const c=this.mapArgsToSignature(e);return{nodes:o,inputs:a,outputs:i,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function OZ(t){const e=_().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function pR(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):OZ(t);return e?n:n.toLowerCase()}function Fh(t,e,n,r=!1){const s=t[e];return s!=null?pR(s.s,r):n}function Lh(t,e,n){const r=t[e];return r?r.b:n}function Bh(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function A1(t){switch(typeof t=="string"&&(t=Jt[t]),t){case Jt.DT_FLOAT:case Jt.DT_HALF:return"float32";case Jt.DT_INT32:case Jt.DT_INT64:case Jt.DT_INT8:case Jt.DT_UINT8:return"int32";case Jt.DT_BOOL:return"bool";case Jt.DT_DOUBLE:return"float32";case Jt.DT_STRING:return"string";default:return null}}function Kb(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function Vh(t,e,n){const r=t[e];return r&&r.type?A1(r.type):n}function Mh(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>A1(s)):n}function fR(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function zh(t,e,n){const r=t[e];return r&&r.shape?fR(r.shape):n}function Uh(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function Wh(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(o=>pR(o,r)):n}function Gh(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>fR(s)):n}function jh(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DZ{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,o)=>(s[o]=this.getAttr(o),s),{}))}getInput(e){return mt(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return mt(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return Bh(this.node.rawAttrs,e,n);if(r.s!=null)return Fh(this.node.rawAttrs,e,n);if(r.b!=null)return Lh(this.node.rawAttrs,e,n);if(r.shape!=null)return zh(this.node.rawAttrs,e,n);if(r.type!=null)return Vh(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return Uh(this.node.rawAttrs,e,n);if(r.list.s!=null)return Wh(this.node.rawAttrs,e,n);if(r.list.shape!=null)return Gh(this.node.rawAttrs,e,n);if(r.list.b!=null)return jh(this.node.rawAttrs,e,n);if(r.list.type!=null)return Mh(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const it=Object.freeze(Object.defineProperty({__proto__:null,abs:Et,acos:dk,acosh:pk,add:ee,addN:fk,all:hk,any:mk,argMax:gk,argMin:yk,asin:xk,asinh:vk,atan:wk,atan2:bk,atanh:Sk,avgPool:Ox,avgPool3d:$k,basicLSTMCell:Tk,batchToSpaceND:Dx,batchNorm:Cl,batchNorm2d:kk,batchNorm3d:Nk,batchNorm4d:Ek,bincount:Px,broadcastArgs:Ik,broadcastTo:Yo,buffer:Ee,cast:ke,ceil:Rk,clipByValue:_k,clone:pr,complex:wr,concat:st,concat1d:Ak,concat2d:Ok,concat3d:Dk,concat4d:Pk,conv1d:Fk,conv2d:$l,conv2dTranspose:Bk,conv3d:Vk,conv3dTranspose:Mk,cos:zk,cosh:Uk,cumprod:Wk,cumsum:Gk,denseBincount:jk,depthToSpace:Hk,depthwiseConv2d:Ed,diag:Kk,dilation2d:qk,div:xe,divNoNan:Xk,dot:Yk,einsum:Qk,elu:Lx,equal:Fx,erf:Zk,euclideanNorm:tN,exp:ss,expandDims:Or,expm1:nN,eye:Mx,fill:Ca,floor:zx,floorDiv:_x,gather:Ux,greater:kl,greaterEqual:Wx,imag:wl,isFinite:rN,isInf:sN,isNaN:oN,leakyRelu:Gx,less:aN,lessEqual:Id,linspace:iN,localResponseNormalization:lN,log:fa,log1p:jx,logSigmoid:cN,logSoftmax:dN,logSumExp:Kx,logicalAnd:Qi,logicalNot:qx,logicalOr:Xx,logicalXor:pN,lowerBound:fN,matMul:fe,max:Ms,maxPool:Yx,maxPool3d:hN,maxPoolWithArgmax:mN,maximum:Qx,mean:Zi,meshgrid:gN,min:Lc,minimum:Zx,mirrorPad:yN,mod:xN,moments:vN,mul:W,multiRNNCell:wN,multinomial:bN,neg:Hn,notEqual:Jx,oneHot:Dc,ones:Ur,onesLike:SN,outerProduct:CN,pad:$a,pad1d:$N,pad2d:TN,pad3d:kN,pad4d:NN,pool:EN,pow:pa,prelu:t1,print:xx,prod:IN,raggedGather:RN,raggedRange:_N,raggedTensorToTensor:AN,rand:ON,randomGamma:zN,randomNormal:s1,randomStandardNormal:UN,randomUniform:o1,range:ha,real:da,reciprocal:WN,relu:Nl,relu6:a1,reshape:P,reverse:os,reverse1d:GN,reverse2d:jN,reverse3d:HN,reverse4d:KN,round:i1,rsqrt:qN,scalar:oe,selu:XN,separableConv2d:YN,setdiff1dAsync:QN,sigmoid:Vs,sign:ZN,sin:JN,sinh:eE,slice:he,slice1d:tE,slice2d:nE,slice3d:rE,slice4d:sE,softmax:l1,softplus:Hx,spaceToBatchND:e1,fft:Ad,ifft:Ji,irfft:u1,rfft:Od,split:ma,sqrt:Xn,square:hn,squaredDifference:c1,squeeze:El,stack:Qn,step:d1,stridedSlice:oE,sub:se,sum:ye,tan:aE,tanh:Fc,tensor:_n,tensor1d:cn,tensor2d:Zo,tensor3d:Cx,tensor4d:iE,tensor5d:lE,tensor6d:uE,tile:Qo,topk:cE,truncatedNormal:dE,unique:pE,unsortedSegmentSum:fE,unstack:ds,upperBound:hE,variable:mE,where:Js,whereAsync:f1,zeros:br,zerosLike:Pt,op:N,OP_SCOPE_SUFFIX:hx,booleanMaskAsync:gE,transpose:qi,norm:Tl,movingAverage:yE,scatterND:xE,searchSorted:_d,sparseToDense:vE,gatherND:wE,dropout:bE,enclosingPowerOfTwo:h1,cosineWindow:Dd,inTopKAsync:SE,image:v1,linalg:EE,losses:IE,spectral:kE,fused:CE,signal:NE,sparse:RE,string:_E},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PZ=(t,e,n,r=it)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(w("a",t,e,n),w("b",t,e,n))];case"AddN":return[r.addN(w("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(w("a",t,e,n),w("b",t,e,n))];case"Mul":return[r.mul(w("a",t,e,n),w("b",t,e,n))];case"RealDiv":case"Div":return[r.div(w("a",t,e,n),w("b",t,e,n))];case"DivNoNan":return[r.divNoNan(w("a",t,e,n),w("b",t,e,n))];case"FloorDiv":return[r.floorDiv(w("a",t,e,n),w("b",t,e,n))];case"Sub":return[r.sub(w("a",t,e,n),w("b",t,e,n))];case"Minimum":return[r.minimum(w("a",t,e,n),w("b",t,e,n))];case"Maximum":return[r.maximum(w("a",t,e,n),w("b",t,e,n))];case"Pow":return[r.pow(w("a",t,e,n),w("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(w("a",t,e,n),w("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FZ=(t,e,n,r=it)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(w("x",t,e,n))];case"Acos":return[r.acos(w("x",t,e,n))];case"Acosh":return[r.acosh(w("x",t,e,n))];case"Asin":return[r.asin(w("x",t,e,n))];case"Asinh":return[r.asinh(w("x",t,e,n))];case"Atan":return[r.atan(w("x",t,e,n))];case"Atan2":return[r.atan2(w("x",t,e,n),w("y",t,e,n))];case"Atanh":return[r.atanh(w("x",t,e,n))];case"Ceil":return[r.ceil(w("x",t,e,n))];case"Complex":return[r.complex(w("real",t,e,n),w("imag",t,e,n))];case"Cos":return[r.cos(w("x",t,e,n))];case"Cosh":return[r.cosh(w("x",t,e,n))];case"Elu":return[r.elu(w("x",t,e,n))];case"Erf":return[r.erf(w("x",t,e,n))];case"Exp":return[r.exp(w("x",t,e,n))];case"Expm1":return[r.expm1(w("x",t,e,n))];case"Floor":return[r.floor(w("x",t,e,n))];case"Log":return[r.log(w("x",t,e,n))];case"Log1p":return[r.log1p(w("x",t,e,n))];case"Imag":return[r.imag(w("x",t,e,n))];case"Neg":return[r.neg(w("x",t,e,n))];case"Reciprocal":return[r.reciprocal(w("x",t,e,n))];case"Real":return[r.real(w("x",t,e,n))];case"Relu":return[r.relu(w("x",t,e,n))];case"Round":return[r.round(w("x",t,e,n))];case"Selu":return[r.selu(w("x",t,e,n))];case"Sigmoid":return[r.sigmoid(w("x",t,e,n))];case"Sin":return[r.sin(w("x",t,e,n))];case"Sign":return[r.sign(w("x",t,e,n))];case"Sinh":return[r.sinh(w("x",t,e,n))];case"Softplus":return[r.softplus(w("x",t,e,n))];case"Sqrt":return[r.sqrt(w("x",t,e,n))];case"Square":return[r.square(w("x",t,e,n))];case"Tanh":return[r.tanh(w("x",t,e,n))];case"Tan":return[r.tan(w("x",t,e,n))];case"ClipByValue":return[r.clipByValue(w("x",t,e,n),w("clipValueMin",t,e,n),w("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(w("x",t,e,n))];case"Rsqrt":return[r.rsqrt(mt(t.inputNames[0],e,n))];case"Prod":return[r.prod(w("x",t,e,n),w("axes",t,e,n))];case"LeakyRelu":return[r.leakyRelu(w("x",t,e,n),w("alpha",t,e,n))];case"Prelu":return[r.prelu(w("x",t,e,n),w("alpha",t,e,n))];case"IsNan":return[r.isNaN(mt(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function en(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){$(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],o=e[r];$(s<0||o<0||s===o,()=>n+` Shapes ${t} and ${e} must match`)}}}function qb(t){return!(typeof t=="number"||t.some(e=>e<0))}function qa(t,e,n){let r=Hh(t,n);const s=!qb(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(o=>{r=Hh(o.shape,r)}),!qb(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Hh(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],o=e[r];if(s>=0&&o>=0&&s!==o)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:o}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LZ{constructor(e,n,r,s,o,a,i){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=o,this.dynamicSize=a,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=oe(0),Un(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),en(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Un(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(!!n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return _n([],[0].concat(this.elementShape));const r=this.readMany(e);return en(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Qn(r,0)}concat(e){if(!!e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return _n([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return en(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),st(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,ds(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=r===0?0:n.size/r,a=[];ie(()=>{n=P(n,[1,r,o]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:s[l-1],0],d=[1,e[l],o];a[l]=P(he(n,c,d),this.elementShape)}return a});const i=[];for(let l=0;l<e.length;l++)i[l]=l;this.writeMany(i,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class to{constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(o=>{if(r!==o.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${o.dtype}`);en(n,o.shape,"TensorList shape mismatch: "),Un(o)}),this.idTensor=oe(0),this.maxNumElements=s,Un(this.idTensor)}get id(){return this.idTensor.id}copy(){return new to([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);en(e,this.elementShape,"TensorList shape mismatch: ");const s=qa(this.elementShape,this.tensors,e);return ie(()=>{const o=this.tensors.map(a=>P(a,s));return Qn(o,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=qa(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,en(s.shape,e,"TensorList shape mismatch: "),P(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(en(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Un(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new to([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);en(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=qa(this.elementShape,this.tensors,n);return P(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);en(this.elementShape,n.shape,"TensorList shape mismatch: "),Un(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);en(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=qa(this.elementShape,this.tensors,r);return e.length===0?_n([],[0].concat(s)):ie(()=>{const o=e.map(a=>P(this.tensors[a],s));return Qn(o,0)})}concat(e,n){if(!!e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);en(this.elementShape,n,"TensorList shape mismatch: ");const r=qa(this.elementShape,this.tensors,n);return this.size()===0?_n([],[0].concat(r)):ie(()=>{const s=this.tensors.map(o=>P(o,r));return st(s,0)})}}function BZ(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);en(s,e,"TensorList shape mismatch: ");const o=ds(t);return new to(o,e,r)}function VZ(t,e,n,r){return new to([],t,e,r)}function MZ(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const o=new to([],n,t.dtype,r),a=ds(t,0);return e.forEach((i,l)=>{o.setItem(i,a[l])}),o}function zZ(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const o=t.shape.slice(1),a=Hh(o,n),i=r===0?0:t.size/r,l=ie(()=>{const c=[];t=P(t,[1,r,i]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:s[d-1],0],h=[1,e[d],i];c[d]=P(he(t,f,h),a)}return t.dispose(),c}),u=new to([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=w("thenBranch",t,e,n),s=w("elseBranch",t,e,n),o=w("cond",t,e,n),a=w("args",t,e,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=w("body",t,e,n),s=w("cond",t,e,n),o=w("args",t,e,n),a=await n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),i=o.map(c=>c.id);let l=await a[0].data();a.forEach(c=>{!c.kept&&i.indexOf(c.id)===-1&&c.dispose()});let u=o;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(f=>f.id);c.forEach(f=>{!f.kept&&i.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const p=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(f=>{!f.kept&&i.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return u}case"LoopCond":{const r=w("pred",t,e,n);return[rr(r)]}case"Switch":{const r=w("pred",t,e,n);let s=w("data",t,e,n);return s.kept||(s=rr(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>mt(s,e,n)!==void 0);if(r){const s=mt(r,e,n);return[rr(s)]}return}case"Enter":{const r=w("frameName",t,e,n),s=w("tensor",t,e,n);return n.enterFrame(r),[rr(s)]}case"Exit":{const r=w("tensor",t,e,n);return n.exitFrame(),[rr(r)]}case"NextIteration":{const r=w("tensor",t,e,n);return n.nextIteration(),[rr(r)]}case"TensorArrayV3":{const r=w("size",t,e,n),s=w("dtype",t,e,n),o=w("elementShape",t,e,n),a=w("dynamicSize",t,e,n),i=w("clearAfterRead",t,e,n),l=w("identicalElementShapes",t,e,n),u=w("name",t,e,n),c=new LZ(u,s,r,o,l,a,i);return n.addTensorArray(c),[c.idTensor,oe(1)]}case"TensorArrayWriteV3":{const r=w("tensorArrayId",t,e,n),s=w("index",t,e,n),o=w("tensor",t,e,n),a=n.getTensorArray(r.id);return a.write(s,o),[a.idTensor]}case"TensorArrayReadV3":{const r=w("tensorArrayId",t,e,n),s=w("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=w("tensorArrayId",t,e,n),s=w("indices",t,e,n),o=w("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,o)]}case"TensorArrayScatterV3":{const r=w("tensorArrayId",t,e,n),s=w("indices",t,e,n),o=w("tensor",t,e,n),a=n.getTensorArray(r.id);return a.scatter(s,o),[a.idTensor]}case"TensorArrayConcatV3":{const r=w("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),o=w("dtype",t,e,n);return[s.concat(o)]}case"TensorArraySplitV3":{const r=w("tensorArrayId",t,e,n),s=w("tensor",t,e,n),o=w("lengths",t,e,n),a=n.getTensorArray(r.id);return a.split(o,s),[a.idTensor]}case"TensorArraySizeV3":{const r=w("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[oe(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=w("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=w("tensorListId",t,e,n),s=w("index",t,e,n),o=w("tensor",t,e,n),a=n.getTensorList(r.id);return a.setItem(s,o),[a.idTensor]}case"TensorListGetItem":{const r=w("tensorListId",t,e,n),s=w("index",t,e,n),o=w("elementShape",t,e,n),a=w("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,o,a)]}case"TensorListScatterV2":case"TensorListScatter":{const r=w("indices",t,e,n),s=w("tensor",t,e,n),o=w("elementShape",t,e,n),a=w("numElements",t,e,n),i=MZ(s,r,o,a);return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=w("elementShape",t,e,n),s=w("elementDType",t,e,n);let o;t.op==="TensorListReserve"?o="numElements":o="maxNumElements";const a=w(o,t,e,n),i=t.op==="TensorListReserve"?-1:a,l=VZ(r,s,a,i);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=w("tensorListId",t,e,n),s=w("indices",t,e,n),o=w("elementShape",t,e,n),a=w("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,a,o)]}case"TensorListStack":{const r=w("tensorListId",t,e,n),s=w("elementShape",t,e,n),o=w("elementDType",t,e,n),a=w("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,o,a)]}case"TensorListFromTensor":{const r=w("tensor",t,e,n),s=w("elementShape",t,e,n),o=w("elementDType",t,e,n),a=BZ(r,s,o);return n.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=w("tensorListId",t,e,n),s=n.getTensorList(r.id),o=w("dtype",t,e,n),a=w("elementShape",t,e,n);return[s.concat(o,a)]}case"TensorListPushBack":{const r=w("tensorListId",t,e,n),s=w("tensor",t,e,n),o=n.getTensorList(r.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const r=w("tensorListId",t,e,n),s=w("elementShape",t,e,n),o=w("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,o)]}case"TensorListSplit":{const r=w("tensor",t,e,n),s=w("elementShape",t,e,n),o=w("lengths",t,e,n),a=zZ(r,o,s);return n.addTensorList(a),[a.idTensor]}case"TensorListLength":{const r=w("tensorListId",t,e,n),s=n.getTensorList(r.id);return[oe(s.size(),"int32")]}case"TensorListResize":{const r=w("tensorListId",t,e,n),s=w("size",t,e,n),a=n.getTensorList(r.id).resize(s);return n.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xb(t,e,n){const[r,s]=w("fusedOps",t,e,n),o=r==="biasadd",a=!o,i=s==="prelu",l=r==="fusedbatchnorm",u=w("numArgs",t,e,n);if(o){if(i&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=w("strides",t,e,n),d=Bu(t,e,n),p=w("dataFormat",t,e,n).toUpperCase(),f=w("dilations",t,e,n);let[h,g]=w("args",t,e,n);a&&(g=h,h=void 0);const y=w("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:p,dilations:f,biasArg:h,preluArg:g,activationFunc:s,leakyreluAlpha:y}}const WZ=(t,e,n,r=it)=>{switch(t.op){case"Conv1D":{const s=w("stride",t,e,n),o=w("pad",t,e,n),a=w("dataFormat",t,e,n).toUpperCase(),i=w("dilation",t,e,n);return[r.conv1d(w("x",t,e,n),w("filter",t,e,n),s,o,a,i)]}case"Conv2D":{const s=w("strides",t,e,n),o=Bu(t,e,n),a=w("dataFormat",t,e,n).toUpperCase(),i=w("dilations",t,e,n);return[r.conv2d(w("x",t,e,n),w("filter",t,e,n),[s[1],s[2]],o,a,[i[1],i[2]])]}case"_FusedConv2D":{const{stride:s,pad:o,dataFormat:a,dilations:i,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=Xb(t,e,n);return[r.fused.conv2d({x:w("x",t,e,n),filter:w("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:a,dilations:[i[1],i[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:o,dataFormat:a,dilations:i,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=Xb(t,e,n);return[r.fused.depthwiseConv2d({x:w("x",t,e,n),filter:w("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:a,dilations:[i[1],i[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=w("outputShape",t,e,n),o=w("strides",t,e,n),a=Bu(t,e,n);return[r.conv2dTranspose(w("x",t,e,n),w("filter",t,e,n),s,[o[1],o[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=w("strides",t,e,n),o=Bu(t,e,n),a=w("dilations",t,e,n),i=w("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(w("input",t,e,n),w("filter",t,e,n),[s[1],s[2]],o,i,[a[1],a[2]])]}case"Conv3D":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("dataFormat",t,e,n).toUpperCase(),i=w("dilations",t,e,n);return[r.conv3d(w("x",t,e,n),w("filter",t,e,n),[s[1],s[2],s[3]],o,a,[i[1],i[2],i[3]])]}case"AvgPool":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("kernelSize",t,e,n);return[r.avgPool(w("x",t,e,n),[a[1],a[2]],[s[1],s[2]],o)]}case"MaxPool":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("kernelSize",t,e,n);return[r.maxPool(w("x",t,e,n),[a[1],a[2]],[s[1],s[2]],o)]}case"MaxPoolWithArgmax":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("kernelSize",t,e,n),i=w("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(w("x",t,e,n),[a[1],a[2]],[s[1],s[2]],o,i);return[l,u]}case"AvgPool3D":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("kernelSize",t,e,n);return[r.avgPool3d(w("x",t,e,n),[a[1],a[2],a[3]],[s[1],s[2],s[3]],o)]}case"MaxPool3D":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("kernelSize",t,e,n);return[r.maxPool3d(w("x",t,e,n),[a[1],a[2],a[3]],[s[1],s[2],s[3]],o)]}case"Dilation2D":{const s=w("strides",t,e,n),o=w("pad",t,e,n),a=w("dilations",t,e,n),i=s[1],l=s[2],u=a[1],c=a[2];return[r.dilation2d(w("x",t,e,n),w("filter",t,e,n),[i,l],o,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ=(t,e,n,r=it)=>{switch(t.op){case"Fill":{const s=w("shape",t,e,n),o=w("dtype",t,e,n),a=w("value",t,e,n);return[r.fill(s,a,o)]}case"LinSpace":{const s=w("start",t,e,n),o=w("stop",t,e,n),a=w("num",t,e,n);return[r.linspace(s,o,a)]}case"Multinomial":{const s=w("logits",t,e,n),o=w("numSamples",t,e,n),a=w("seed",t,e,n);return[r.multinomial(s,o,a)]}case"OneHot":{const s=w("indices",t,e,n),o=w("depth",t,e,n),a=w("onValue",t,e,n),i=w("offValue",t,e,n),l=w("dtype",t,e,n);return[r.oneHot(s,o,a,i,l)]}case"Ones":return[r.ones(w("shape",t,e,n),w("dtype",t,e,n))];case"OnesLike":return[r.onesLike(w("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(w("shape",t,e,n),w("dtype",t,e,n),w("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(w("shape",t,e,n),w("minval",t,e,n),w("maxval",t,e,n),w("dtype",t,e,n))];case"Range":{const s=w("start",t,e,n),o=w("stop",t,e,n),a=w("step",t,e,n);return[r.range(s,o,a,w("dtype",t,e,n))]}case"TruncatedNormal":{const s=w("shape",t,e,n),o=w("mean",t,e,n),a=w("stdDev",t,e,n),i=w("seed",t,e,n);return[r.truncatedNormal(s,o,a,w("dtype",t,e,n),i)]}case"Zeros":return[r.zeros(w("shape",t,e,n),w("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(w("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(t,e,n){const r=w("boxes",t,e,n),s=w("scores",t,e,n),o=w("maxOutputSize",t,e,n),a=w("iouThreshold",t,e,n),i=w("scoreThreshold",t,e,n),l=w("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:o,iouThreshold:a,scoreThreshold:i,softNmsSigma:l}}const jZ=async(t,e,n,r,s=it)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:a,maxOutputSize:i,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=Xp(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(o,a,i,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:a,maxOutputSize:i,iouThreshold:l,scoreThreshold:u}=Xp(t,e,n),c=w("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(o,a,i,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:a,maxOutputSize:i,iouThreshold:l,scoreThreshold:u}=Xp(t,e,n);return[await s.image.nonMaxSuppressionAsync(o,a,i,l,u)]}case"Where":{const o=s.cast(w("condition",t,e,n),"bool"),a=[await s.whereAsync(o)];return o.dispose(),a}case"ListDiff":return s.setdiff1dAsync(w("x",t,e,n),w("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HZ=(t,e,n,r=it)=>{switch(t.op){case"LowerBound":{const s=w("sortedSequence",t,e,n),o=w("values",t,e,n);return[r.lowerBound(s,o)]}case"TopKV2":{const s=w("x",t,e,n),o=w("k",t,e,n),a=w("sorted",t,e,n),i=r.topk(s,o,a);return[i.values,i.indices]}case"UpperBound":{const s=w("sortedSequence",t,e,n),o=w("values",t,e,n);return[r.upperBound(s,o)]}case"Unique":{const s=w("x",t,e,n),o=r.unique(s);return[o.values,o.indices]}case"UniqueV2":{const s=w("x",t,e,n),o=w("axis",t,e,n),a=r.unique(s,o);return[a.values,a.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KZ=(t,e,n,r=it)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=w("default",t,e,n);return[mt(t.name,e,n)||s];case"Placeholder":return[mt(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=w("x",t,e,n);return[rr(c)]}case"IdentityN":return w("x",t,e,n).map(c=>rr(c));case"Snapshot":const o=w("x",t,e,n);return[rr(o)];case"Shape":return[r.tensor1d(w("x",t,e,n).shape,"int32")];case"ShapeN":return w("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(w("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(w("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const a=w("x",t,e,n),i=w("data",t,e,n),l=w("message",t,e,n),u=w("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<i.length;c++)console.log(Array.prototype.slice.call(i[c].dataSync()).slice(0,u));return[a];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qZ{constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=oe(0),this.tensorMap=new Map,Un(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return oe(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),ie(()=>{const s=ds(n),o=r.length,a=s.length;$(o===a,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${a} elements.`);for(let i=0;i<o;i++){const l=r[i],u=s[i];Un(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return ie(()=>{const s=[];for(let o=0;o<r.length;o++){const a=r[o],i=this.findWithDefault(a,n);s.push(i)}return Qn(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r!=null?r:n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XZ=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const o=w("keyDType",t,e,n),a=w("valueDType",t,e,n),i=new qZ(o,a);return r.addHashTable(t.name,i),[i.handle]}}case"LookupTableImport":case"LookupTableImportV2":{const s=w("tableHandle",t,e,n,r),o=w("keys",t,e,n),a=w("values",t,e,n);return[await r.getHashTableById(s.id).import(o,a)]}case"LookupTableFind":case"LookupTableFindV2":{const s=w("tableHandle",t,e,n,r),o=w("keys",t,e,n),a=w("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(o,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=w("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YZ=(t,e,n,r=it)=>{switch(t.op){case"ResizeBilinear":{const s=w("images",t,e,n),o=w("size",t,e,n),a=w("alignCorners",t,e,n),i=w("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[o[0],o[1]],a,i)]}case"ResizeNearestNeighbor":{const s=w("images",t,e,n),o=w("size",t,e,n),a=w("alignCorners",t,e,n),i=w("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[o[0],o[1]],a,i)]}case"CropAndResize":{const s=w("image",t,e,n),o=w("boxes",t,e,n),a=w("boxInd",t,e,n),i=w("cropSize",t,e,n),l=w("method",t,e,n),u=w("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,o,a,i,l,u)]}case"ImageProjectiveTransformV3":{const s=w("images",t,e,n),o=w("transforms",t,e,n),a=w("outputShape",t,e,n),i=w("fillValue",t,e,n),l=w("interpolation",t,e,n),u=w("fillMode",t,e,n);return[r.image.transform(s,o,l.toLowerCase(),u.toLowerCase(),i,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QZ=(t,e,n,r=it)=>{switch(t.op){case"Equal":return[r.equal(w("a",t,e,n),w("b",t,e,n))];case"NotEqual":return[r.notEqual(w("a",t,e,n),w("b",t,e,n))];case"Greater":return[r.greater(w("a",t,e,n),w("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(w("a",t,e,n),w("b",t,e,n))];case"Less":return[r.less(w("a",t,e,n),w("b",t,e,n))];case"LessEqual":return[r.lessEqual(w("a",t,e,n),w("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(w("a",t,e,n),w("b",t,e,n))];case"LogicalNot":return[r.logicalNot(w("a",t,e,n))];case"LogicalOr":return[r.logicalOr(w("a",t,e,n),w("b",t,e,n))];case"Select":case"SelectV2":return[r.where(w("condition",t,e,n),w("a",t,e,n),w("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZ=(t,e,n,r=it)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(w("a",t,e,n),w("b",t,e,n),w("transposeA",t,e,n),w("transposeB",t,e,n))];case"Einsum":return[r.einsum(w("equation",t,e,n),...w("tensors",t,e,n))];case"Transpose":return[r.transpose(w("x",t,e,n),w("perm",t,e,n))];case"_FusedMatMul":const[s,o]=w("fusedOps",t,e,n),a=s==="biasadd",i=o==="prelu",l=w("numArgs",t,e,n),u=w("leakyreluAlpha",t,e,n);if(a){if(i&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=w("args",t,e,n);return[r.fused.matMul({a:w("a",t,e,n),b:w("b",t,e,n),transposeA:w("transposeA",t,e,n),transposeB:w("transposeB",t,e,n),bias:c,activation:o,preluActivationWeights:d,leakyreluAlpha:u})];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=(t,e,n,r=it)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(w("x",t,e,n),w("axis",t,e,n),w("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(w("x",t,e,n),w("mean",t,e,n),w("variance",t,e,n),w("offset",t,e,n),w("scale",t,e,n),w("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(w("x",t,e,n),w("mean",t,e,n),w("variance",t,e,n),w("offset",t,e,n),w("scale",t,e,n),w("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(w("x",t,e,n),w("radius",t,e,n),w("bias",t,e,n),w("alpha",t,e,n),w("beta",t,e,n))];case"Softmax":return[r.softmax(w("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(w("x",t,e,n))];case"SparseToDense":return[r.sparseToDense(w("sparseIndices",t,e,n),w("outputShape",t,e,n),w("sparseValues",t,e,n),w("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eJ=(t,e,n,r=it)=>{switch(t.op){case"Max":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.max(w("x",t,e,n),i,l)]}case"Mean":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.mean(w("x",t,e,n),i,l)]}case"Min":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.min(w("x",t,e,n),i,l)]}case"Sum":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.sum(w("x",t,e,n),i,l)]}case"All":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.all(w("x",t,e,n),i,l)]}case"Any":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.any(w("x",t,e,n),i,l)]}case"ArgMax":{const i=w("axis",t,e,n);return[r.argMax(w("x",t,e,n),i)]}case"ArgMin":{const i=w("axis",t,e,n);return[r.argMin(w("x",t,e,n),i)]}case"Prod":{const i=w("axis",t,e,n),l=w("keepDims",t,e,n);return[r.prod(w("x",t,e,n),i,l)]}case"Cumprod":{const i=w("axis",t,e,n),l=w("exclusive",t,e,n),u=w("reverse",t,e,n);return[r.cumprod(w("x",t,e,n),i,l,u)]}case"Cumsum":{const i=w("axis",t,e,n),l=w("exclusive",t,e,n),u=w("reverse",t,e,n);return[r.cumsum(w("x",t,e,n),i,l,u)]}case"Bincount":const s=w("x",t,e,n),o=w("weights",t,e,n),a=w("size",t,e,n);return[r.bincount(s,o,a)];case"DenseBincount":{const i=w("x",t,e,n),l=w("weights",t,e,n),u=w("size",t,e,n),c=w("binaryOutput",t,e,n);return[r.denseBincount(i,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJ=(t,e,n,r=it)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=w("n",t,e,n),o=w("axis",t,e,n);let a=w("tensors",t,e,n);return a=a.slice(0,s),[r.concat(a,o)]}case"Gather":{const s=w("x",t,e,n),o=w("indices",t,e,n);return[r.gather(s,r.cast(o,"int32"),0)]}case"GatherV2":{const s=w("axis",t,e,n),o=w("batchDims",t,e,n),a=w("x",t,e,n),i=w("indices",t,e,n);return[r.gather(a,r.cast(i,"int32"),s,o)]}case"Reverse":{const s=w("dims",t,e,n),o=[];for(let i=0;i<s.length;i++)s[i]&&o.push(i);const a=w("x",t,e,n);return[r.reverse(a,o)]}case"ReverseV2":{const s=w("axis",t,e,n),o=w("x",t,e,n);return[r.reverse(o,s)]}case"Slice":{const s=w("begin",t,e,n),o=w("size",t,e,n);return[r.slice(w("x",t,e,n),s,o)]}case"StridedSlice":{const s=w("begin",t,e,n),o=w("end",t,e,n),a=w("strides",t,e,n),i=w("beginMask",t,e,n),l=w("endMask",t,e,n),u=w("ellipsisMask",t,e,n),c=w("newAxisMask",t,e,n),d=w("shrinkAxisMask",t,e,n),p=w("x",t,e,n);return[r.stridedSlice(p,s,o,a,i,l,u,c,d)]}case"Pack":return ie(()=>{const s=w("axis",t,e,n),o=w("tensors",t,e,n),a=o[0].shape,i=r.squeeze(o[0]).shape,l=o.map(u=>{const c=Ne(u.shape,a);if(!c&&!Ne(r.squeeze(u).shape,i))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,a)});return[r.stack(l,s)]});case"Unpack":{const s=w("axis",t,e,n),o=w("tensor",t,e,n);return r.unstack(o,s)}case"Tile":{const s=w("reps",t,e,n);return[r.tile(w("x",t,e,n),s)]}case"Split":case"SplitV":{const s=w("axis",t,e,n),o=w("numOrSizeSplits",t,e,n),a=w("x",t,e,n);return r.split(a,o,s)}case"ScatterNd":{const s=w("indices",t,e,n),o=w("values",t,e,n),a=w("shape",t,e,n);return[r.scatterND(s,o,a)]}case"GatherNd":{const s=w("x",t,e,n),o=w("indices",t,e,n);return[r.gatherND(s,o)]}case"SparseToDense":{const s=w("sparseIndices",t,e,n),o=w("outputShape",t,e,n),a=w("sparseValues",t,e,n),i=w("defaultValue",t,e,n);return[r.sparseToDense(s,a,o,a.dtype===i.dtype?i:r.cast(i,a.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ=(t,e,n,r=it)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:o,emptyRowIndicator:a,reverseIndexMap:i}=r.sparse.sparseFillEmptyRows(w("indices",t,e,n),w("values",t,e,n),w("denseShape",t,e,n),w("defaultValue",t,e,n));return[s,o,a,i]}case"SparseReshape":{const{outputIndices:s,outputShape:o}=r.sparse.sparseReshape(w("inputIndices",t,e,n),w("inputShape",t,e,n),w("newShape",t,e,n));return[s,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(w("data",t,e,n),w("indices",t,e,n),w("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(w("data",t,e,n),w("indices",t,e,n),w("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ=(t,e,n,r=it)=>{switch(t.op){case"FFT":return[r.fft(w("x",t,e,n))];case"IFFT":return[r.ifft(w("x",t,e,n))];case"RFFT":return[r.rfft(w("x",t,e,n))];case"IRFFT":return[r.irfft(w("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ=(t,e,n,r=it)=>{switch(t.op){case"StringNGrams":{const{nGrams:s,nGramsSplits:o}=r.string.stringNGrams(w("data",t,e,n),w("dataSplits",t,e,n),w("separator",t,e,n),w("nGramWidths",t,e,n),w("leftPad",t,e,n),w("rightPad",t,e,n),w("padWidth",t,e,n),w("preserveShortSequences",t,e,n));return[s,o]}case"StringSplit":{const{indices:s,values:o,shape:a}=r.string.stringSplit(w("input",t,e,n),w("delimiter",t,e,n),w("skipEmpty",t,e,n));return[s,o,a]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(w("input",t,e,n),w("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJ=(t,e,n,r=it)=>{switch(t.op){case"Cast":return[r.cast(w("x",t,e,n),w("dtype",t,e,n))];case"ExpandDims":{const s=w("axis",t,e,n);return[r.expandDims(w("x",t,e,n),s)]}case"Squeeze":{const s=w("axis",t,e,n);return[r.squeeze(w("x",t,e,n),s)]}case"Reshape":return[r.reshape(w("x",t,e,n),w("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(w("x",t,e,n),w("padding",t,e,n),w("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(w("x",t,e,n),w("padding",t,e,n),w("constantValue",t,e,n))];case"SpaceToBatchND":{const s=w("blockShape",t,e,n),o=w("paddings",t,e,n);return[r.spaceToBatchND(w("x",t,e,n),s,o)]}case"BatchToSpaceND":{const s=w("blockShape",t,e,n),o=w("crops",t,e,n);return[r.batchToSpaceND(w("x",t,e,n),s,o)]}case"DepthToSpace":{const s=w("blockSize",t,e,n),o=w("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(w("x",t,e,n),s,o)]}case"BroadcastTo":return[r.broadcastTo(w("x",t,e,n),w("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(w("s0",t,e,n),w("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yb(t,e,n,r,s=ie){const o=((a,i,l)=>{switch(a.category){case"arithmetic":return s(()=>PZ(a,i,l));case"basic_math":return s(()=>FZ(a,i,l));case"control":return UZ(a,i,l);case"convolution":return s(()=>WZ(a,i,l));case"creation":return s(()=>GZ(a,i,l));case"dynamic":return jZ(a,i,l);case"evaluation":return s(()=>HZ(a,i,l));case"image":return s(()=>YZ(a,i,l));case"graph":return s(()=>KZ(a,i,l));case"logical":return s(()=>QZ(a,i,l));case"matrices":return s(()=>ZZ(a,i,l));case"normalization":return s(()=>JZ(a,i,l));case"reduction":return s(()=>eJ(a,i,l));case"slice_join":return s(()=>tJ(a,i,l));case"sparse":return s(()=>nJ(a,i,l));case"spectral":return s(()=>rJ(a,i,l));case"string":return s(()=>sJ(a,i,l));case"transformation":return s(()=>oJ(a,i,l));case"hash_table":return XZ(a,i,l,r);case"custom":const u=dR(a.op);if(u&&u.customExecutor)return u.customExecutor(new DZ(a,i,l));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return qs(o)?o.then(a=>[].concat(a)):[].concat(o)}class Qb{constructor(e={},n={},r={},s={}){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zb(t,e,n,r){const s=new Set,o=[];let a=null,i=null;const l=new Set,u=Object.keys(t).map(p=>Nt(p)[0]);let c=[];r!=null&&(c=r.map(p=>Nt(p.name)[0]));const d=[...e];for(;d.length>0;){const p=d.pop();if((hR(p)||cJ(p)||dJ(p))&&a==null&&(a=p,i=a.children.map(f=>f.name).filter(f=>s.has(f))),s.add(p.name),n[p.name]==null&&u.indexOf(p.name)===-1&&c.indexOf(p.name)===-1){if(p.inputs.length===0){o.push(p.name);continue}p.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:o,dynamicNode:a,syncInputs:i}}function aJ(t,e,n){const{usedNodes:r,inputs:s}=n,o=[],a=Object.keys(s).map(c=>Nt(c)[0]).map(c=>t.nodes[c]),i=t.initNodes;a.forEach(c=>{r.has(c.name)&&o.push(c)}),t.weights.forEach(c=>{r.has(c.name)&&o.push(c)}),i!=null&&i.forEach(c=>{r.has(c.name)&&o.push(c)});const l=new Set,u=[];for(;o.length>0;){const c=o.pop();l.add(c.name),e[c.name]||u.push(c),c.children.forEach(d=>{!l.has(d.name)&&r.has(d.name)&&d.inputs.every(p=>l.has(p.name))&&o.push(d)})}return u}const iJ=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],lJ=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],uJ=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function hR(t){return iJ.indexOf(t.op)>=0}function cJ(t){return lJ.indexOf(t.op)>=0}function dJ(t){return uJ.indexOf(t.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gc{constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Gc(e.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}getCompilationKey(e,n){const r=e.map(o=>o.name).sort(),s=n.map(o=>o.name).sort();return r.join(this.SEPERATOR)+"--"+s.join(this.SEPERATOR)}compile(e,n){const r=Zb(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:o,syncInputs:a}=r;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(s.length>0){const i=n.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${i}] from the provided inputs [${l}]. Missing the following inputs: [${s}]`)}return aJ(this.graph,this.weightMap,r)}execute(e,n){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(d=>this.graph.nodes[Nt(d)[0]]),o=n.map(d=>Nt(d)[0]);let a=o.map(d=>this.graph.nodes[d]);this.resetIntermediateTensors(),a.length===0&&(a=this._outputs);const i=this.getCompilationKey(s,a);let l=this.compiledMap.get(i);l==null&&(l=this.compile(e,a),this.compiledMap.set(i,l));const u={},c={};return ie(()=>{const d=new Qb(this.weightMap,u,c,this.functionExecutorMap),p=Object.assign({},this.weightMap);Object.keys(e).forEach(g=>{const[y,m]=Nt(g),x=[];x[m]=e[g],p[y]=x});const f=this.getFrozenTensorIds(p),h={};for(let g=0;g<l.length;g++){const y=l[g];if(!p[y.name]){const m=Yb(y,p,d,this._resourceManager);if(qs(m))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);p[y.name]=m,this.checkTensorForDisposal(y.name,y,p,d,f,o,h)}}return this.parent==null&&d.dispose(f),n.map(g=>mt(g,p,d))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,o,a,i){n.category==="control"||a.indexOf(e)!==-1||(r[e].forEach(l=>{l!=null&&(i[l.id]=(i[l.id]||0)+n.children.length)}),n.inputs.forEach(l=>{if(l.category!=="control"){const u=qQ(l.name,r,s);u!=null&&u.forEach(c=>{if(c&&!c.kept&&!o.has(c.id)){const d=i[c.id];if(d===1){if(!this.keepTensorForDebug)c.dispose();else{const[p,f]=Mn(n.name,s);this.intermediateTensors[p]?this.intermediateTensors[p][f]=c:(this.intermediateTensors[p]=[],this.intermediateTensors[p][f]=c)}delete i[c.id]}else d!=null&&i[c.id]--}})}}))}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){!this.intermediateTensors||(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(n=>n.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){!this.tensorsMap||Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(r=>{r&&!r.kept&&!r.isDisposed&&!this.keepIds.has(r.id)&&r.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(n=>n.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,n,r=!1,s={},o={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepTensorForDebug=_().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(c){console.warn(c.message)}this.resetIntermediateTensors();const a=new Qb(this.weightMap,s,o,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,a,n,r);const i=n.map(c=>mt(c,this.tensorsMap,a)),l=i.map(c=>c.id),u=Object.keys(e).map(c=>e[c].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&a.dispose(this.keepIds),i}async executeFunctionAsync(e,n,r){const s=e.reduce((o,a,i)=>(o[this.inputs[i].name]=a,o),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const o=Object.keys(e),a=o.map(v=>this.graph.nodes[Nt(v)[0]]),i=r.map(v=>Nt(v)[0]);let l=i.map(v=>this.graph.nodes[v]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:d,syncInputs:p}=Zb(e,l,this.weightMap,this._initNodes),f=[...a,...this.graph.weights,...this._initNodes||[]].map(v=>({node:v,contexts:n.currentContext})),h=Object.assign({},this.weightMap);Object.keys(e).forEach(v=>{const[b,C]=Nt(v),k=[];k[C]=e[v],h[b]=k});const g={},y=this.getFrozenTensorIds(h),m={};for(;f.length>0;){const v=this.processStack(a,f,n,h,m,y,i,g,u);await Promise.all(v)}d==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const x=l.filter(v=>!hR(v)&&!mt(v.name,h,n)).map(v=>v.name);if(x.length>0){let v="";throw d!=null&&(v=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${x}] from the provided inputs [${o}]. Consider providing the following inputs: [${c}]. ${v}`)}return h}processStack(e,n,r,s,o,a,i,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&w("isConstant",d.node,s,r)&&([p]=Mn(d.node.name,r)),s[d.node.name]==null){const f=Yb(d.node,s,r,this._resourceManager);p||([p]=Mn(d.node.name,r));const h=r.currentContext;qs(f)?c.push(f.then(g=>(s[p]=g,r.currentContext=h,this.checkTensorForDisposal(p,d.node,s,r,a,i,l),this.processChildNodes(d.node,n,r,s,o,u),g))):(s[p]=f,this.checkTensorForDisposal(p,d.node,s,r,a,i,l),this.processChildNodes(d.node,n,r,s,o,u))}else this.processChildNodes(d.node,n,r,s,o,u)}return c}processChildNodes(e,n,r,s,o,a){e.children.forEach(i=>{const[l]=Mn(i.name,r);o[l]||!a.has(i.name)||(i.op==="Merge"?i.inputNames.some(u=>!!mt(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:i})):i.inputNames.every(u=>!!mt(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:i})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=Nt(n),o=this.graph.nodes[s];if(o.attrParams.shape&&o.attrParams.shape.value){const a=o.attrParams.shape.value,i=a.length===r.shape.length&&r.shape.every((l,u)=>a[u]===-1||a[u]===l);$(i,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${a}], but was [${r.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&$(r.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){const n={};for(const r in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){const s=this._signature.inputs[r];n[s.name]=e[r]}else n[r]=e[r];return n}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=Nt(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(e){e.forEach(n=>{const[r]=Nt(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class pJ{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fJ="?tfjs-format=file",hJ="model.json";class mJ{constructor(e,n={},r=bx){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new pJ}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return qs(e)?e.then(n=>this.loadSync(n)):this.loadSync(e)}loadSync(e){this.artifacts=e;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(r=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}this.signature=r,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const s=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Gc(Hb.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(s),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=Hb.Instance.transformGraph(e.modelInitializer);this.initializer=new Gc(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,n){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const s=r instanceof _e?[r]:r,o={};return s.forEach((a,i)=>o[this.structuredOutputKeys[i]]=a),o}return r}normalizeInputs(e){if(!(e instanceof _e)&&!Array.isArray(e)){if(this.signature!=null&&this.signature.inputs!=null)for(const s in this.signature.inputs){const o=this.signature.inputs[s];o.resourceId!=null&&(e[s]=this.resourceIdToCapturedInput[o.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((s,o)=>{const a=this.signature?this.signature.inputs[o]:null;return a!=null&&a.resourceId!=null?s[o]=this.resourceIdToCapturedInput[a.resourceId]:s[o]=e[r++],s},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=Object.keys(this.initializerSignature.outputs);for(let r=0;r<n.length;r++){const s=n[r],o=this.initializerSignature.outputs[s];this.resourceIdToCapturedInput[o.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&gt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Jb(t,e={},n=bx){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=gJ(t));const r=new mJ(t,e,n);return await r.load(),r}function gJ(t){return t.endsWith("/")||(t=t+"/"),`${t}${hJ}${fJ}`}/**
    * @license
    * Copyright 2021 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function jc(t,e,n,r){return new(n||(n=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(c){o(c)}}function i(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?s(u.value):new n(function(c){c(u.value)}).then(a,i)}l((r=r.apply(t,e||[])).next())})}function Hc(t,e){var n,r,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function i(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&c[0]?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[2&c[0],s.value]),c[0]){case 0:case 1:s=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){a.label=c[1];break}if(c[0]===6&&a.label<s[1]){a.label=s[1],s=c;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(c);break}s[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(d){c=[6,d],r=0}finally{n=s=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}var yJ={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},Nr=224,xJ={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},$o={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function vJ(t){return t===void 0&&(t={version:1,alpha:1}),jc(this,void 0,void 0,function(){var e,n,r,s,o,a,i;return Hc(this,function(l){switch(l.label){case 0:if(h6==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(r=t.version.toFixed(2),s=t.alpha?t.alpha.toFixed(2):"",o=-1,a=1,t.modelUrl==null){if(!(r in $o))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys($o));if(!(s in $o[r]))throw new Error("MobileNet constructed with invalid alpha "+t.alpha+". Valid multipliers for this version are: "+Object.keys($o[r])+".");e=$o[r][s].inputRange,o=e[0],a=e[1]}return t.inputRange!=null&&(n=t.inputRange,o=n[0],a=n[1]),[4,(i=new wJ(r,s,t.modelUrl,o,a)).load()];case 1:return l.sent(),[2,i]}})})}var wJ=function(){function t(e,n,r,s,o){s===void 0&&(s=-1),o===void 0&&(o=1),this.version=e,this.alpha=n,this.modelUrl=r,this.inputMin=s,this.inputMax=o,this.normalizationConstant=(o-s)/255}return t.prototype.load=function(){return jc(this,void 0,void 0,function(){var e,n,r,s,o=this;return Hc(this,function(a){switch(a.label){case 0:return this.modelUrl?(e=this,[4,Jb(this.modelUrl)]):[3,2];case 1:return e.model=a.sent(),[3,4];case 2:return n=$o[this.version][this.alpha].url,r=this,[4,Jb(n,{fromTFHub:!0})];case 3:r.model=a.sent(),a.label=4;case 4:return[4,(s=ie(function(){return o.model.predict(br([1,Nr,Nr,3]))})).data()];case 5:return a.sent(),s.dispose(),[2]}})})},t.prototype.infer=function(e,n){var r=this;return n===void 0&&(n=!1),ie(function(){e instanceof _e||(e=qT(e));var s=ee(W(ke(e,"float32"),r.normalizationConstant),r.inputMin),o=s;(e.shape[0]!==Nr||e.shape[1]!==Nr)&&(o=v1.resizeBilinear(s,[Nr,Nr],!0));var a,i=P(o,[-1,Nr,Nr,3]);if(n){var l=xJ[r.version],u=r.model.execute(i,l);a=El(u,[1,2])}else{var c=r.model.predict(i);a=he(c,[0,1],[-1,1e3])}return a})},t.prototype.classify=function(e,n){return n===void 0&&(n=3),jc(this,void 0,void 0,function(){var r,s;return Hc(this,function(o){switch(o.label){case 0:return[4,bJ(r=this.infer(e),n)];case 1:return s=o.sent(),r.dispose(),[2,s]}})})},t}();function bJ(t,e){return jc(this,void 0,void 0,function(){var n,r,s,o,a,i,l;return Hc(this,function(u){switch(u.label){case 0:return[4,(n=l1(t)).data()];case 1:for(r=u.sent(),n.dispose(),s=[],l=0;l<r.length;l++)s.push({value:r[l],index:l});for(s.sort(function(c,d){return d.value-c.value}),o=new Float32Array(e),a=new Int32Array(e),l=0;l<e;l++)o[l]=s[l].value,a[l]=s[l].index;for(i=[],l=0;l<a.length;l++)i.push({className:yJ[a[l]],probability:o[l]});return[2,i]}})})}const SJ="/my-fridgile/assets/camera.1976a4f5.svg",CJ="/my-fridgile/assets/cameraLabel.7af26490.svg";function eS(t,e){const[n,r]=A.exports.useState(()=>{const s=localStorage.getItem(t);return s!=null?JSON.parse(s):typeof e=="function"?e():e});return A.exports.useEffect(()=>{localStorage.setItem(t,JSON.stringify(n))},[t,n]),[n,r]}let vu;const $J=new Uint8Array(16);function TJ(){if(!vu&&(vu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vu($J)}const Je=[];for(let t=0;t<256;++t)Je.push((t+256).toString(16).slice(1));function kJ(t,e=0){return(Je[t[e+0]]+Je[t[e+1]]+Je[t[e+2]]+Je[t[e+3]]+"-"+Je[t[e+4]]+Je[t[e+5]]+"-"+Je[t[e+6]]+Je[t[e+7]]+"-"+Je[t[e+8]]+Je[t[e+9]]+"-"+Je[t[e+10]]+Je[t[e+11]]+Je[t[e+12]]+Je[t[e+13]]+Je[t[e+14]]+Je[t[e+15]]).toLowerCase()}const NJ=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tS={randomUUID:NJ};function nS(t,e,n){if(tS.randomUUID&&!e&&!t)return tS.randomUUID();t=t||{};const r=t.random||(t.rng||TJ)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return kJ(r)}const mR=al.createContext();function Qd(){return A.exports.useContext(mR)}const EJ=({children:t})=>{const[e,n]=eS("items",[]),[r,s]=eS("sList",[]);function o({item:i}){n(l=>[...l,{id:nS(),item:i}])}function a({item:i}){s(l=>[...l,{id:nS(),status:!1,item:i}])}return T(mR.Provider,{value:{detectedItem:e,setDetectedItem:n,addDetectedItem:o,saveItemFromShoppingList:r,setSaveItemFromShoppingList:s,saveItemToLocal:a},children:t})},IJ=({itemName:t})=>{const{addDetectedItem:e}=Qd(),n=A.exports.useRef(),r=()=>{window.location.reload(!1)};return T("div",{className:"saveDetectedItem",children:T("div",{className:"saveDetectedItemPopup",children:X("form",{onSubmit:o=>{o.preventDefault(),e({item:n.current.value}),r()},children:[T("p",{children:"Is this correct?"}),T("input",{value:t,ref:n,type:"text",name:"name",required:!0}),X("div",{className:"saveDetectedItemBtns",children:[T("button",{type:"submit",children:"Yes"}),T("button",{children:"NO"})]})]})})})};const RJ=()=>T("div",{className:"loadingWrapper",children:T("div",{className:"profile-main-loader",children:T("div",{className:"loader",children:T("svg",{className:"circular-loader",viewBox:"25 25 50 50",children:T("circle",{className:"loader-path",cx:"50",cy:"50",r:"20",fill:"none",stroke:"#70c542",strokeWidth:"2"})})})})}),_J=()=>{const[t,e]=A.exports.useState(!1),[n,r]=A.exports.useState(null),[s,o]=A.exports.useState(null),[a,i]=A.exports.useState([]),l=A.exports.useRef(),u=async()=>{e(!0);try{const p=await vJ();r(p),e(!1)}catch(p){console.log(p),e(!1)}},c=p=>{const{files:f}=p.target;if(f.length>0){const h=URL.createObjectURL(f[0]);o(h)}else o(null)},d=async()=>{const p=await n.classify(l.current);i(p)};return A.exports.useEffect(()=>{u()},[]),t?T(RJ,{}):X("div",{className:"objectDetector",children:[T("h2",{className:"title",children:"Add Food"}),T("p",{className:"detectorPrimaryMessage",children:"Take a photo of your item."}),T("p",{className:"detectorSecondaryMessage",children:"! Make sure that the item is centered and keep the device steady to receive accurate results."}),a.length>0&&T(IJ,{itemName:a[0].className}),T("div",{className:"imageContainer",children:s?T("img",{className:"image",src:s,alt:"Uploaded Image",crossOrigin:"anonymous",ref:l}):T("img",{src:CJ,className:"imageLabel"})}),s?T("button",{className:"identifyItem",onClick:()=>{d()},children:"Identify Image"}):X("label",{className:"takeAPhoto",children:[T("input",{type:"file",accept:"image/*",capture:"camera",onChange:c}),T("img",{src:SJ,alt:"",className:"cameraIcon"})]})]})};/**
 * @remix-run/router v1.0.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kc(){return Kc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kc.apply(this,arguments)}var Wr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Wr||(Wr={}));const rS="popstate";function AJ(t){t===void 0&&(t={});function e(r,s){let{pathname:o,search:a,hash:i}=r.location;return Kh("",{pathname:o,search:a,hash:i},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:qh(s)}return DJ(e,n,null,t)}function OJ(){return Math.random().toString(36).substr(2,8)}function sS(t){return{usr:t.state,key:t.key}}function Kh(t,e,n,r){return n===void 0&&(n=null),Kc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Oa(e):e,{state:n,key:e&&e.key||r||OJ()})}function qh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Oa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function DJ(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,a=s.history,i=Wr.Pop,l=null;function u(){i=Wr.Pop,l&&l({action:i,location:p.location})}function c(f,h){i=Wr.Push;let g=Kh(p.location,f,h);n&&n(g,f);let y=sS(g),m=p.createHref(g);try{a.pushState(y,"",m)}catch{s.location.assign(m)}o&&l&&l({action:i,location:g})}function d(f,h){i=Wr.Replace;let g=Kh(p.location,f,h);n&&n(g,f);let y=sS(g),m=p.createHref(g);a.replaceState(y,"",m),o&&l&&l({action:i,location:g})}let p={get action(){return i},get location(){return t(s,a)},listen(f){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(rS,u),l=f,()=>{s.removeEventListener(rS,u),l=null}},createHref(f){return e(s,f)},push:c,replace:d,go(f){return a.go(f)}};return p}var oS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(oS||(oS={}));function PJ(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Oa(e):e,s=yR(r.pathname||"/",n);if(s==null)return null;let o=gR(t);FJ(o);let a=null;for(let i=0;a==null&&i<o.length;++i)a=jJ(o[i],s);return a}function gR(t,e,n,r){return e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r=""),t.forEach((s,o)=>{let a={relativePath:s.path||"",caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(Qe(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(r.length));let i=Jr([r,a.relativePath]),l=n.concat(a);s.children&&s.children.length>0&&(Qe(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+i+'".')),gR(s.children,e,l,i)),!(s.path==null&&!s.index)&&e.push({path:i,score:WJ(i,s.index),routesMeta:l})}),e}function FJ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:GJ(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const LJ=/^:\w+$/,BJ=3,VJ=2,MJ=1,zJ=10,UJ=-2,aS=t=>t==="*";function WJ(t,e){let n=t.split("/"),r=n.length;return n.some(aS)&&(r+=UJ),e&&(r+=VJ),n.filter(s=>!aS(s)).reduce((s,o)=>s+(LJ.test(o)?BJ:o===""?MJ:zJ),r)}function GJ(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function jJ(t,e){let{routesMeta:n}=t,r={},s="/",o=[];for(let a=0;a<n.length;++a){let i=n[a],l=a===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",c=HJ({path:i.relativePath,caseSensitive:i.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let d=i.route;o.push({params:r,pathname:Jr([s,c.pathname]),pathnameBase:QJ(Jr([s,c.pathnameBase])),route:d}),c.pathnameBase!=="/"&&(s=Jr([s,c.pathnameBase]))}return o}function HJ(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=KJ(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),i=s.slice(1);return{params:r.reduce((u,c,d)=>{if(c==="*"){let p=i[d]||"";a=o.slice(0,o.length-p.length).replace(/(.)\/+$/,"$1")}return u[c]=qJ(i[d]||"",c),u},{}),pathname:o,pathnameBase:a,pattern:t}}function KJ(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),xR(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(a,i)=>(r.push(i),"([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function qJ(t,e){try{return decodeURIComponent(t)}catch(n){return xR(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function yR(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Qe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function xR(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function XJ(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Oa(t):t;return{pathname:n?n.startsWith("/")?n:YJ(n,e):e,search:ZJ(r),hash:JJ(s)}}function YJ(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Yp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vR(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Oa(t):(s=Kc({},t),Qe(!s.pathname||!s.pathname.includes("?"),Yp("?","pathname","search",s)),Qe(!s.pathname||!s.pathname.includes("#"),Yp("#","pathname","hash",s)),Qe(!s.search||!s.search.includes("#"),Yp("#","search","hash",s)));let o=t===""||s.pathname==="",a=o?"/":s.pathname,i;if(r||a==null)i=n;else{let d=e.length-1;if(a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),d-=1;s.pathname=p.join("/")}i=d>=0?e[d]:"/"}let l=XJ(s,i),u=a&&a!=="/"&&a.endsWith("/"),c=(o||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Jr=t=>t.join("/").replace(/\/\/+/g,"/"),QJ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ZJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,JJ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class eee{constructor(e,n,r){this.status=e,this.statusText=n||"",this.data=r}}function tee(t){return t instanceof eee}/**
 * React Router v6.4.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xh(){return Xh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xh.apply(this,arguments)}function nee(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}const ree=typeof Object.is=="function"?Object.is:nee,{useState:see,useEffect:oee,useLayoutEffect:aee,useDebugValue:iee}=Jp;function lee(t,e,n){const r=e(),[{inst:s},o]=see({inst:{value:r,getSnapshot:e}});return aee(()=>{s.value=r,s.getSnapshot=e,Qp(s)&&o({inst:s})},[t,r,e]),oee(()=>(Qp(s)&&o({inst:s}),t(()=>{Qp(s)&&o({inst:s})})),[t]),iee(r),r}function Qp(t){const e=t.getSnapshot,n=t.value;try{const r=e();return!ree(n,r)}catch{return!0}}function uee(t,e,n){return e()}const cee=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dee=!cee,pee=dee?uee:lee;"useSyncExternalStore"in Jp&&(t=>t.useSyncExternalStore)(Jp);const fee=A.exports.createContext(null),hee=A.exports.createContext(null),wR=A.exports.createContext(null),O1=A.exports.createContext(null),Zd=A.exports.createContext(null),Ll=A.exports.createContext({outlet:null,matches:[]}),bR=A.exports.createContext(null);function mee(t,e){let{relative:n}=e===void 0?{}:e;Bl()||Qe(!1);let{basename:r,navigator:s}=A.exports.useContext(O1),{hash:o,pathname:a,search:i}=$R(t,{relative:n}),l=a;return r!=="/"&&(l=a==="/"?r:Jr([r,a])),s.createHref({pathname:l,search:i,hash:o})}function Bl(){return A.exports.useContext(Zd)!=null}function Vl(){return Bl()||Qe(!1),A.exports.useContext(Zd).location}function SR(t){return t.filter((e,n)=>n===0||!e.route.index&&e.pathnameBase!==t[n-1].pathnameBase)}function CR(){Bl()||Qe(!1);let{basename:t,navigator:e}=A.exports.useContext(O1),{matches:n}=A.exports.useContext(Ll),{pathname:r}=Vl(),s=JSON.stringify(SR(n).map(i=>i.pathnameBase)),o=A.exports.useRef(!1);return A.exports.useEffect(()=>{o.current=!0}),A.exports.useCallback(function(i,l){if(l===void 0&&(l={}),!o.current)return;if(typeof i=="number"){e.go(i);return}let u=vR(i,JSON.parse(s),r,l.relative==="path");t!=="/"&&(u.pathname=u.pathname==="/"?t:Jr([t,u.pathname])),(l.replace?e.replace:e.push)(u,l.state,l)},[t,e,s,r])}function $R(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=A.exports.useContext(Ll),{pathname:s}=Vl(),o=JSON.stringify(SR(r).map(a=>a.pathnameBase));return A.exports.useMemo(()=>vR(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function gee(t,e){Bl()||Qe(!1);let n=A.exports.useContext(wR),{matches:r}=A.exports.useContext(Ll),s=r[r.length-1],o=s?s.params:{};s&&s.pathname;let a=s?s.pathnameBase:"/";s&&s.route;let i=Vl(),l;if(e){var u;let h=typeof e=="string"?Oa(e):e;a==="/"||((u=h.pathname)==null?void 0:u.startsWith(a))||Qe(!1),l=h}else l=i;let c=l.pathname||"/",d=a==="/"?c:c.slice(a.length)||"/",p=PJ(t,{pathname:d}),f=wee(p&&p.map(h=>Object.assign({},h,{params:Object.assign({},o,h.params),pathname:Jr([a,h.pathname]),pathnameBase:h.pathnameBase==="/"?a:Jr([a,h.pathnameBase])})),r,n||void 0);return e?T(Zd.Provider,{value:{location:Xh({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:Wr.Pop},children:f}):f}function yee(){let t=See(),e=tee(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r};return X(Hs,{children:[T("h2",{children:"Unhandled Thrown Error!"}),T("h3",{style:{fontStyle:"italic"},children:e}),n?T("pre",{style:s,children:n}):null,T("p",{children:"\u{1F4BF} Hey developer \u{1F44B}"}),X("p",{children:["You can provide a way better UX than this when your app throws errors by providing your own\xA0",T("code",{style:o,children:"errorElement"})," props on\xA0",T("code",{style:o,children:"<Route>"})]})]})}class xee extends A.exports.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location?{error:e.error,location:e.location}:{error:e.error||n.error,location:n.location}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?T(bR.Provider,{value:this.state.error,children:this.props.component}):this.props.children}}function vee(t){let{routeContext:e,match:n,children:r}=t,s=A.exports.useContext(fee);return s&&n.route.errorElement&&(s._deepestRenderedBoundaryId=n.route.id),T(Ll.Provider,{value:e,children:r})}function wee(t,e,n){if(e===void 0&&(e=[]),t==null)if(n!=null&&n.errors)t=n.matches;else return null;let r=t,s=n==null?void 0:n.errors;if(s!=null){let o=r.findIndex(a=>a.route.id&&(s==null?void 0:s[a.route.id]));o>=0||Qe(!1),r=r.slice(0,Math.min(r.length,o+1))}return r.reduceRight((o,a,i)=>{let l=a.route.id?s==null?void 0:s[a.route.id]:null,u=n?a.route.errorElement||T(yee,{}):null,c=()=>T(vee,{match:a,routeContext:{outlet:o,matches:e.concat(r.slice(0,i+1))},children:l?u:a.route.element!==void 0?a.route.element:o});return n&&(a.route.errorElement||i===0)?T(xee,{location:n.location,component:u,error:l,children:c()}):c()},null)}var iS;(function(t){t.UseRevalidator="useRevalidator"})(iS||(iS={}));var Yh;(function(t){t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator"})(Yh||(Yh={}));function bee(t){let e=A.exports.useContext(wR);return e||Qe(!1),e}function See(){var t;let e=A.exports.useContext(bR),n=bee(Yh.UseRouteError),r=A.exports.useContext(Ll),s=r.matches[r.matches.length-1];return e||(r||Qe(!1),s.route.id||Qe(!1),(t=n.errors)==null?void 0:t[s.route.id])}function $s(t){Qe(!1)}function Cee(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Wr.Pop,navigator:o,static:a=!1}=t;Bl()&&Qe(!1);let i=e.replace(/^\/*/,"/"),l=A.exports.useMemo(()=>({basename:i,navigator:o,static:a}),[i,o,a]);typeof r=="string"&&(r=Oa(r));let{pathname:u="/",search:c="",hash:d="",state:p=null,key:f="default"}=r,h=A.exports.useMemo(()=>{let g=yR(u,i);return g==null?null:{pathname:g,search:c,hash:d,state:p,key:f}},[i,u,c,d,p,f]);return h==null?null:T(O1.Provider,{value:l,children:T(Zd.Provider,{children:n,value:{location:h,navigationType:s}})})}function $ee(t){let{children:e,location:n}=t,r=A.exports.useContext(hee),s=r&&!e?r.router.routes:Qh(e);return gee(s,n)}var lS;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(lS||(lS={}));new Promise(()=>{});function Qh(t,e){e===void 0&&(e=[]);let n=[];return A.exports.Children.forEach(t,(r,s)=>{if(!A.exports.isValidElement(r))return;if(r.type===A.exports.Fragment){n.push.apply(n,Qh(r.props.children,e));return}r.type!==$s&&Qe(!1),!r.props.index||!r.props.children||Qe(!1);let o=[...e,s],a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,hasErrorBoundary:r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle};r.props.children&&(a.children=Qh(r.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.4.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tee(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function kee(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Nee(t,e){return t.button===0&&(!e||e==="_self")&&!kee(t)}const Eee=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Iee(t){let{basename:e,children:n,window:r}=t,s=A.exports.useRef();s.current==null&&(s.current=AJ({window:r,v5Compat:!0}));let o=s.current,[a,i]=A.exports.useState({action:o.action,location:o.location});return A.exports.useLayoutEffect(()=>o.listen(i),[o]),T(Cee,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o})}const ri=A.exports.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:o,replace:a,state:i,target:l,to:u,preventScrollReset:c}=e,d=Tee(e,Eee),p=mee(u,{relative:s}),f=Ree(u,{replace:a,state:i,target:l,preventScrollReset:c,relative:s});function h(g){r&&r(g),g.defaultPrevented||f(g)}return T("a",{...d,href:p,onClick:o?r:h,ref:n,target:l})});var uS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(uS||(uS={}));var cS;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(cS||(cS={}));function Ree(t,e){let{target:n,replace:r,state:s,preventScrollReset:o,relative:a}=e===void 0?{}:e,i=CR(),l=Vl(),u=$R(t,{relative:a});return A.exports.useCallback(c=>{if(Nee(c,n)){c.preventDefault();let d=r!==void 0?r:qh(l)===qh(u);i(t,{replace:d,state:s,preventScrollReset:o,relative:a})}},[l,i,u,r,s,n,t,o,a])}const TR="/my-fridgile/assets/fridgeIcon.97012f15.svg",kR="/my-fridgile/assets/shoppingListIcon.70620fbc.svg",NR="/my-fridgile/assets/addIcon.7c9d948d.svg",ER="/my-fridgile/assets/recipesIcon.d15338b0.svg",IR="/my-fridgile/assets/profileIcon.2de9275c.svg",RR="/my-fridgile/assets/fridgeIconOrange.0b78ac9d.svg",_R="/my-fridgile/assets/shoppingListIconOrange.b2fcba21.svg",AR="/my-fridgile/assets/recipesIconOrange.7631000b.svg",OR="/my-fridgile/assets/profileIconOrange.f8914b28.svg",_ee=()=>{const[t,e]=A.exports.useState(!1),[n,r]=A.exports.useState(!1),[s,o]=A.exports.useState(!1),[a,i]=A.exports.useState(!1),[l,u]=A.exports.useState(!1),c=()=>{u(!0),setTimeout(()=>{u(!1)},5e3)};return T(Hs,{children:l?X("div",{className:"NavbarMobile",children:[T("div",{className:"NavBtnContainerMobile",onMouseEnter:()=>{e(!0)},onMouseLeave:()=>{e(!1)},children:X(ri,{to:"/my-fridgile/",children:[t?T("img",{src:RR,className:"NavBtnsMobile"}):T("img",{src:TR,className:"NavBtnsMobile"}),T("p",{children:"My Fridge"})]})}),T("div",{className:"NavBtnContainerMobile NavBtnContainerMobileShoppingList",onMouseEnter:()=>{r(!0)},onMouseLeave:()=>{r(!1)},children:X(ri,{to:"/my-fridgile/shoppingList",children:[n?T("img",{src:_R,className:"NavBtnsMobile"}):T("img",{src:kR,className:"NavBtnsMobile"}),T("p",{children:"Shopping List"})]})}),T("div",{className:"NavBtnContainerMobile ",children:X(ri,{to:"/my-fridgile/add",children:[T("img",{src:NR,alt:"",className:"NavBtnsMobile NavBtnMobileMiddle"}),T("p",{children:"Add Food"})]})}),X("div",{className:"NavBtnContainerMobile",onMouseEnter:()=>{o(!0)},onMouseLeave:()=>{o(!1)},children:[s?T("img",{src:AR,alt:"",className:"NavBtnsMobile"}):T("img",{src:ER,alt:"",className:"NavBtnsMobile"}),T("p",{children:"Recipes"})]}),T("div",{className:"NavBtnContainerMobile",onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},children:X(ri,{to:"/my-fridgile/myProfile",children:[a?T("img",{src:OR,alt:"",className:"NavBtnsMobile"}):T("img",{src:IR,alt:"",className:"NavBtnsMobile"}),T("p",{children:"My profile"})]})})]}):T("div",{className:"ClosedMobileNavbar",onClick:()=>{c()},children:T("span",{})})})};const Aee=()=>{const[t,e]=A.exports.useState(!1),[n,r]=A.exports.useState(!1),[s,o]=A.exports.useState(!1),[a,i]=A.exports.useState(!1);return X("div",{className:"NavbarDesktop",children:[X("div",{className:"NavBtnContainerDesktop",onMouseEnter:()=>{e(!0)},onMouseLeave:()=>{e(!1)},children:[t?T("img",{src:RR,className:"NavBtnsDesktop"}):T("img",{src:TR,className:"NavBtnsDesktop"}),T("p",{children:"My Fridge"})]}),X("div",{className:"NavBtnContainerDesktop NavBtnContainerShoppingListDesktop",onMouseEnter:()=>{r(!0)},onMouseLeave:()=>{r(!1)},children:[n?T("img",{src:_R,className:"NavBtnsDesktop"}):T("img",{src:kR,className:"NavBtnsDesktop"}),T("p",{children:"Shopping List"})]}),X("div",{className:"NavBtnContainerDesktop NavBtnContainerMiddleDesktop",children:[T("p",{children:"Add Food"}),T("div",{className:"NavBtns NavBtnMiddleDesktop",children:T(ri,{to:"/my-fridgile/add",children:T("img",{src:NR,alt:""})})})]}),X("div",{className:"NavBtnContainerDesktop",onMouseEnter:()=>{o(!0)},onMouseLeave:()=>{o(!1)},children:[s?T("img",{src:AR,alt:"",className:"NavBtnsDesktop"}):T("img",{src:ER,alt:"",className:"NavBtnsDesktop"}),T("p",{children:"Recipes"})]}),X("div",{className:"NavBtnContainerDesktop",onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},children:[a?T("img",{src:OR,alt:"",className:"NavBtnsDesktop"}):T("img",{src:IR,alt:"",className:"NavBtnsDesktop"}),T("p",{children:"My profile"})]})]})};const Oee="/my-fridgile/assets/preferences.3e1112d0.svg",Dee="/my-fridgile/assets/preferencesOrange.f8306276.svg";const Pee=()=>{const[t,e]=A.exports.useState(!1);return X("div",{className:"preferencesBar",children:[T("h2",{className:"titleHeartbeat",children:"Fridgile"}),T("div",{onMouseEnter:()=>{e(!0)},onMouseLeave:()=>{e(!1)},children:t?T("img",{src:Dee,alt:"",className:"preferencesIcon"}):T("img",{src:Oee,alt:"",className:"preferencesIcon"})})]})},Fee=t=>X("div",{className:"PageTemplate",children:[T(Pee,{}),T(Aee,{}),T("div",{className:"Content",children:t.children}),T(_ee,{})]});function wo({icon:t,title:e}){const n=CR();return X("div",{className:"card-category",onClick:()=>{n(`/my-fridgile/cardContent?name=${e}`)},children:[T("div",{className:"category-icon",children:t&&T("img",{src:t,alt:"category icon"})}),T("div",{className:"category-title",children:T("p",{children:e})})]})}const Lee="/my-fridgile/assets/carrot.f3ca8af9.svg",Bee="/my-fridgile/assets/banana.86f62963.svg",Vee="/my-fridgile/assets/dairy.e6b077cf.svg",Mee="/my-fridgile/assets/meat.08b757e1.svg",zee="/my-fridgile/assets/fish.9be8b664.svg",Uee="/my-fridgile/assets/plus.dd199974.svg";const Wee="/my-fridgile/assets/man.63f61809.svg",Gee=()=>X("div",{className:"recipesWidget",children:[X("div",{className:"recipesWidgetLeft",children:[T("div",{className:"recipesWidgetTitle",children:T("p",{children:"Recipes"})}),X("div",{className:"recipesWidgetMessage",children:[T("p",{children:"Struggling with deciding what to cook?"}),T("p",{children:"See recommended recipes based on food items you have in your fridge."})]}),T("div",{className:"recipesBtn",children:T("a",{children:"Go to recipes"})})]}),T("div",{className:"recipesWidgetRight",children:T("img",{src:Wee,alt:"",className:"recipesWidgetIcon"})})]});const jee=()=>X("div",{className:"downloadWidget",children:[T("div",{className:"downloadWidgetTitle",children:T("p",{children:"Download Fridgile"})}),T("div",{className:"downloadWidgetMessage",children:T("p",{children:"Adding products to your digital fridge couldn't be easier with our scanning feature available in the mobile version of Fridgile."})}),T("div",{className:"downloadWidgetBtn",children:T("a",{children:"App Store"})})]}),DR=A.exports.createContext({});const Hee=()=>{const[t,e]=A.exports.useState(""),{setPopupAddCategory:n,setNewCard:r}=A.exports.useContext(DR);return T("div",{className:"popupBackground",children:X("div",{className:"popup",children:[X("div",{className:"popupTopSide",children:[T("p",{children:"Name your category..."}),T("button",{onClick:()=>n(!1),children:"\u2716"})]}),X("div",{className:"popupBottomSide",children:[T("input",{maxLength:"15",type:"text",placeholder:"Name your category...",onChange:o=>{e(o.target.value)}}),T("button",{type:"submit",onClick:()=>(r(t),n(!1)),children:"Save"})]})]})})};function Kee(){const[t,e]=A.exports.useState(""),[n,r]=A.exports.useState(!1);return T(Hs,{children:X(DR.Provider,{value:{setNewCard:e,setPopupAddCategory:r},children:[n&&T(Hee,{}),X("div",{className:"myFridge",children:[X("div",{className:"fridgeLeftSide",children:[T("div",{className:"fridgeTitle",children:T("p",{children:"My Fridge"})}),T("div",{className:"fridgeSubTitle",children:T("p",{children:"Click on the category to see and add items"})}),X("div",{className:"fridgeCategories",children:[T("div",{className:"addCardCategory",onClick:()=>{r(!0)},children:T("div",{className:"add-category-icon",children:T("img",{src:Uee,alt:"category icon"})})}),T(wo,{icon:Lee,title:"Vegetables"}),T(wo,{icon:Bee,title:"Fruits"}),T(wo,{icon:Vee,title:"Dairy"}),T(wo,{icon:Mee,title:"Meat"}),T(wo,{icon:zee,title:"Fish"}),t&&T(wo,{title:t})]})]}),X("div",{className:"fridgeRightSide",children:[T(jee,{}),T(Gee,{})]})]})]})})}function qee(){const{search:t}=Vl();return A.exports.useMemo(()=>new URLSearchParams(t),[t])}const Xee="/my-fridgile/assets/trashIcon.2f057fa8.svg",Zp=({item:t,ide:e})=>{const{setDetectedItem:n}=Qd(),[r,s]=A.exports.useState(!1),[o,a]=A.exports.useState(0),[i,l]=A.exports.useState(0),[u,c]=A.exports.useState(""),d=5,p=3,h=new Date().getDate(),g=()=>{n(m=>m.filter(x=>x.id!==e))},y=()=>{let m;return t==="banana"&&(a(d),m=d/h*100),t==="cheeseburger"&&(a(d),m=p/h*100),l(m)};return A.exports.useEffect(()=>{y(),i<=30?c("green"):i>30&&i<=70?c("tomato"):i>70&&c("red")},[t]),X("div",{className:"cardItem",children:[X("div",{className:"cardItemContentContainer",children:[X("div",{className:"cardItemContentTop",children:[T("p",{children:t}),X("div",{className:"dotsContainer",onClick:()=>s(!r),children:[T("span",{}),T("span",{}),T("span",{})]})]}),X("div",{className:"cardItemContentBottom",children:[T("p",{children:`Expires in ${o} days`}),T("div",{className:"cardItemStatBar",children:T("div",{className:"cardItemStatBarFill",style:{width:`${i}%`,backgroundColor:`${u}`}})})]})]}),r&&T("div",{className:"deleteSide",onClick:()=>{g()},children:T("img",{src:Xee,alt:""})})]})},Yee=()=>{const{detectedItem:t}=Qd();let e=qee();return X("div",{className:"cardContent",children:[T("div",{className:"cardContentTitle",children:e.get("name")}),e.get("name")==="Meat"&&T("div",{children:t.map(n=>{if(n.item==="cheeseburger")return T(Zp,{item:n.item,ide:n.id},n.id)})}),e.get("name")==="Fruits"&&T("div",{children:t.map(n=>{if(n.item==="banana"||n.item==="cheeseburger")return T(Zp,{item:n.item,ide:n.id},n.id)})}),e.get("name")==="Vegetables"&&T("div",{children:t.map((n,r)=>{if(n.item==="cucumber, cuke")return T(Zp,{item:n.item,ide:n.id},r)})})]})};const Qee=({newTask:t,setNewTask:e,addTask:n,itemRef:r})=>T(Hs,{children:X("div",{className:"addItemToListContainer",children:[T("input",{value:t,onChange:s=>e(s.target.value),placeholder:"Add an item...",ref:r}),T("button",{onClick:n,children:"Add"})]})});const Zee="/my-fridgile/assets/checkBlack.a531fe66.svg",Jee="/my-fridgile/assets/checkOrange.8ed04983.svg",ete="/my-fridgile/assets/editBlack.9f359203.svg",PR="/my-fridgile/assets/editIconOrange.c3997c6f.svg",tte="/my-fridgile/assets/trashIconBlack.57234be0.svg",nte="/my-fridgile/assets/trashOrange.fc091d60.svg",rte="/my-fridgile/assets/plusIconBlackk.676a5170.svg",ste=({toDo:t,markDone:e,setUpdateData:n,deleteTask:r})=>{const[s,o]=A.exports.useState(!1),[a,i]=A.exports.useState(!1),[l,u]=A.exports.useState(!1);return T("div",{className:"itemListContainer",children:X("div",{className:"itemToBuyContainer",children:[T("div",{children:T("img",{src:rte,className:"itemInListIconsMain"})}),T("div",{className:t.status?"done":"notDone",children:T("span",{className:"itemName",children:t.item})}),X("div",{className:"iconsContainer",children:[T("span",{title:"Completed / Not Completed",onClick:c=>e(t.id),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:s?T("img",{src:Jee,alt:"",className:"itemInListIcons"}):T("img",{src:Zee,alt:"",className:"itemInListIcons"})}),t.status?null:T("span",{title:"Edit",onClick:()=>n({id:t.id,title:t.title,status:!!t.status}),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:a?T("img",{src:PR,alt:"",className:"itemInListIcons"}):T("img",{src:ete,alt:"",className:"itemInListIcons"})}),T("span",{title:"Delete",onClick:()=>r(t.id),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:l?T("img",{src:nte,alt:"",className:"itemInListIcons"}):T("img",{src:tte,alt:"",className:"itemInListIcons"})})]})]})},t.id)};const ote=({updateData:t,changeTask:e,updateTask:n,cancelUpdate:r})=>X(Hs,{children:[X("div",{className:"updateItemContainer",children:[T("input",{value:t&&t.item,onChange:s=>e(s)}),X("div",{className:"updateBtns",children:[T("button",{onClick:n,children:"Update"}),T("button",{onClick:r,children:"Cancel"})]})]}),T("br",{})]}),ate="/my-fridgile/assets/shoppingBackground.982297f3.svg",ite=()=>{const[t,e]=A.exports.useState([]),[n,r]=A.exports.useState(""),[s,o]=A.exports.useState(""),{saveItemToLocal:a,saveItemFromShoppingList:i,setSaveItemFromShoppingList:l}=Qd(),u=A.exports.useRef(),c=()=>{if(n){let m={id:t.length+1,title:n,status:!1};e([...t,m]),a({item:u.current.value}),r("")}},d=y=>{let m=i.filter(x=>x.id!==y);l(m)},p=y=>{let m=i.map(x=>x.id===y?{...x,status:!x.status}:x);l(m)},f=()=>{o("")},h=y=>{let m={id:s.id,item:y.target.value,status:!!s.status};o(m)};return console.log(s),X("div",{className:"shoppingList",children:[T("div",{className:"shoppingListTitle",children:T("h2",{children:"Shopping List"})}),X("div",{className:"shoppingListContent",children:[s&&s?T(ote,{updateData:s,changeTask:h,updateTask:()=>{let m=[...[...i].filter(x=>x.id!==s.id),s];l(m),o("")},cancelUpdate:f}):T(Qee,{newTask:n,setNewTask:r,addTask:c,itemRef:u}),i.length>0&&X("div",{className:"shoppingListInstructions",children:[T("p",{children:"Click on + to add items to fridge"}),T("p",{children:"Add all"})]}),T("div",{className:"shoppinglistItemsContainer",children:i.length>0?T("div",{className:"wrapperList",children:i.map(y=>T(ste,{toDo:y,markDone:p,setUpdateData:o,deleteTask:d},y.id))}):T("img",{src:ate,alt:"",className:"shoppingListImgBackground"})})]})]})};const lte="/my-fridgile/assets/editIconBlack.0dd45fec.svg",ute="/my-fridgile/assets/personProfile.a0f7542d.jpeg",cte="/my-fridgile/assets/arrowIconBlack.4eb71a24.svg",dte="/my-fridgile/assets/logoutIconBlack.50221e10.svg",pte=()=>{const[t,e]=A.exports.useState(!1);return T("div",{className:"profileContainer",children:X("div",{children:[X("div",{className:"profileTitleContainer",children:[T("p",{children:"My Profile"}),T("div",{onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),children:t?T("img",{src:PR,alt:""}):T("img",{src:lte,alt:""})})]}),X("div",{className:"profileImgContainer",children:[T("img",{src:ute,alt:""}),X("div",{className:"nameUnderImgProfile",children:[T("div",{children:"Kendell Dell"}),T("div",{className:"onlineDot"})]}),T("p",{children:"kendelnumeroUno@gmail.com"})]}),X("div",{className:"statsContainer",children:[X("div",{className:"pieContainer",children:[T("div",{className:"pieBackground"}),T("div",{id:"pieSlice25",className:"hold",children:T("div",{className:"pie"})}),T("div",{className:"stat-circle-cover",children:X("div",{className:"stat-number",children:[T("p",{children:"25% "}),T("p",{children:"Food"}),T("p",{children:"Thrown"})]})})]}),X("div",{className:"pieContainer",children:[T("div",{className:"pieBackground"}),T("div",{id:"pieSlice50",className:"hold",children:T("div",{className:"pie"})}),T("div",{className:"stat-circle-cover",children:X("span",{className:"stat-number",children:[T("p",{children:"50% "}),T("p",{children:"Food"}),T("p",{children:"Saved"})]})})]})]}),T("div",{className:"seeStatsBtn",children:X("div",{children:[T("p",{children:"See statistics"}),T("img",{src:cte,alt:""})]})}),T("div",{className:"logoutContainer",children:X("div",{children:[T("p",{children:"Log out"}),T("img",{src:dte,alt:""})]})})]})})};const fte={hidden:{x:"-200%",opacity:0},visible:{x:0,opacity:1,transition:{type:"spring",duration:2}},exit:{x:"-200",opacity:0,transition:{type:"spring",duration:2}}},hte={hidden:{y:"-400%",opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",duration:2}},exit:{y:"-400",opacity:0,transition:{type:"spring",duration:2}}},mte={hidden:{y:"400%",opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",duration:2}},exit:{y:"400",opacity:0,transition:{type:"spring",duration:2}}},gte={hidden:{x:"200%",opacity:0},visible:{x:0,opacity:1,transition:{type:"spring",duration:2}},exit:{x:"200",opacity:0,transition:{type:"spring",duration:2}}},yte={show:{opacity:1,transition:{duration:2}}},xte=({setLoading:t})=>T(q$,{children:X(Ha.div,{className:"loaderContainer",variants:yte,animate:"show",onAnimationComplete:()=>t(!1),children:[T(Ha.p,{variants:fte,initial:"hidden",animate:"visible",exit:"exit",children:"FR"},"modal1"),T(Ha.p,{variants:hte,initial:"hidden",animate:"visible",exit:"exit",children:"ID"},"modal2"),T(Ha.p,{variants:mte,initial:"hidden",animate:"visible",exit:"exit",children:"GI"},"modal3"),T(Ha.p,{variants:gte,initial:"hidden",animate:"visible",exit:"exit",children:"LE"},"modal4")]},"modal")});function vte(){const[t,e]=A.exports.useState(!0);return A.exports.useEffect(()=>{},[t]),T("div",{className:"App",children:T(Iee,{children:T(Fee,{children:T(EJ,{children:T(q$,{children:X($ee,{children:[t?T($s,{path:"/my-fridgile/",element:T(xte,{setLoading:e})}):T($s,{path:"/my-fridgile/",element:T(Kee,{})}),T($s,{path:"/my-fridgile/add",element:T(_J,{})}),T($s,{path:"/my-fridgile/shoppingList",element:T(ite,{})}),T($s,{path:"/my-fridgile/cardContent",element:T(Yee,{})}),T($s,{path:"/my-fridgile/myProfile",element:T(pte,{})})]})})})})})})}ef.createRoot(document.getElementById("root")).render(T(al.StrictMode,{children:T(vte,{})}));
